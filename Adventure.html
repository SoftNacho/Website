<!DOCTYPE HTML>

<html>
	<head>
		<title>Lisa Gentil - Adventure Game</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
	</head>
	<body class="landing">

		<!-- Header -->
			<header id="header" class="alt ">
				<!--
                <h1><a href="index.html">Drift <span>by Pixelarity</span></a></h1>
                -->
				<nav id="nav">
					<ul>
						<li><a href="index.html">Home</a></li>
						<li><a href="index.html#one" class="icon fa-angle-down">About Me</a></li>
                        <li>
                            <a href="index.html#two" class="icon fa-angle-down">Projects</a>
							<ul>
                                <li><a href="OS.html">Operating System NachOS</a></li>
                                <li><a 
                                href="LC3b.html">LC-3b Processor
                                </a></li>
                                <li><a href="2048.html">2048</a></li>
                                <li><a href="TicTacToe.html">Tic Tac Toe</a></li>
                                <li><a href="Adventure.html">Adventure</a></li>
                                <li><a href="Sudoku.html">Sudoku</a></li>
                                <li><a href="PhotoEditor.html">Photo Editor</a></li>
                                <li><a href="FlappyBird.html">Flappy Bird</a></li>
                                <li><a href="Calculator.html">Calculator</a></li>
                            </ul>
                            <li><a href="Resume.html">Résumé</a></li>
					</ul>
				</nav>
			</header>

		<!-- Banner -->
			<section id="bannerAdventure">
				<div class="inner">
					<h2>Adventure Game</h2>
                    <ul class="actions">
						<li><a href="index.html" class="button big scrolly">BACK TO MAIN MENU</a></li>
					</ul>
				</div>
			</section>
            
        <br>
        <!--Presentation of Project-->
        <section id="presentation">
            <div align="center">
                <h3>Presentation of Project</h3>
                <p>This project is a simple adventure game in which collecting objects and clues would lead the user to the goal. We had to set the colors of the images using the octree technique for the color palette. Keyboard handling was necessary for the first part of the project, but, most importantly, integrating the TUX controller to the game was the most challenging part of it. The controller is used to start/pause the game, keep track of how long the user has been playing (the counter was displayed on the controller's LEDs), and the reset button is supposed to reset the LEDs while the counter does not stop. The whole game has been written in C.</p>
            </div>
        </section>    
         
        
        <div align="center">
            <figure>
                <video controls autoplay><source src="../../images/Game.mp4" type="video/mp4"></video>
                <figcaption>Use of TUX controller to move an image</figcaption>
            </figure>
        </div>
        <div align="center">
            <figure>
                <video controls autoplay><source src="../../images/TUX.mp4" type="video/mp4"></video>
                <figcaption>Reaction of TUX's LED display to pressing RESET over and over (edge case we had to handle)</figcaption>
            </figure>    
        </div>
        
        
            <br> 
        <!--Buttons-->
        <div align="center">
            
            <a href="#adventure.c" class="buttonInPage"> adventure.c </a>
            <a href="#assert.c"class="buttonInPage"> assert.c </a>
            <a href="#assert.h"class="buttonInPage"> assert.h </a>
            <a href="#input.c"class="buttonInPage"> input.c </a>
            <a href="#input.h"class="buttonInPage"> input.h </a>
            <a href="#modex.c"class="buttonInPage"> modex.c </a>
            <a href="#modex.h"class="buttonInPage"> modex.h </a>
            <a href="#Module"class="buttonInPage"> Module </a>
            <a href="#mp2photo.c" class="buttonInPage"> mp2photo.c </a>
            <a href="#photo.c"class="buttonInPage"> photo.c </a>
            <a href="#photo.h"class="buttonInPage"> photo.h </a>
            <a href="#photo_headers.h"class="buttonInPage"> photo_headers.h </a>
            <a href="#text.c"class="buttonInPage"> text.c </a>
            <a href="#text.h"class="buttonInPage"> text.h </a>
            <a href="#types.h"class="buttonInPage"> types.h </a>
            <a href="#world.c"class="buttonInPage"> world.c </a>
            <a href="#world.h"class="buttonInPage"> world.h </a>
            <a href="#Makefile"class="buttonInPage"> Makefile </a>
        
        </div>
            
            
        <!--File-->
                            
            <!--adventure.c-->
            <section>
            <hnew id="adventure.c">adventure.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * adventure.c - main source file for ECE391 adventure game (F11 MP2)</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2004-2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    3</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Fri Sep  9 21:42:12 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    adventure.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Fri Sep  9 21:42:12 2011</span>
<span style="color: #666666; font-style: italic"> *		First written (based on mazegame).</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Wed Sep 14 01:27:29 2011</span>
<span style="color: #666666; font-style: italic"> *		Redesigned simple game loop to manage ticks and timing.</span>
<span style="color: #666666; font-style: italic"> *	SL	3	Wed Sep 14 20:57:22 2011</span>
<span style="color: #666666; font-style: italic"> *		Cleaned up code for distribution.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#include &lt;errno.h&gt;</span>
<span style="color: #557799">#include &lt;pthread.h&gt;</span>
<span style="color: #557799">#include &lt;stdio.h&gt;</span>
<span style="color: #557799">#include &lt;stdlib.h&gt;</span>
<span style="color: #557799">#include &lt;string.h&gt;</span>
<span style="color: #557799">#include &lt;sys/time.h&gt;</span>
<span style="color: #557799">#include &lt;time.h&gt;</span>

<span style="color: #557799">#include &quot;assert.h&quot;</span>
<span style="color: #557799">#include &quot;input.h&quot;</span>
<span style="color: #557799">#include &quot;modex.h&quot;</span>
<span style="color: #557799">#include &quot;photo.h&quot;</span>
<span style="color: #557799">#include &quot;text.h&quot;</span>
<span style="color: #557799">#include &quot;world.h&quot;</span>
<span style="color: #557799">#include &quot;module/mtcp.h&quot;</span>
<span style="color: #557799">#include &quot;module/tuxctl-ioctl.h&quot;</span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * If NDEBUG is not defined, we execute sanity checks to make sure that</span>
<span style="color: #666666; font-style: italic"> * changes to enumerations, bit maps, etc., have been made consistently.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#if defined(NDEBUG)</span>
<span style="color: #557799">#define sanity_check() 0</span>
<span style="color: #557799">#else</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">sanity_check</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #557799">#endif</span>


<span style="color: #666666; font-style: italic">/* a few constants */</span>
<span style="color: #557799">#define TICK_USEC      50000 </span><span style="color: #666666; font-style: italic">/* tick length in microseconds          */</span><span style="color: #557799"></span>
<span style="color: #557799">#define STATUS_MSG_LEN 40    </span><span style="color: #666666; font-style: italic">/* maximum length of status message     */</span><span style="color: #557799"></span>
<span style="color: #557799">#define MOTION_SPEED   2     </span><span style="color: #666666; font-style: italic">/* pixels moved per command             */</span><span style="color: #557799"></span>

<span style="color: #666666; font-style: italic">/* outcome of the game */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">enum</span> {GAME_WON, GAME_QUIT} <span style="color: #6666ff; font-weight: bold">game_condition_t</span>;

<span style="color: #666666; font-style: italic">/* structure used to hold game information */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> {
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>      where;		 <span style="color: #666666; font-style: italic">/* current room for player               */</span>
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">int</span> map_x, map_y;   <span style="color: #666666; font-style: italic">/* current upper left display pixel      */</span>
    <span style="color: #6666ff; font-weight: bold">int</span>          x_speed;        <span style="color: #666666; font-style: italic">/* number of pixels of x motion per move */</span>
    <span style="color: #6666ff; font-weight: bold">int</span>          y_speed;        <span style="color: #666666; font-style: italic">/* number of pixels of y motion per move */</span>
} <span style="color: #6666ff; font-weight: bold">game_info_t</span>;

<span style="color: #6666ff; font-weight: bold">FILE</span> <span style="color: #333333">*</span> fd;
<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * enumerated values, structure, and static data used for parsing typed </span>
<span style="color: #666666; font-style: italic"> * commands </span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Note that the structure allows us to abbreviate commands and to create</span>
<span style="color: #666666; font-style: italic"> * synonyms for verbs (e.g., get and grab).</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">enum</span> { <span style="color: #666666; font-style: italic">/* TC = typed command */</span>
    TC_BUY,
    TC_CHARGE,
    TC_DO,
    TC_DRINK,
    TC_DROP,
    TC_FIX,
    TC_FLASH,
    TC_GET,
    TC_GO,
    TC_INSTALL,
    TC_INVENTORY,
    TC_SIGH,
    TC_USE,
    TC_WEAR,
    NUM_TC_VALUES
} <span style="color: #6666ff; font-weight: bold">cmd_id_t</span>;

<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">typed_cmd_t</span> <span style="color: #6666ff; font-weight: bold">typed_cmd_t</span>;
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">typed_cmd_t</span> {
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> name;	<span style="color: #666666; font-style: italic">/* verb that must be typed               */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> min_len;	<span style="color: #666666; font-style: italic">/* minimum number of matching characters */</span>
    <span style="color: #6666ff; font-weight: bold">cmd_id_t</span> cmd;	<span style="color: #666666; font-style: italic">/* resulting command                     */</span>
};

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">typed_cmd_t</span> cmd_list[] <span style="color: #333333">=</span> {
    {<span style="background-color: #e0e0ff">&quot;buy&quot;</span>,       <span style="color: #6666ff; font-weight: bold">3</span>, TC_BUY},
    {<span style="background-color: #e0e0ff">&quot;charge&quot;</span>,    <span style="color: #6666ff; font-weight: bold">2</span>, TC_CHARGE},
    {<span style="background-color: #e0e0ff">&quot;do&quot;</span>,        <span style="color: #6666ff; font-weight: bold">2</span>, TC_DO},
    {<span style="background-color: #e0e0ff">&quot;drink&quot;</span>,     <span style="color: #6666ff; font-weight: bold">3</span>, TC_DRINK},
    {<span style="background-color: #e0e0ff">&quot;drop&quot;</span>,      <span style="color: #6666ff; font-weight: bold">2</span>, TC_DROP},
    {<span style="background-color: #e0e0ff">&quot;fix&quot;</span>,       <span style="color: #6666ff; font-weight: bold">3</span>, TC_FIX},
    {<span style="background-color: #e0e0ff">&quot;flash&quot;</span>,     <span style="color: #6666ff; font-weight: bold">5</span>, TC_FLASH},
    {<span style="background-color: #e0e0ff">&quot;get&quot;</span>,       <span style="color: #6666ff; font-weight: bold">1</span>, TC_GET},
    {<span style="background-color: #e0e0ff">&quot;go&quot;</span>,        <span style="color: #6666ff; font-weight: bold">2</span>, TC_GO},
    {<span style="background-color: #e0e0ff">&quot;grab&quot;</span>,      <span style="color: #6666ff; font-weight: bold">2</span>, TC_GET},
    {<span style="background-color: #e0e0ff">&quot;install&quot;</span>,   <span style="color: #6666ff; font-weight: bold">3</span>, TC_INSTALL},
    {<span style="background-color: #e0e0ff">&quot;inventory&quot;</span>, <span style="color: #6666ff; font-weight: bold">1</span>, TC_INVENTORY},
    {<span style="background-color: #e0e0ff">&quot;sigh&quot;</span>,      <span style="color: #6666ff; font-weight: bold">4</span>, TC_SIGH},
    {<span style="background-color: #e0e0ff">&quot;use&quot;</span>,       <span style="color: #6666ff; font-weight: bold">3</span>, TC_USE},
    {<span style="background-color: #e0e0ff">&quot;wear&quot;</span>,      <span style="color: #6666ff; font-weight: bold">4</span>, TC_WEAR},
    {<span style="color: #007722">NULL</span>, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">0</span>}
};


<span style="color: #666666; font-style: italic">/* local functions--see function headers for details */</span>

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">cancel_status_thread</span> (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> ignore);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">game_condition_t</span> <span style="color: #55eedd; font-weight: bold">game_loop</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int32_t</span> <span style="color: #55eedd; font-weight: bold">handle_typing</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">init_game</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">move_photo_down</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">move_photo_left</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">move_photo_right</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">move_photo_up</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">redraw_room</span> (<span style="color: #6666ff; font-weight: bold">void</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">status_thread</span> (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> ignore);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">time_is_after</span> (<span style="color: #228899; font-weight: bold">struct</span> timeval<span style="color: #333333">*</span> t1, <span style="color: #228899; font-weight: bold">struct</span> timeval<span style="color: #333333">*</span> t2);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">tux_controller_thread</span> (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> ignore);


<span style="color: #666666; font-style: italic">/* file-scope variables */</span>

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">game_info_t</span> game_info; <span style="color: #666666; font-style: italic">/* game information */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> previous_time <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * The variables below are used to keep track of the status message helper</span>
<span style="color: #666666; font-style: italic"> * thread, with Posix thread id recorded in status_thread_id.  </span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The status_msg records the current status message: when the</span>
<span style="color: #666666; font-style: italic"> * string recorded there is empty, no status message need be displayed, and</span>
<span style="color: #666666; font-style: italic"> * the status bar should instead reflect the name of the current room and the</span>
<span style="color: #666666; font-style: italic"> * player&#39;s typing (for typed commands).</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The status_msg is protected by the msg_lock mutex, which should be</span>
<span style="color: #666666; font-style: italic"> * acquired before reading or writing the message.  Further, if the message</span>
<span style="color: #666666; font-style: italic"> * is changed, the helper thread must be notified by signaling it with the </span>
<span style="color: #666666; font-style: italic"> * condition variable msg_cv (while holding the msg_lock).</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">pthread_t</span> status_thread_id;
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">pthread_mutex_t</span> msg_lock <span style="color: #333333">=</span> PTHREAD_MUTEX_INITIALIZER;
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">pthread_cond_t</span>  msg_cv <span style="color: #333333">=</span> PTHREAD_COND_INITIALIZER;
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">char</span> status_msg[STATUS_MSG_LEN <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">1</span>] <span style="color: #333333">=</span> {<span style="color: #8888FF">&#39;\0&#39;</span>};

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">pthread_t</span> tux_controller_thread_id;


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * cancel_status_thread</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Terminates the status message helper thread.  Used as</span>
<span style="color: #666666; font-style: italic"> *                a cleanup method to ensure proper shutdown.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none (ignored)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">cancel_status_thread</span> (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> ignore)
{
    (<span style="color: #6666ff; font-weight: bold">void</span>)pthread_cancel (status_thread_id);
}

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * cancel_status_thread</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Terminates the status message helper thread.  Used as</span>
<span style="color: #666666; font-style: italic"> *                a cleanup method to ensure proper shutdown.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none (ignored)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">cancel_tux_controller_thread</span> (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> ignore)
{
    (<span style="color: #6666ff; font-weight: bold">void</span>)pthread_cancel (tux_controller_thread_id);
}



<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * game_loop</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Main event loop for the adventure game.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: GAME_QUIT if the player quits, or GAME_WON if they have won</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: drives the display, etc.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">game_condition_t</span>
<span style="color: #55eedd; font-weight: bold">game_loop</span> ()
{
    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Variables used to carry information between event loop ticks; see</span>
<span style="color: #666666; font-style: italic">     * initialization below for explanations of purpose.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">struct</span> timeval start_time, tick_time;

    <span style="color: #228899; font-weight: bold">struct</span> timeval cur_time; <span style="color: #666666; font-style: italic">/* current time (during tick)      */</span>
    <span style="color: #6666ff; font-weight: bold">cmd_t</span> cmd;               <span style="color: #666666; font-style: italic">/* command issued by input control */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> enter_room;      <span style="color: #666666; font-style: italic">/* player has changed rooms        */</span>

    <span style="color: #6666ff; font-weight: bold">int</span> current_time;

    <span style="color: #666666; font-style: italic">/* Record the starting time--assume success. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)gettimeofday (<span style="color: #333333">&amp;</span>start_time, <span style="color: #007722">NULL</span>);

    <span style="color: #666666; font-style: italic">/* Calculate the time at which the first event loop tick should occur. */</span>
    tick_time <span style="color: #333333">=</span> start_time;
    <span style="color: #228899; font-weight: bold">if</span> ((tick_time.tv_usec <span style="color: #333333">+=</span> TICK_USEC) <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">1000000</span>) {
	tick_time.tv_sec<span style="color: #333333">++</span>;
	tick_time.tv_usec <span style="color: #333333">-=</span> <span style="color: #6666ff; font-weight: bold">1000000</span>;
    }

    <span style="color: #666666; font-style: italic">/* The player has just entered the first room. */</span>
    enter_room <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;

    <span style="color: #666666; font-style: italic">/* The main event loop. */</span>
    <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #6666ff; font-weight: bold">1</span>) {
	<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	 * Update the screen, preparing the VGA palette and photo-drawing</span>
<span style="color: #666666; font-style: italic">	 * routines and drawing a new room photo first if the player has</span>
<span style="color: #666666; font-style: italic">	 * entered a new room, then showing the screen (and status bar,</span>
<span style="color: #666666; font-style: italic">	 * once you have it working).</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #228899; font-weight: bold">if</span> (enter_room) {
	    <span style="color: #666666; font-style: italic">/* Reset the view window to (0,0). */</span>
	    game_info.map_x <span style="color: #333333">=</span> game_info.map_y <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	    set_view_window (game_info.map_x, game_info.map_y);

	    <span style="color: #666666; font-style: italic">/* Discard any partially-typed command. */</span>
	    reset_typed_command ();
	    
	    <span style="color: #666666; font-style: italic">/* Adjust colors and photo drawing for the current room photo. */</span>
	    prep_room (game_info.where);

	    <span style="color: #666666; font-style: italic">/* Draw the room (calls show. */</span>
	    redraw_room ();

	    <span style="color: #666666; font-style: italic">/* Only draw once on entry. */</span>
	    enter_room <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}

	<span style="color: #6666ff; font-weight: bold">int</span> row, col;

    <span style="color: #228899; font-weight: bold">for</span> (row <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; row <span style="color: #333333">&lt;</span> STATUS_BAR_HEIGHT; row<span style="color: #333333">++</span>)
    {
        <span style="color: #228899; font-weight: bold">for</span>(col <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; col <span style="color: #333333">&lt;</span> STATUS_BAR_WIDTH; col<span style="color: #333333">++</span>)
        {
            status_bar_buffer[row <span style="color: #333333">*</span> STATUS_BAR_WIDTH <span style="color: #333333">+</span> col] <span style="color: #333333">=</span> BACKGROUND_COLOR;
        }<span style="color: #666666; font-style: italic">//end for columns</span>
    }<span style="color: #666666; font-style: italic">//end for rows</span>

	<span style="color: #666666; font-style: italic">//getting lock to read and starting critical section</span>
	(<span style="color: #6666ff; font-weight: bold">void</span>) pthread_mutex_lock(<span style="color: #333333">&amp;</span>msg_lock);

	<span style="color: #666666; font-style: italic">//check if status_msg is not empty, then text_to_graphics_conversion</span>
	<span style="color: #228899; font-weight: bold">if</span>(status_msg[<span style="color: #6666ff; font-weight: bold">0</span>] <span style="color: #333333">!=</span> <span style="color: #8888FF">&#39;\0&#39;</span>)
	{
		<span style="color: #666666; font-style: italic">//getting length of string using strlen C function</span>
		<span style="color: #6666ff; font-weight: bold">int</span> status_msg_len <span style="color: #333333">=</span> strlen(status_msg);
		text_to_graphics_conversion(status_bar_buffer, (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>)status_msg, status_msg_len, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">1</span>);
	}<span style="color: #666666; font-style: italic">//end if</span>

	<span style="color: #228899; font-weight: bold">else</span>
	{

		<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> roomname, <span style="color: #333333">*</span> command;
		<span style="color: #6666ff; font-weight: bold">int</span> room_name_length, command_length;

		<span style="color: #666666; font-style: italic">//saving string and getting length</span>
		roomname <span style="color: #333333">=</span> room_name(game_info.where);
		room_name_length <span style="color: #333333">=</span> strlen((<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>)roomname);
		text_to_graphics_conversion(status_bar_buffer, roomname, room_name_length, <span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">0</span>);

		<span style="color: #666666; font-style: italic">//saving string and getting length</span>
		command <span style="color: #333333">=</span> get_typed_command();
		command_length <span style="color: #333333">=</span> strlen((<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>)command); 
	 	text_to_graphics_conversion(status_bar_buffer, command, command_length, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #6666ff; font-weight: bold">0</span>);

	}<span style="color: #666666; font-style: italic">//end else</span>

	<span style="color: #666666; font-style: italic">//releasing lock because end of critical section</span>
	(<span style="color: #6666ff; font-weight: bold">void</span>) pthread_mutex_unlock(<span style="color: #333333">&amp;</span>msg_lock);

	show_screen ();

	<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">	 * Wait for tick.  The tick defines the basic timing of our</span>
<span style="color: #666666; font-style: italic">	 * event loop, and is the minimum amount of time between events.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #228899; font-weight: bold">do</span> {
	    <span style="color: #228899; font-weight: bold">if</span> (gettimeofday (<span style="color: #333333">&amp;</span>cur_time, <span style="color: #007722">NULL</span>) <span style="color: #333333">!=</span> <span style="color: #6666ff; font-weight: bold">0</span>) {
		<span style="color: #666666; font-style: italic">/* Panic!  (should never happen) */</span>
		clear_mode_X ();
		shutdown_input ();
		perror (<span style="background-color: #e0e0ff">&quot;gettimeofday&quot;</span>);
		exit (<span style="color: #6666ff; font-weight: bold">3</span>);
	    }
	} <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #333333">!</span>time_is_after (<span style="color: #333333">&amp;</span>cur_time, <span style="color: #333333">&amp;</span>tick_time));

	<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">	 * Advance the tick time.  If we missed one or more ticks completely, </span>
<span style="color: #666666; font-style: italic">	 * i.e., if the current time is already after the time for the next </span>
<span style="color: #666666; font-style: italic">	 * tick, just skip the extra ticks and advance the clock to the one</span>
<span style="color: #666666; font-style: italic">	 * that we haven&#39;t missed.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #228899; font-weight: bold">do</span> {
	    <span style="color: #228899; font-weight: bold">if</span> ((tick_time.tv_usec <span style="color: #333333">+=</span> TICK_USEC) <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">1000000</span>) {
		tick_time.tv_sec<span style="color: #333333">++</span>;
		tick_time.tv_usec <span style="color: #333333">-=</span> <span style="color: #6666ff; font-weight: bold">1000000</span>;
	    }
	} <span style="color: #228899; font-weight: bold">while</span> (time_is_after (<span style="color: #333333">&amp;</span>cur_time, <span style="color: #333333">&amp;</span>tick_time));

	<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">	 * Handle asynchronous events.  These events use real time rather</span>
<span style="color: #666666; font-style: italic">	 * than tick counts for timing, although the real time is rounded</span>
<span style="color: #666666; font-style: italic">	 * off to the nearest tick by definition.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #666666; font-style: italic">/* (none right now...) */</span>

	 current_time <span style="color: #333333">=</span> tick_time.tv_sec <span style="color: #333333">-</span> start_time.tv_sec;
	 <span style="color: #228899; font-weight: bold">if</span>(current_time <span style="color: #333333">!=</span> previous_time)
	 {
	 	display_time_on_tux(current_time);
	 	previous_time <span style="color: #333333">=</span> current_time;
	 }<span style="color: #666666; font-style: italic">//end if</span>

	 <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	 * Handle synchronous events--in this case, only player commands. </span>
<span style="color: #666666; font-style: italic">	 * Note that typed commands that move objects may cause the room</span>
<span style="color: #666666; font-style: italic">	 * to be redrawn.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	
	cmd <span style="color: #333333">=</span> get_command ();
	<span style="color: #228899; font-weight: bold">switch</span> (cmd) {
	    <span style="color: #228899; font-weight: bold">case</span> CMD_UP:    move_photo_down ();  <span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_RIGHT: move_photo_left ();  <span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_DOWN:  move_photo_up ();    <span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_LEFT:  move_photo_right (); <span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_MOVE_LEFT:
		enter_room <span style="color: #333333">=</span> (TC_CHANGE_ROOM <span style="color: #333333">==</span> 
			      try_to_move_left (<span style="color: #333333">&amp;</span>game_info.where));
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_ENTER:
		enter_room <span style="color: #333333">=</span> (TC_CHANGE_ROOM <span style="color: #333333">==</span>
			      try_to_enter (<span style="color: #333333">&amp;</span>game_info.where));
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_MOVE_RIGHT:
		enter_room <span style="color: #333333">=</span> (TC_CHANGE_ROOM <span style="color: #333333">==</span> 
			      try_to_move_right (<span style="color: #333333">&amp;</span>game_info.where));
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_TYPED:
		<span style="color: #228899; font-weight: bold">if</span> (handle_typing ()) {
		    enter_room <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;
		}
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> CMD_QUIT: <span style="color: #228899; font-weight: bold">return</span> GAME_QUIT;
	    <span style="color: #997700; font-weight: bold">default:</span> <span style="color: #228899; font-weight: bold">break</span>;
	}

	<span style="color: #666666; font-style: italic">/* If player wins the game, their room becomes NULL. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> game_info.where) {
	    <span style="color: #228899; font-weight: bold">return</span> GAME_WON;
	}
    } <span style="color: #666666; font-style: italic">/* end of the main event loop */</span>
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * handle_typing</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Parse and execute a typed command.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none (reads typed command)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 1 if the player&#39;s room changes, 0 otherwise</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move the player, move objects, and/or redraw the screen</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int32_t</span>
<span style="color: #55eedd; font-weight: bold">handle_typing</span> ()
{
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span>      cmd;     <span style="color: #666666; font-style: italic">/* command verb typed                */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>          cmd_len; <span style="color: #666666; font-style: italic">/* length of command verb            */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span>      arg;     <span style="color: #666666; font-style: italic">/* argument given to command verb    */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>          idx;     <span style="color: #666666; font-style: italic">/* loop index over command list      */</span>
    <span style="color: #6666ff; font-weight: bold">tc_action_t</span>      result;  <span style="color: #666666; font-style: italic">/* result of typed command execution */</span>

    <span style="color: #666666; font-style: italic">/* Read the command and strip leading spaces.  If it&#39;s empty, return. */</span>
    cmd <span style="color: #333333">=</span> get_typed_command ();
    <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #8888FF">&#39; &#39;</span> <span style="color: #333333">==</span> <span style="color: #333333">*</span>cmd) { cmd<span style="color: #333333">++</span>; }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #8888FF">&#39;\0&#39;</span> <span style="color: #333333">==</span> <span style="color: #333333">*</span>cmd) { <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>; }

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Walk over the command verb, calculating its length as we go.  Space</span>
<span style="color: #666666; font-style: italic">     * or NUL marks the end of the verb, after which the argument begins.</span>
<span style="color: #666666; font-style: italic">     * Leading spaces are first stripped from the argument, but we make no</span>
<span style="color: #666666; font-style: italic">     * attempt to deal with trailing spaces (argument names must match</span>
<span style="color: #666666; font-style: italic">     * exactly).</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">for</span> (cmd_len <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; <span style="color: #8888FF">&#39; &#39;</span> <span style="color: #333333">!=</span> cmd[cmd_len] <span style="color: #333333">&amp;&amp;</span> <span style="color: #8888FF">&#39;\0&#39;</span> <span style="color: #333333">!=</span> cmd[cmd_len]; cmd_len<span style="color: #333333">++</span>);
    arg <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>cmd[cmd_len];
    <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #8888FF">&#39; &#39;</span> <span style="color: #333333">==</span> <span style="color: #333333">*</span>arg) { arg<span style="color: #333333">++</span>; }

    <span style="color: #666666; font-style: italic">/* Compare the typed verb with each command in our list. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; <span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> cmd_list[idx].name; idx<span style="color: #333333">++</span>) {

        <span style="color: #666666; font-style: italic">/* If the typed verb is not long enough, it can&#39;t match. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (cmd_list[idx].min_len <span style="color: #333333">&gt;</span> cmd_len) { <span style="color: #228899; font-weight: bold">continue</span>; }

	<span style="color: #666666; font-style: italic">/* Compare the prefix of the command with the typed verb. */</span>
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strncasecmp (cmd_list[idx].name, cmd, cmd_len)) { <span style="color: #228899; font-weight: bold">continue</span>; }

	<span style="color: #666666; font-style: italic">/* Execute the command found. */</span>
	<span style="color: #228899; font-weight: bold">switch</span> (cmd_list[idx].cmd) {
	    <span style="color: #228899; font-weight: bold">case</span> TC_BUY:
	        result <span style="color: #333333">=</span> typed_cmd_buy (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_CHARGE:
	        result <span style="color: #333333">=</span> typed_cmd_charge (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_DO:
	        result <span style="color: #333333">=</span> typed_cmd_do (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_DRINK:
	        result <span style="color: #333333">=</span> typed_cmd_drink (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_DROP:
	        result <span style="color: #333333">=</span> typed_cmd_drop (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">!</span>player_has_board ()) {
		    game_info.x_speed <span style="color: #333333">=</span> MOTION_SPEED;
		}
		<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">!</span>player_has_jetpack ()) {
		    game_info.y_speed <span style="color: #333333">=</span> MOTION_SPEED;
		}
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_FIX:
	        result <span style="color: #333333">=</span> typed_cmd_fix (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_FLASH:
	        result <span style="color: #333333">=</span> typed_cmd_flash (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_GET:
	        result <span style="color: #333333">=</span> typed_cmd_get (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">if</span> (player_has_board ()) {
		    game_info.x_speed <span style="color: #333333">=</span> MOTION_SPEED <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">3</span>;
		}
		<span style="color: #228899; font-weight: bold">if</span> (player_has_jetpack ()) {
		    game_info.y_speed <span style="color: #333333">=</span> MOTION_SPEED <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">3</span>;
		}
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_GO:
	        result <span style="color: #333333">=</span> typed_cmd_go (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_INSTALL:
	        result <span style="color: #333333">=</span> typed_cmd_install (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_INVENTORY:
	        result <span style="color: #333333">=</span> typed_cmd_inventory (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_SIGH:
	        result <span style="color: #333333">=</span> typed_cmd_sigh (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_USE:
	        result <span style="color: #333333">=</span> typed_cmd_use (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> TC_WEAR:
	        result <span style="color: #333333">=</span> typed_cmd_wear (<span style="color: #333333">&amp;</span>game_info.where, arg);
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #997700; font-weight: bold">default:</span>
		show_status (<span style="background-color: #e0e0ff">&quot;Bug...!&quot;</span>);
		result <span style="color: #333333">=</span> TC_ALLOW_EDIT;
	        <span style="color: #228899; font-weight: bold">break</span>;
	}

	<span style="color: #666666; font-style: italic">/* Handle command result and return. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (TC_CHANGE_ROOM <span style="color: #333333">==</span> result) {
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">1</span>;
	}
	<span style="color: #228899; font-weight: bold">if</span> (TC_ALLOW_EDIT <span style="color: #333333">!=</span> result) {
	    reset_typed_command ();
	    <span style="color: #228899; font-weight: bold">if</span> (TC_REDRAW_ROOM <span style="color: #333333">==</span> result) {
	        redraw_room ();
	    }
	}
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    }
    
    <span style="color: #666666; font-style: italic">/* The command was not recognized. */</span>
    show_status (<span style="background-color: #e0e0ff">&quot;What are you babbling about?&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * init_game</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Initialize the game information, including the initial</span>
<span style="color: #666666; font-style: italic"> *                room, photo display, motion speed, and so forth.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">init_game</span> ()
{
    game_info.where <span style="color: #333333">=</span> start_in_room ();
    game_info.map_x <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    game_info.map_y <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    game_info.x_speed <span style="color: #333333">=</span> MOTION_SPEED;
    game_info.y_speed <span style="color: #333333">=</span> MOTION_SPEED;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * move_photo_down</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Move background photo down one or more pixels.  Amount of</span>
<span style="color: #666666; font-style: italic"> *                motion depends on game_info.y_speed.  Movement stops at</span>
<span style="color: #666666; font-style: italic"> *                upper edge of photo.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: shifts view window</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">move_photo_down</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> delta; <span style="color: #666666; font-style: italic">/* Number of pixels by which to move. */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> idx;   <span style="color: #666666; font-style: italic">/* Index over rows to redraw.         */</span>

    <span style="color: #666666; font-style: italic">/* Calculate the number of pixels by which to move. */</span>
    delta <span style="color: #333333">=</span> (game_info.y_speed <span style="color: #333333">&gt;</span> game_info.map_y <span style="color: #333333">?</span>
	     game_info.map_y <span style="color: #333333">:</span> game_info.y_speed);

    <span style="color: #666666; font-style: italic">/* Shift the logical view upward. */</span>
    game_info.map_y <span style="color: #333333">-=</span> delta;
    set_view_window (game_info.map_x, game_info.map_y);

    <span style="color: #666666; font-style: italic">/* Draw the newly exposed lines. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; delta <span style="color: #333333">&gt;</span> idx; idx<span style="color: #333333">++</span>) {
	(<span style="color: #6666ff; font-weight: bold">void</span>)draw_horiz_line (idx);
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * move_photo_left</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Move background photo left one or more pixels.  Amount of</span>
<span style="color: #666666; font-style: italic"> *                motion depends on game_info.x_speed.  Movement stops at</span>
<span style="color: #666666; font-style: italic"> *                right edge of photo.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: shifts view window</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">move_photo_left</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> delta; <span style="color: #666666; font-style: italic">/* Number of pixels by which to move. */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> idx;   <span style="color: #666666; font-style: italic">/* Index over columns to redraw.      */</span>

    <span style="color: #666666; font-style: italic">/* Calculate the number of pixels by which to move. */</span>
    delta <span style="color: #333333">=</span> room_photo_width (game_info.where) <span style="color: #333333">-</span> SCROLL_X_DIM <span style="color: #333333">-</span>
    	    game_info.map_x;
    delta <span style="color: #333333">=</span> (game_info.x_speed <span style="color: #333333">&gt;</span> delta <span style="color: #333333">?</span> delta <span style="color: #333333">:</span> game_info.x_speed);

    <span style="color: #666666; font-style: italic">/* Shift the logical view to the right. */</span>
    game_info.map_x <span style="color: #333333">+=</span> delta;
    set_view_window (game_info.map_x, game_info.map_y);

    <span style="color: #666666; font-style: italic">/* Draw the newly exposed lines. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>; delta <span style="color: #333333">&gt;=</span> idx; idx<span style="color: #333333">++</span>) {
	(<span style="color: #6666ff; font-weight: bold">void</span>)draw_vert_line (SCROLL_X_DIM <span style="color: #333333">-</span> idx);
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * move_photo_right</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Move background photo right one or more pixels.  Amount of</span>
<span style="color: #666666; font-style: italic"> *                motion depends on game_info.x_speed.  Movement stops at</span>
<span style="color: #666666; font-style: italic"> *                left edge of photo.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: shifts view window</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">move_photo_right</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> delta; <span style="color: #666666; font-style: italic">/* Number of pixels by which to move. */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> idx;   <span style="color: #666666; font-style: italic">/* Index over columns to redraw.      */</span>

    <span style="color: #666666; font-style: italic">/* Calculate the number of pixels by which to move. */</span>
    delta <span style="color: #333333">=</span> (game_info.x_speed <span style="color: #333333">&gt;</span> game_info.map_x <span style="color: #333333">?</span>
	     game_info.map_x <span style="color: #333333">:</span> game_info.x_speed);

    <span style="color: #666666; font-style: italic">/* Shift the logical view to the left. */</span>
    game_info.map_x <span style="color: #333333">-=</span> delta;
    set_view_window (game_info.map_x, game_info.map_y);

    <span style="color: #666666; font-style: italic">/* Draw the newly exposed lines. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; delta <span style="color: #333333">&gt;</span> idx; idx<span style="color: #333333">++</span>) {
	(<span style="color: #6666ff; font-weight: bold">void</span>)draw_vert_line (idx);
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * move_photo_up</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Move background photo up one or more pixels.  Amount of</span>
<span style="color: #666666; font-style: italic"> *                motion depends on game_info.y_speed.  Movement stops at</span>
<span style="color: #666666; font-style: italic"> *                lower edge of photo.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: shifts view window</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">move_photo_up</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> delta; <span style="color: #666666; font-style: italic">/* Number of pixels by which to move. */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> idx;   <span style="color: #666666; font-style: italic">/* Index over rows to redraw.         */</span>

    <span style="color: #666666; font-style: italic">/* Calculate the number of pixels by which to move. */</span>
    delta <span style="color: #333333">=</span> room_photo_height (game_info.where) <span style="color: #333333">-</span> SCROLL_Y_DIM <span style="color: #333333">-</span> 
    	    game_info.map_y;
    delta <span style="color: #333333">=</span> (game_info.y_speed <span style="color: #333333">&gt;</span> delta <span style="color: #333333">?</span> delta <span style="color: #333333">:</span> game_info.y_speed);

    <span style="color: #666666; font-style: italic">/* Shift the logical view upward. */</span>
    game_info.map_y <span style="color: #333333">+=</span> delta;
    set_view_window (game_info.map_x, game_info.map_y);

    <span style="color: #666666; font-style: italic">/* Draw the newly exposed lines. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>; delta <span style="color: #333333">&gt;=</span> idx; idx<span style="color: #333333">++</span>) {
	(<span style="color: #6666ff; font-weight: bold">void</span>)draw_horiz_line (SCROLL_Y_DIM <span style="color: #333333">-</span> idx);
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * redraw_room</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Draw all lines on the screen.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: Draws the entire screen (but not the status bar).</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">redraw_room</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> i; <span style="color: #666666; font-style: italic">/* index over rows */</span>

    <span style="color: #666666; font-style: italic">/* Draw all lines in the scroll region. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> SCROLL_Y_DIM; i<span style="color: #333333">++</span>) {
	(<span style="color: #6666ff; font-weight: bold">void</span>)draw_horiz_line (i);
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * status_thread</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Function executed by status message helper thread.</span>
<span style="color: #666666; font-style: italic"> *                Waits for a message to be displayed, then shows the</span>
<span style="color: #666666; font-style: italic"> *                message for 1.5 seconds before deleting it.  If a</span>
<span style="color: #666666; font-style: italic"> *                new message has appeared in the meantime, restarts the</span>
<span style="color: #666666; font-style: italic"> *                clock and tries again.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none (ignored)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: NULL</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: Changes the status message to an empty string.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">status_thread</span> (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> ignore)
{
    <span style="color: #228899; font-weight: bold">struct</span> timespec ts; <span style="color: #666666; font-style: italic">/* absolute wake-up time */</span>

    <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #6666ff; font-weight: bold">1</span>) {

	<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	 * Wait for a message to appear.  Note that we must check the</span>
<span style="color: #666666; font-style: italic">	 * condition after acquiring the lock, and that pthread_cond_wait</span>
<span style="color: #666666; font-style: italic">	 * yields the lock, then reacquires the lock before returning.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	(<span style="color: #6666ff; font-weight: bold">void</span>)pthread_mutex_lock (<span style="color: #333333">&amp;</span>msg_lock);
	<span style="color: #228899; font-weight: bold">while</span> (<span style="color: #8888FF">&#39;\0&#39;</span> <span style="color: #333333">==</span> status_msg[<span style="color: #6666ff; font-weight: bold">0</span>]) {
	    pthread_cond_wait (<span style="color: #333333">&amp;</span>msg_cv, <span style="color: #333333">&amp;</span>msg_lock);
	}

	<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	 * A message is present: if we stop before the timeout</span>
<span style="color: #666666; font-style: italic">	 * passes, assume that a new one has been posted; if the</span>
<span style="color: #666666; font-style: italic">	 * timeout passes, clear the message and wait for a new one.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #228899; font-weight: bold">do</span> {
	    <span style="color: #666666; font-style: italic">/* Get the current time. */</span>
	    clock_gettime (CLOCK_REALTIME, <span style="color: #333333">&amp;</span>ts);
	    
	    <span style="color: #666666; font-style: italic">/* Add 1.5 seconds to it. */</span>
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">500000000</span> <span style="color: #333333">&lt;=</span> ts.tv_nsec) {
		ts.tv_sec <span style="color: #333333">+=</span> <span style="color: #6666ff; font-weight: bold">2</span>;
		ts.tv_nsec <span style="color: #333333">-=</span> <span style="color: #6666ff; font-weight: bold">500000000</span>;
	    } <span style="color: #228899; font-weight: bold">else</span> {
		ts.tv_sec <span style="color: #333333">+=</span> <span style="color: #6666ff; font-weight: bold">1</span>;
		ts.tv_nsec <span style="color: #333333">+=</span> <span style="color: #6666ff; font-weight: bold">500000000</span>;
	    }

	    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	     * And go to sleep.  If we wake up due to anything but a</span>
<span style="color: #666666; font-style: italic">	     * timeout, we assume (possibly incorrectly) that a new</span>
<span style="color: #666666; font-style: italic">	     * message has appeared and try to wait 1.5 seconds again.</span>
<span style="color: #666666; font-style: italic">	     */</span>
	} <span style="color: #228899; font-weight: bold">while</span> (ETIMEDOUT <span style="color: #333333">!=</span> 
		 pthread_cond_timedwait (<span style="color: #333333">&amp;</span>msg_cv, <span style="color: #333333">&amp;</span>msg_lock, <span style="color: #333333">&amp;</span>ts));

	<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	 * Clear the message, then release the lock (remember that </span>
<span style="color: #666666; font-style: italic">	 * pthread_cond_timedwait reacquires the lock before returning).</span>
<span style="color: #666666; font-style: italic">	 */</span>
	status_msg[<span style="color: #6666ff; font-weight: bold">0</span>] <span style="color: #333333">=</span> <span style="color: #8888FF">&#39;\0&#39;</span>;
	(<span style="color: #6666ff; font-weight: bold">void</span>)pthread_mutex_unlock (<span style="color: #333333">&amp;</span>msg_lock);
    }

    <span style="color: #666666; font-style: italic">/* This code never executes--the thread should always be cancelled. */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * time_is_after </span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Check whether one time is at or after a second time.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: t1 -- the first time</span>
<span style="color: #666666; font-style: italic"> *           t2 -- the second time</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 1 if t1 &gt;= t2</span>
<span style="color: #666666; font-style: italic"> *                 0 if t1 &lt; t2</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">time_is_after</span> (<span style="color: #228899; font-weight: bold">struct</span> timeval<span style="color: #333333">*</span> t1, <span style="color: #228899; font-weight: bold">struct</span> timeval<span style="color: #333333">*</span> t2)
{
    <span style="color: #228899; font-weight: bold">if</span> (t1<span style="color: #333333">-&gt;</span>tv_sec <span style="color: #333333">==</span> t2<span style="color: #333333">-&gt;</span>tv_sec)
        <span style="color: #228899; font-weight: bold">return</span> (t1<span style="color: #333333">-&gt;</span>tv_usec <span style="color: #333333">&gt;=</span> t2<span style="color: #333333">-&gt;</span>tv_usec);
    <span style="color: #228899; font-weight: bold">if</span> (t1<span style="color: #333333">-&gt;</span>tv_sec <span style="color: #333333">&gt;</span> t2<span style="color: #333333">-&gt;</span>tv_sec)
        <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">1</span>;
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * show_status (interface function; declared in world.h)</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Show a specific status message of up to STATUS_MSG_LEN</span>
<span style="color: #666666; font-style: italic"> *                characters.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: s -- the string used for the status message</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: Overwrites any previous message.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">show_status</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> s)
{
    <span style="color: #666666; font-style: italic">/* msg_lock critical section starts here. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)pthread_mutex_lock (<span style="color: #333333">&amp;</span>msg_lock);

    <span style="color: #666666; font-style: italic">/* Copy the new message under the protection of msg_lock. */</span>
    strncpy (status_msg, s, STATUS_MSG_LEN);
    status_msg[STATUS_MSG_LEN] <span style="color: #333333">=</span> <span style="color: #8888FF">&#39;\0&#39;</span>;

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Wake up the status message helper thread.  Note that we still hold</span>
<span style="color: #666666; font-style: italic">     * the msg_lock, so the thread can&#39;t wake up until we release it.</span>
<span style="color: #666666; font-style: italic">     */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)pthread_cond_signal (<span style="color: #333333">&amp;</span>msg_cv);

    <span style="color: #666666; font-style: italic">/* msg_lock critical section ends here. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)pthread_mutex_unlock (<span style="color: #333333">&amp;</span>msg_lock);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * tux_controller_thread</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: this function is a thread that will be used</span>
<span style="color: #666666; font-style: italic"> *					every button pushed on the controller.</span>
<span style="color: #666666; font-style: italic"> *					It connects the TUX controller to the code</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none (ignored)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: NULL </span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: Changes the status message to an empty string.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">tux_controller_thread</span> (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> ignore)
{

	<span style="color: #666666; font-style: italic">/* Grant ourselves permission to use ports 0-1023 */</span>
    <span style="color: #228899; font-weight: bold">if</span> (ioperm (<span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">1024</span>, <span style="color: #6666ff; font-weight: bold">1</span>) <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>) 
    {
		perror (<span style="background-color: #e0e0ff">&quot;ioperm&quot;</span>);
		<span style="color: #228899; font-weight: bold">return</span> (<span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #333333">*</span>)<span style="color: #6666ff; font-weight: bold">3</span>;
    }
  <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Variables used to carry information between event loop ticks; see</span>
<span style="color: #666666; font-style: italic">     * initialization below for explanations of purpose.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> enter_room <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;      <span style="color: #666666; font-style: italic">/* player has changed rooms        */</span>
    <span style="color: #6666ff; font-weight: bold">cmd_t</span> cmd, last_cmd;
    last_cmd <span style="color: #333333">=</span> CMD_NONE;
    cmd <span style="color: #333333">=</span> CMD_NONE;

    <span style="color: #666666; font-style: italic">/* The main event loop. */</span>
    <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #6666ff; font-weight: bold">1</span>) {
    	usleep(<span style="color: #6666ff; font-weight: bold">10000</span>);
		<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">		 * Update the screen, preparing the VGA palette and photo-drawing</span>
<span style="color: #666666; font-style: italic">		 * routines and drawing a new room photo first if the player has</span>
<span style="color: #666666; font-style: italic">		 * entered a new room, then showing the screen (and status bar,</span>
<span style="color: #666666; font-style: italic">		 * once you have it working).</span>
<span style="color: #666666; font-style: italic">		 */</span>
		<span style="color: #228899; font-weight: bold">if</span> (enter_room) {
		    <span style="color: #666666; font-style: italic">/* Reset the view window to (0,0). */</span>
		    game_info.map_x <span style="color: #333333">=</span> game_info.map_y <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		    set_view_window (game_info.map_x, game_info.map_y);

		    <span style="color: #666666; font-style: italic">/* Discard any partially-typed command. */</span>
		    reset_typed_command ();
		    
		    <span style="color: #666666; font-style: italic">/* Adjust colors and photo drawing for the current room photo. */</span>
		    prep_room (game_info.where);

		    <span style="color: #666666; font-style: italic">/* Draw the room (calls show. */</span>
		    redraw_room ();

		    <span style="color: #666666; font-style: italic">/* Only draw once on entry. */</span>
		    enter_room <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		}

		<span style="color: #666666; font-style: italic">//goes through each case possible so through possible moves from buttons</span>
		cmd <span style="color: #333333">=</span>  get_cmd_button();


			<span style="color: #228899; font-weight: bold">switch</span> (cmd) {
			    <span style="color: #228899; font-weight: bold">case</span> CMD_UP:    move_photo_down ();  <span style="color: #228899; font-weight: bold">break</span>;
			    <span style="color: #228899; font-weight: bold">case</span> CMD_RIGHT: move_photo_left ();  <span style="color: #228899; font-weight: bold">break</span>;
			    <span style="color: #228899; font-weight: bold">case</span> CMD_DOWN:  move_photo_up ();    <span style="color: #228899; font-weight: bold">break</span>;
			    <span style="color: #228899; font-weight: bold">case</span> CMD_LEFT:  move_photo_right (); <span style="color: #228899; font-weight: bold">break</span>;
			    <span style="color: #228899; font-weight: bold">case</span> CMD_MOVE_LEFT:
			    <span style="color: #228899; font-weight: bold">if</span>(cmd <span style="color: #333333">!=</span> last_cmd)
					enter_room <span style="color: #333333">=</span> (TC_CHANGE_ROOM <span style="color: #333333">==</span> 
					      try_to_move_left (<span style="color: #333333">&amp;</span>game_info.where));
				<span style="color: #228899; font-weight: bold">break</span>;
			    <span style="color: #228899; font-weight: bold">case</span> CMD_ENTER:
			    <span style="color: #228899; font-weight: bold">if</span>(cmd <span style="color: #333333">!=</span> last_cmd)
					enter_room <span style="color: #333333">=</span> (TC_CHANGE_ROOM <span style="color: #333333">==</span>
					      try_to_enter (<span style="color: #333333">&amp;</span>game_info.where));
				<span style="color: #228899; font-weight: bold">break</span>;
			    <span style="color: #228899; font-weight: bold">case</span> CMD_MOVE_RIGHT:
			    <span style="color: #228899; font-weight: bold">if</span>(cmd <span style="color: #333333">!=</span> last_cmd)
					enter_room <span style="color: #333333">=</span> (TC_CHANGE_ROOM <span style="color: #333333">==</span> 
					      try_to_move_right (<span style="color: #333333">&amp;</span>game_info.where));
				<span style="color: #228899; font-weight: bold">break</span>;

			    <span style="color: #997700; font-weight: bold">default:</span> <span style="color: #228899; font-weight: bold">break</span>;
			}
		last_cmd <span style="color: #333333">=</span> cmd;

	}

}<span style="color: #666666; font-style: italic">//end tux_controller_thread</span>

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * main</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Play the adventure game.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none (command line arguments are ignored)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 0 on success, 3 in panic situations</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">main</span> ()
{
    <span style="color: #6666ff; font-weight: bold">game_condition_t</span> game;  <span style="color: #666666; font-style: italic">/* outcome of playing */</span>

    <span style="color: #666666; font-style: italic">/* Randomize for more fun (remove for deterministic layout). */</span>
    srand (time (<span style="color: #007722">NULL</span>));


    <span style="color: #666666; font-style: italic">/* Provide some protection against fatal errors. */</span>
    clean_on_signals ();

    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">!</span>build_world ()) {PANIC (<span style="background-color: #e0e0ff">&quot;can&#39;t build world&quot;</span>);}
    init_game ();

    <span style="color: #666666; font-style: italic">/* Perform sanity checks. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> sanity_check ()) {
	PANIC (<span style="background-color: #e0e0ff">&quot;failed sanity checks&quot;</span>);
    }


    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> pthread_create (<span style="color: #333333">&amp;</span>tux_controller_thread_id, <span style="color: #007722">NULL</span>, tux_controller_thread, <span style="color: #007722">NULL</span>)) {
        PANIC (<span style="background-color: #e0e0ff">&quot;failed to create status thread&quot;</span>);
    }
    push_cleanup (cancel_tux_controller_thread, <span style="color: #007722">NULL</span>); {

		    <span style="color: #666666; font-style: italic">/* Create status message thread. */</span>
		    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> pthread_create (<span style="color: #333333">&amp;</span>status_thread_id, <span style="color: #007722">NULL</span>, status_thread, <span style="color: #007722">NULL</span>)) {
		        PANIC (<span style="background-color: #e0e0ff">&quot;failed to create status thread&quot;</span>);
		    }
		    push_cleanup (cancel_status_thread, <span style="color: #007722">NULL</span>); {

			<span style="color: #666666; font-style: italic">/* Start mode X. */</span>
			<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> set_mode_X (fill_horiz_buffer, fill_vert_buffer)) {
			    PANIC (<span style="background-color: #e0e0ff">&quot;cannot initialize mode X&quot;</span>);
			}
			push_cleanup ((<span style="color: #6666ff; font-weight: bold">cleanup_fn_t</span>)clear_mode_X, <span style="color: #007722">NULL</span>); {

			    <span style="color: #666666; font-style: italic">/* Initialize the keyboard and/or Tux controller. */</span>
			    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> init_input ()) {
				PANIC (<span style="background-color: #e0e0ff">&quot;cannot initialize input&quot;</span>);
			    }
			    push_cleanup ((<span style="color: #6666ff; font-weight: bold">cleanup_fn_t</span>)shutdown_input, <span style="color: #007722">NULL</span>); {

				game <span style="color: #333333">=</span> game_loop ();

			    } pop_cleanup (<span style="color: #6666ff; font-weight: bold">1</span>);

			} pop_cleanup (<span style="color: #6666ff; font-weight: bold">1</span>);

	    } pop_cleanup (<span style="color: #6666ff; font-weight: bold">1</span>);
	} pop_cleanup (<span style="color: #6666ff; font-weight: bold">1</span>);

    <span style="color: #666666; font-style: italic">/* Print a message about the outcome. */</span>
    <span style="color: #228899; font-weight: bold">switch</span> (game) {
	<span style="color: #228899; font-weight: bold">case</span> GAME_WON: printf (<span style="background-color: #e0e0ff">&quot;You win the game!  CONGRATULATIONS!</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>); <span style="color: #228899; font-weight: bold">break</span>;
	<span style="color: #228899; font-weight: bold">case</span> GAME_QUIT: printf (<span style="background-color: #e0e0ff">&quot;Quitter!</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>); <span style="color: #228899; font-weight: bold">break</span>;
    }

    <span style="color: #666666; font-style: italic">/* Return success. */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}


<span style="color: #557799">#if !defined(NDEBUG)</span>
<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * sanity_check </span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Perform checks on changes to constants and enumerated values.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 0 if checks pass, -1 if any fail</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> 
<span style="color: #55eedd; font-weight: bold">sanity_check</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> cnt[NUM_TC_VALUES]; <span style="color: #666666; font-style: italic">/* count of synonymous commands      */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> idx;                <span style="color: #666666; font-style: italic">/* index over list of typed commands */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> ret_val;            <span style="color: #666666; font-style: italic">/* return value                      */</span>

    <span style="color: #666666; font-style: italic">/* Initialize return value. */</span>
    ret_val <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

    <span style="color: #666666; font-style: italic">/* Check typed command list. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)memset (cnt, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #228899; font-weight: bold">sizeof</span> (cnt));
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; <span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> cmd_list[idx].name; idx<span style="color: #333333">++</span>) {
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">&gt;</span> cmd_list[idx].min_len) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Typed command %s always matches.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>,
		     cmd_list[idx].name);
	    ret_val <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
	    <span style="color: #228899; font-weight: bold">continue</span>;
	}
	<span style="color: #228899; font-weight: bold">if</span> (cmd_list[idx].min_len <span style="color: #333333">&gt;</span> strlen (cmd_list[idx].name)) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Typed command %s can never match.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>,
		     cmd_list[idx].name);
	    ret_val <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
	    <span style="color: #228899; font-weight: bold">continue</span>;
	}
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;</span> cmd_list[idx].cmd <span style="color: #333333">||</span> NUM_TC_VALUES <span style="color: #333333">&lt;=</span> cmd_list[idx].cmd) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Typed command %s has invalid command number.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>,
		     cmd_list[idx].name);
	    ret_val <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
	    <span style="color: #228899; font-weight: bold">continue</span>;
	}
	cnt[cmd_list[idx].cmd]<span style="color: #333333">++</span>;
    }

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Now check that every typed command can be issued with some string. </span>
<span style="color: #666666; font-style: italic">     * We could be fancier and check that it&#39;s possible to match (shadowing</span>
<span style="color: #666666; font-style: italic">     * can prevent it: matching &quot;a&quot; in entry #1 prevents matching &quot;an&quot; in</span>
<span style="color: #666666; font-style: italic">     * entry #2.).</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; NUM_TC_VALUES <span style="color: #333333">&gt;</span> idx; idx<span style="color: #333333">++</span>) {
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> cnt[idx]) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;TC_ #%d has no valid command strings.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, idx);
	    ret_val <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
	}
    }

    <span style="color: #666666; font-style: italic">/* Return success/failure. */</span>
    <span style="color: #228899; font-weight: bold">return</span> ret_val;
}
<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* !defined(NDEBUG) */</span><span style="color: #557799"></span>
</pre></div> 
<p></p>
                
            </section>
           
        
        
        
        
        
        
        
            <!--assert.c-->
            <section>
            <hnew id="assert.c">assert.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * assert.c - support for assertions and fatal exceptions</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2005-2009 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    2</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Tue Feb  1 20:26:56 2005</span>
<span style="color: #666666; font-style: italic"> * Filename:	    assert.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Tue Feb  1 20:26:56 2005</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sun Sep 13 12:30:05 2009</span>
<span style="color: #666666; font-style: italic"> *		Adapted from later MP2 versions for use with maze game.</span>
<span style="color: #666666; font-style: italic"> */</span>


<span style="color: #557799">#include &lt;signal.h&gt;</span>
<span style="color: #557799">#include &lt;stdint.h&gt;</span>
<span style="color: #557799">#include &lt;stdio.h&gt;</span>
<span style="color: #557799">#include &lt;stdlib.h&gt;</span>

<span style="color: #557799">#include &quot;assert.h&quot;</span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * The cleanup stack is implemented as a linked list of cleanup_t structures,</span>
<span style="color: #666666; font-style: italic"> * defined here.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">cleanup_t</span> <span style="color: #6666ff; font-weight: bold">cleanup_t</span>;
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">cleanup_t</span> {
    <span style="color: #6666ff; font-weight: bold">cleanup_fn_t</span> fn;    <span style="color: #666666; font-style: italic">/* the function to be called                  */</span>
    <span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span>        arg;   <span style="color: #666666; font-style: italic">/* the argument to pass to the function       */</span>
    <span style="color: #6666ff; font-weight: bold">cleanup_t</span><span style="color: #333333">*</span>   next;  <span style="color: #666666; font-style: italic">/* a pointer to the next cleanup on the stack */</span>
};


<span style="color: #666666; font-style: italic">/* Helper function prototypes; see function headers for further information. */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">catch_signal</span> (<span style="color: #6666ff; font-weight: bold">int</span> sig);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">set_signal_behavior</span> (<span style="color: #6666ff; font-weight: bold">int32_t</span> num);


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * MODULE VARIABLES</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #666666; font-style: italic">/* This variable points to the top of the cleanup stack. */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">cleanup_t</span><span style="color: #333333">*</span> cleanup_stack <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;



<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * INTERFACE FUNCTIONS -- these functions serve as entry points from other</span>
<span style="color: #666666; font-style: italic"> * modules</span>
<span style="color: #666666; font-style: italic"> */</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * clean_on_signals</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Request that the stack of cleanup functions be executed </span>
<span style="color: #666666; font-style: italic"> *                when certain signals occur, including SIGSEGV, SIGBUS, </span>
<span style="color: #666666; font-style: italic"> *                SIGQUIT, and SIGINT.  These signals are then allowed to </span>
<span style="color: #666666; font-style: italic"> *                proceed with their default behavior.  In addition, </span>
<span style="color: #666666; font-style: italic"> *                ignores SIGTSTP.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: discards (most of) previous signal behavior specifications</span>
<span style="color: #666666; font-style: italic"> *   WARNING: not compatible with other redefinitions of behavior for the</span>
<span style="color: #666666; font-style: italic"> *            specified signals</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">clean_on_signals</span> ()
{
    <span style="color: #228899; font-weight: bold">struct</span> sigaction sa;   <span style="color: #666666; font-style: italic">/* signal behavior definition structure  */</span>

    <span style="color: #666666; font-style: italic">/* Use helper function to set up behavior for these four signals. */</span>
    set_signal_behavior (SIGINT);
    set_signal_behavior (SIGSEGV);
    set_signal_behavior (SIGBUS);
    set_signal_behavior (SIGQUIT);

    <span style="color: #666666; font-style: italic">/* Ignore stop requests from the keyboard (tty). */</span>
    sa.sa_handler <span style="color: #333333">=</span> SIG_IGN;
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">==</span> sigaction (SIGTSTP, <span style="color: #333333">&amp;</span>sa, <span style="color: #007722">NULL</span>))
        PANIC (<span style="background-color: #e0e0ff">&quot;writing signal action failed&quot;</span>);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * do_cleanups</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Do all cleanups on the stack.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: executes all cleanups and frees alls structure use to </span>
<span style="color: #666666; font-style: italic"> *                 store cleanup function information</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">do_cleanups</span> ()
{
    <span style="color: #666666; font-style: italic">/* Pop until the stack is empty. */</span>
    <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> cleanup_stack)
        pop_cleanup (<span style="color: #6666ff; font-weight: bold">1</span>);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * pop_cleanup</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Pop the top function from the stack of cleanup </span>
<span style="color: #666666; font-style: italic"> *                functions, and execute it if the argument is non-zero.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: execute -- popped cleanup function is executed if non-zero</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: frees the structure use to store cleanup function </span>
<span style="color: #666666; font-style: italic"> *                 information</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">pop_cleanup</span> (<span style="color: #6666ff; font-weight: bold">int</span> execute)
{
    <span style="color: #6666ff; font-weight: bold">cleanup_t</span><span style="color: #333333">*</span> c;

    <span style="color: #666666; font-style: italic">/* Module interface: check for stack underflow. */</span>
    ASSERT (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> cleanup_stack);

    <span style="color: #666666; font-style: italic">/* Check underflow again, in case it escaped our debugging runs. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> (c <span style="color: #333333">=</span> cleanup_stack)) {
	cleanup_stack <span style="color: #333333">=</span> c<span style="color: #333333">-&gt;</span>next; <span style="color: #666666; font-style: italic">/* Remove top element from stack. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (execute)             <span style="color: #666666; font-style: italic">/* Execute it if requested.       */</span>
	    (<span style="color: #333333">*</span>(c<span style="color: #333333">-&gt;</span>fn)) (c<span style="color: #333333">-&gt;</span>arg);
	free (c);                <span style="color: #666666; font-style: italic">/* And free the structure.        */</span>
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * push_cleanup</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Push a cleanup function on to the stack of cleanup </span>
<span style="color: #666666; font-style: italic"> *                functions.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: fn -- the cleanup function to be pushed</span>
<span style="color: #666666; font-style: italic"> *           arg -- the argument to the cleanup function (when called)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: dynamically allocates a structure to store cleanup</span>
<span style="color: #666666; font-style: italic"> *                 function information</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">push_cleanup</span> (<span style="color: #6666ff; font-weight: bold">cleanup_fn_t</span> fn, <span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">cleanup_t</span><span style="color: #333333">*</span> c;    <span style="color: #666666; font-style: italic">/* new cleanup stack element */</span>

    <span style="color: #666666; font-style: italic">/* Module interface: check argument validity. */</span>
    ASSERT (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> fn);

    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (c <span style="color: #333333">=</span> malloc (<span style="color: #228899; font-weight: bold">sizeof</span> (<span style="color: #333333">*</span>c)))) <span style="color: #666666; font-style: italic">/* Create a new structure.     */</span>
        ABORT (<span style="background-color: #e0e0ff">&quot;out of memory&quot;</span>);
    c<span style="color: #333333">-&gt;</span>fn         <span style="color: #333333">=</span> fn;                     <span style="color: #666666; font-style: italic">/* Fill in the new structure.  */</span>
    c<span style="color: #333333">-&gt;</span>arg        <span style="color: #333333">=</span> arg;
    c<span style="color: #333333">-&gt;</span>next       <span style="color: #333333">=</span> cleanup_stack;          <span style="color: #666666; font-style: italic">/* And push it onto the stack. */</span>
    cleanup_stack <span style="color: #333333">=</span> c;
}



<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * HELPER FUNCTIONS -- these functions are only called from other functions</span>
<span style="color: #666666; font-style: italic"> * in this file</span>
<span style="color: #666666; font-style: italic"> */</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * catch_signal</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Signal handler used to execute cleanups before termination.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: sig -- signal number that invoked handler</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: executes stack of cleanup functions and regenerates</span>
<span style="color: #666666; font-style: italic"> *                 signal to force default signal behavior</span>
<span style="color: #666666; font-style: italic"> *   WARNING: will loop forever if signal&#39;s default behavior is not restored</span>
<span style="color: #666666; font-style: italic"> *            after handler execution!</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">catch_signal</span> (<span style="color: #6666ff; font-weight: bold">int</span> sig)
{
    do_cleanups ();
    kill (getpid (), sig);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * set_signal_behavior</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Installs a signal handler that executes the cleanup stack</span>
<span style="color: #666666; font-style: italic"> *                and requests that the default signal behavior be restored </span>
<span style="color: #666666; font-style: italic"> *                after execution of the handler.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: num -- signal number for which behavior should be changed</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: discards (most of) previous signal behavior specification</span>
<span style="color: #666666; font-style: italic"> *   WARNING: not compatible with other redefinitions of behavior for the</span>
<span style="color: #666666; font-style: italic"> *            specified signal</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">set_signal_behavior</span> (<span style="color: #6666ff; font-weight: bold">int32_t</span> num)
{
    <span style="color: #228899; font-weight: bold">struct</span> sigaction sa;   <span style="color: #666666; font-style: italic">/* signal behavior definition structure  */</span>

    <span style="color: #666666; font-style: italic">/* Read current signal behavior. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">==</span> sigaction (num, <span style="color: #007722">NULL</span>, <span style="color: #333333">&amp;</span>sa))
        PANIC (<span style="background-color: #e0e0ff">&quot;reading signal action failed&quot;</span>);

    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * Set signal handler and request restoration to default behavior of</span>
<span style="color: #666666; font-style: italic">     * signal after handler executes.</span>
<span style="color: #666666; font-style: italic">     */</span>
    sa.sa_handler <span style="color: #333333">=</span> catch_signal;
    sa.sa_flags <span style="color: #333333">|=</span> SA_ONESHOT;

    <span style="color: #666666; font-style: italic">/* Install new behavior for signal. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">==</span> sigaction (num, <span style="color: #333333">&amp;</span>sa, <span style="color: #007722">NULL</span>))
        PANIC (<span style="background-color: #e0e0ff">&quot;writing signal action failed&quot;</span>);
}
</pre></div>
<p></p>
                
            </section>
        
            
        
        
        
        
        
            <!--assert.h-->
            <section>
            <hnew id="assert.h">assert.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * assert.h - support for assertions and fatal exceptions</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2005-2009 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    2</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Tue Feb  1 20:09:44 2005</span>
<span style="color: #666666; font-style: italic"> * Filename:	    assert.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Tue Feb  1 20:09:44 2005</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sun Sep 13 12:29:12 2009</span>
<span style="color: #666666; font-style: italic"> *		Adapted from later MP2 versions for use with maze game.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#if !defined(ASSERT_H)</span>
<span style="color: #557799">#define ASSERT_H</span>


<span style="color: #557799">#include &lt;stdint.h&gt;</span>
<span style="color: #557799">#include &lt;stdio.h&gt;</span>
<span style="color: #557799">#include &lt;stdlib.h&gt;</span>
<span style="color: #557799">#include &lt;unistd.h&gt;</span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * This file defines several macros to simplify management of fatal </span>
<span style="color: #666666; font-style: italic"> * exceptions, including assertions (debugging tests), aborts (dump </span>
<span style="color: #666666; font-style: italic"> * core), and panics.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Compiling in debug mode (NDEBUG is NOT defined) produces more </span>
<span style="color: #666666; font-style: italic"> * informative error messages.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The macros:</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * ASSERT(cond) -- in debug mode, tests the condition and terminates the </span>
<span style="color: #666666; font-style: italic"> *                 program if it does not hold, printing a message with file </span>
<span style="color: #666666; font-style: italic"> *                 and line number and dumping an image of the program to</span>
<span style="color: #666666; font-style: italic"> *                 disk; does nothing if NDEBUG is defined</span>
<span style="color: #666666; font-style: italic"> * ABORT(msg) -- prints a message, dumps an image of the program to disk,</span>
<span style="color: #666666; font-style: italic"> *               and terminates the program; in debug mode, the message</span>
<span style="color: #666666; font-style: italic"> *               also includes file and line number</span>
<span style="color: #666666; font-style: italic"> * PANIC(msg) -- prints a message and terminates the program; in debug </span>
<span style="color: #666666; font-style: italic"> *               mode, the message also includes file and line number</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#if !defined(NDEBUG)</span>
<span style="color: #557799">#define ABORT(msg)                                                       \</span>
<span style="color: #557799">do {                                                                     \</span>
<span style="color: #557799">    do_cleanups ();                                                      \</span>
<span style="color: #557799">    fprintf (stderr, &quot;ABORTED -- %s: %s:%d\n&quot;, msg, __FILE__, __LINE__); \</span>
<span style="color: #557799">    abort ();                                                            \</span>
<span style="color: #557799">} while (0);</span>
<span style="color: #557799">#define ASSERT(x)                                                          \</span>
<span style="color: #557799">do {                                                                       \</span>
<span style="color: #557799">    if (!(x)) {                                                            \</span>
<span style="color: #557799">        do_cleanups ();                                                    \</span>
<span style="color: #557799">	fprintf (stderr, &quot;ASSERTION FAILED: %s:%d\n&quot;, __FILE__, __LINE__); \</span>
<span style="color: #557799">	abort ();                                                          \</span>
<span style="color: #557799">    }                                                                      \</span>
<span style="color: #557799">} while (0);</span>
<span style="color: #557799">#define PANIC(msg)                                                     \</span>
<span style="color: #557799">do {                                                                   \</span>
<span style="color: #557799">    do_cleanups ();                                                    \</span>
<span style="color: #557799">    fprintf (stderr, &quot;PANIC -- %s: %s:%d\n&quot;, msg, __FILE__, __LINE__); \</span>
<span style="color: #557799">    exit (3);                                                          \</span>
<span style="color: #557799">} while (0);</span>
<span style="color: #557799">#else </span><span style="color: #666666; font-style: italic">/* defined(NDEBUG) */</span><span style="color: #557799"></span>
<span style="color: #557799">#define ABORT(msg)                                                       \</span>
<span style="color: #557799">do {                                                                     \</span>
<span style="color: #557799">    do_cleanups ();                                                      \</span>
<span style="color: #557799">    abort ();                                                            \</span>
<span style="color: #557799">} while (0);</span>
<span style="color: #557799">#define ASSERT(x)</span>
<span style="color: #557799">#define PANIC(msg)                          \</span>
<span style="color: #557799">do {                                        \</span>
<span style="color: #557799">    do_cleanups ();                         \</span>
<span style="color: #557799">    fprintf (stderr, &quot;PANIC -- %s\n&quot;, msg); \</span>
<span style="color: #557799">    exit (3);                               \</span>
<span style="color: #557799">} while (0);</span>
<span style="color: #557799">#endif</span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * We maintain a stack of functions to be called when a fatal exception </span>
<span style="color: #666666; font-style: italic"> * occurs.  Each function takes one generic pointer argument; any</span>
<span style="color: #666666; font-style: italic"> * additional arguments must be marshaled into a block and a pointer to</span>
<span style="color: #666666; font-style: italic"> * the block passed to the function.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Cleanups should be used in block-structured form for clarity.  For</span>
<span style="color: #666666; font-style: italic"> * example,</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * push_cleanup (foo, NULL); {</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *     ... some work here (note indentation!)...</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * } pop_cleanup (1);</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Any functions called inside the block that generate fatal exceptions</span>
<span style="color: #666666; font-style: italic"> * then call the cleanup function (foo) before terminating the program.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #55eedd; font-weight: bold">void</span> (<span style="color: #333333">*</span><span style="color: #6666ff; font-weight: bold">cleanup_fn_t</span>) (<span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> arg);


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * Request that the stack of cleanup functions be executed when certain</span>
<span style="color: #666666; font-style: italic"> * signals occur, including SIGSEGV, SIGBUS, SIGQUIT, and SIGINT.  These</span>
<span style="color: #666666; font-style: italic"> * signals are then allowed to proceed with their default behavior.</span>
<span style="color: #666666; font-style: italic"> * In addition, ignores SIGTSTP.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">clean_on_signals</span> ();

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * Do all cleanups on the stack; this function should not normally be </span>
<span style="color: #666666; font-style: italic"> * called directly; instead, use the macros above (ASSERT, ABORT, or PANIC).</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">do_cleanups</span> ();

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * Pop the top function from the stack of cleanup functions, and execute it</span>
<span style="color: #666666; font-style: italic"> * if the argument is non-zero.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">pop_cleanup</span> (<span style="color: #6666ff; font-weight: bold">int</span> execute);

<span style="color: #666666; font-style: italic">/* Push a cleanup function on to the stack of cleanup functions. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">push_cleanup</span> (<span style="color: #6666ff; font-weight: bold">cleanup_fn_t</span> fn, <span style="color: #6666ff; font-weight: bold">void</span><span style="color: #333333">*</span> arg);

<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* ASSERT_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>
                
            </section>
        
        
        
            <!--input.c-->
            <section>
            <hnew id="input.c">input.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * input.c - source file for input control to maze game</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2004-2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    7</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Thu Sep  9 22:25:48 2004</span>
<span style="color: #666666; font-style: italic"> * Filename:	    input.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Thu Sep  9 22:25:48 2004</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sat Sep 12 14:34:19 2009</span>
<span style="color: #666666; font-style: italic"> *		Integrated original release back into main code base.</span>
<span style="color: #666666; font-style: italic"> *	SL	3	Sun Sep 13 03:51:23 2009</span>
<span style="color: #666666; font-style: italic"> *		Replaced parallel port with Tux controller code for demo.</span>
<span style="color: #666666; font-style: italic"> *	SL	4	Sun Sep 13 12:49:02 2009</span>
<span style="color: #666666; font-style: italic"> *		Changed init_input order slightly to avoid leaving keyboard</span>
<span style="color: #666666; font-style: italic"> *              in odd state on failure.</span>
<span style="color: #666666; font-style: italic"> *	SL	5	Sun Sep 13 16:30:32 2009</span>
<span style="color: #666666; font-style: italic"> *		Added a reasonably robust direct Tux control for demo mode.</span>
<span style="color: #666666; font-style: italic"> *	SL	6	Wed Sep 14 02:06:41 2011</span>
<span style="color: #666666; font-style: italic"> *		Updated input control and test driver for adventure game.</span>
<span style="color: #666666; font-style: italic"> *	SL	7	Wed Sep 14 17:07:38 2011</span>
<span style="color: #666666; font-style: italic"> *		Added keyboard input support when using Tux kernel mode.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#include &lt;ctype.h&gt;</span>
<span style="color: #557799">#include &lt;fcntl.h&gt;</span>
<span style="color: #557799">#include &lt;stdio.h&gt;</span>
<span style="color: #557799">#include &lt;stdlib.h&gt;</span>
<span style="color: #557799">#include &lt;string.h&gt;</span>
<span style="color: #557799">#include &lt;sys/io.h&gt;</span>
<span style="color: #557799">#include &lt;termio.h&gt;</span>
<span style="color: #557799">#include &lt;termios.h&gt;</span>
<span style="color: #557799">#include &lt;unistd.h&gt;</span>

<span style="color: #557799">#include &quot;assert.h&quot;</span>
<span style="color: #557799">#include &quot;input.h&quot;</span>
<span style="color: #557799">#include &quot;module/mtcp.h&quot;</span>
<span style="color: #557799">#include &quot;module/tuxctl-ioctl.h&quot;</span>


<span style="color: #666666; font-style: italic">/* set to 1 and compile this file by itself to test functionality */</span>
<span style="color: #557799">#define TEST_INPUT_DRIVER 0</span>

<span style="color: #666666; font-style: italic">/* set to 1 to use tux controller; otherwise, uses keyboard input */</span>
<span style="color: #557799">#define USE_TUX_CONTROLLER 0</span>

<span style="color: #557799">#define TUX_SET_LED _IOR(&#39;E&#39;, 0x10, unsigned long)</span>

<span style="color: #666666; font-style: italic">/* stores original terminal settings */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">struct</span> termios tio_orig;
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> fd;


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * init_input</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Initializes the input controller.  As both keyboard and</span>
<span style="color: #666666; font-style: italic"> *                Tux controller control modes use the keyboard for the quit</span>
<span style="color: #666666; font-style: italic"> *                command, this function puts stdin into character mode</span>
<span style="color: #666666; font-style: italic"> *                rather than the usual terminal mode.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 0 on success, -1 on failure </span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: changes terminal settings on stdin; prints an error</span>
<span style="color: #666666; font-style: italic"> *                 message on failure</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">init_input</span> ()
{
    <span style="color: #228899; font-weight: bold">struct</span> termios tio_new;

    <span style="color: #666666; font-style: italic">/* Grant ourselves permission to use ports 0-1023 */</span>
    <span style="color: #228899; font-weight: bold">if</span> (ioperm (<span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">1024</span>, <span style="color: #6666ff; font-weight: bold">1</span>) <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>) {
	perror (<span style="background-color: #e0e0ff">&quot;ioperm&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">3</span>;
    }

   	fd <span style="color: #333333">=</span> open(<span style="background-color: #e0e0ff">&quot;/dev/ttyS0&quot;</span>, O_RDWR <span style="color: #333333">|</span> O_NOCTTY);
	<span style="color: #6666ff; font-weight: bold">int</span> ldisc_num <span style="color: #333333">=</span> N_MOUSE;
	ioctl(fd, TIOCSETD, <span style="color: #333333">&amp;</span>ldisc_num);

	ioctl(fd, TUX_INIT);

    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * Set non-blocking mode so that stdin can be read without blocking</span>
<span style="color: #666666; font-style: italic">     * when no new keystrokes are available.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (fcntl (fileno (stdin), F_SETFL, O_NONBLOCK) <span style="color: #333333">!=</span> <span style="color: #6666ff; font-weight: bold">0</span>) {
        perror (<span style="background-color: #e0e0ff">&quot;fcntl to make stdin non-blocking&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
    }

    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * Save current terminal attributes for stdin.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (tcgetattr (fileno (stdin), <span style="color: #333333">&amp;</span>tio_orig) <span style="color: #333333">!=</span> <span style="color: #6666ff; font-weight: bold">0</span>) {
	perror (<span style="background-color: #e0e0ff">&quot;tcgetattr to read stdin terminal settings&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
    }

 <span style="color: #666666; font-style: italic">//    FILE * fd = open(&quot;/dev/ttyS0&quot;, O_RDWR | O_NOCTTY);</span>
	<span style="color: #666666; font-style: italic">// int ldisc_num = N_MOUSE;</span>
	<span style="color: #666666; font-style: italic">// ioctl(fd, TIOCSETD, &amp;ldisc_num);</span>


    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * Turn off canonical (line-buffered) mode and echoing of keystrokes</span>
<span style="color: #666666; font-style: italic">     * to the monitor.  Set minimal character and timing parameters so as</span>
<span style="color: #666666; font-style: italic">     * to prevent delays in delivery of keystrokes to the program.</span>
<span style="color: #666666; font-style: italic">     */</span>
    tio_new <span style="color: #333333">=</span> tio_orig;
    tio_new.c_lflag <span style="color: #333333">&amp;=</span> <span style="color: #333333">~</span>(ICANON <span style="color: #333333">|</span> ECHO);
    tio_new.c_cc[VMIN] <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;
    tio_new.c_cc[VTIME] <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    <span style="color: #228899; font-weight: bold">if</span> (tcsetattr (fileno (stdin), TCSANOW, <span style="color: #333333">&amp;</span>tio_new) <span style="color: #333333">!=</span> <span style="color: #6666ff; font-weight: bold">0</span>) {
	perror (<span style="background-color: #e0e0ff">&quot;tcsetattr to set stdin terminal settings&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
    }

    <span style="color: #666666; font-style: italic">/* Return success. */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">char</span> typing[MAX_TYPED_LEN <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">1</span>] <span style="color: #333333">=</span> {<span style="color: #8888FF">&#39;\0&#39;</span>};

<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">get_typed_command</span> ()
{
    <span style="color: #228899; font-weight: bold">return</span> typing;
}

<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">reset_typed_command</span> ()
{
    typing[<span style="color: #6666ff; font-weight: bold">0</span>] <span style="color: #333333">=</span> <span style="color: #8888FF">&#39;\0&#39;</span>;
}

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int32_t</span>
<span style="color: #55eedd; font-weight: bold">valid_typing</span> (<span style="color: #6666ff; font-weight: bold">char</span> c)
{
    <span style="color: #666666; font-style: italic">/* Valid typing include letters, numbers, space, and backspace/delete. */</span>
    <span style="color: #228899; font-weight: bold">return</span> (isalpha (c) <span style="color: #333333">||</span> isdigit (c) <span style="color: #333333">||</span> <span style="color: #8888FF">&#39; &#39;</span> <span style="color: #333333">==</span> c <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">8</span> <span style="color: #333333">==</span> c <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">127</span> <span style="color: #333333">==</span> c);
}

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">typed_a_char</span> (<span style="color: #6666ff; font-weight: bold">char</span> c)
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> len <span style="color: #333333">=</span> strlen (typing);

    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">8</span> <span style="color: #333333">==</span> c <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">127</span> <span style="color: #333333">==</span> c) {
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&lt;</span> len) {
	    typing[len <span style="color: #333333">-</span> <span style="color: #6666ff; font-weight: bold">1</span>] <span style="color: #333333">=</span> <span style="color: #8888FF">&#39;\0&#39;</span>;
	}
    } <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (MAX_TYPED_LEN <span style="color: #333333">&gt;</span> len) {
	typing[len] <span style="color: #333333">=</span> c;
	typing[len <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">1</span>] <span style="color: #333333">=</span> <span style="color: #8888FF">&#39;\0&#39;</span>;
    }
}

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * get_command</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Reads a command from the input controller.  As some</span>
<span style="color: #666666; font-style: italic"> *                controllers provide only absolute input (e.g., go</span>
<span style="color: #666666; font-style: italic"> *                right), the current direction is needed as an input</span>
<span style="color: #666666; font-style: italic"> *                to this routine.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: cur_dir -- current direction of motion</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: command issued by the input controller</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: drains any keyboard input</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">cmd_t</span> 
<span style="color: #55eedd; font-weight: bold">get_command</span> ()
{
<span style="color: #557799">#if (USE_TUX_CONTROLLER == 0) </span><span style="color: #666666; font-style: italic">/* use keyboard control with arrow keys */</span><span style="color: #557799"></span>
    <span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;             <span style="color: #666666; font-style: italic">/* small FSM for arrow keys */</span>
<span style="color: #557799">#endif</span>
    <span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">cmd_t</span> command <span style="color: #333333">=</span> CMD_NONE;
    <span style="color: #6666ff; font-weight: bold">cmd_t</span> pushed <span style="color: #333333">=</span> CMD_NONE;
    <span style="color: #6666ff; font-weight: bold">int</span> ch;

    <span style="color: #666666; font-style: italic">/* Read all characters from stdin. */</span>
    <span style="color: #228899; font-weight: bold">while</span> ((ch <span style="color: #333333">=</span> getc (stdin)) <span style="color: #333333">!=</span> EOF) {

	<span style="color: #666666; font-style: italic">/* Backquote is used to quit the game. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (ch <span style="color: #333333">==</span> <span style="color: #8888FF">&#39;`&#39;</span>)
	    <span style="color: #228899; font-weight: bold">return</span> CMD_QUIT;
	
<span style="color: #557799">#if (USE_TUX_CONTROLLER == 0) </span><span style="color: #666666; font-style: italic">/* use keyboard control with arrow keys */</span><span style="color: #557799"></span>
	<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">	 * Arrow keys deliver the byte sequence 27, 91, and &#39;A&#39; to &#39;D&#39;;</span>
<span style="color: #666666; font-style: italic">	 * we use a small finite state machine to identify them.</span>
<span style="color: #666666; font-style: italic">	 *</span>
<span style="color: #666666; font-style: italic">	 * Insert, home, and page up keys deliver 27, 91, &#39;2&#39;/&#39;1&#39;/&#39;5&#39; and</span>
<span style="color: #666666; font-style: italic">	 * then a tilde.  We recognize the digits and don&#39;t check for the</span>
<span style="color: #666666; font-style: italic">	 * tilde.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #228899; font-weight: bold">switch</span> (state) {
	    <span style="color: #228899; font-weight: bold">case</span> <span style="color: #6666ff; font-weight: bold">0</span>:
	        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">27</span> <span style="color: #333333">==</span> ch) {
		    state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;
		} <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (valid_typing (ch)) {
		    typed_a_char (ch);
		} <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">10</span> <span style="color: #333333">==</span> ch <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">13</span> <span style="color: #333333">==</span> ch) {
		    pushed <span style="color: #333333">=</span> CMD_TYPED;
		}
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> <span style="color: #6666ff; font-weight: bold">1</span>:
		<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">91</span> <span style="color: #333333">==</span> ch) {
		    state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">2</span>;
		} <span style="color: #228899; font-weight: bold">else</span> {
		    state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		    <span style="color: #228899; font-weight: bold">if</span> (valid_typing (ch)) {
			<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">			 * Note that we may be discarding an ESC (27), but</span>
<span style="color: #666666; font-style: italic">			 * we don&#39;t use that as typed input anyway.</span>
<span style="color: #666666; font-style: italic">			 */</span>
			typed_a_char (ch);
		    } <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">10</span> <span style="color: #333333">==</span> ch <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">13</span> <span style="color: #333333">==</span> ch) {
			pushed <span style="color: #333333">=</span> CMD_TYPED;
		    }
		}
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> <span style="color: #6666ff; font-weight: bold">2</span>:
	        <span style="color: #228899; font-weight: bold">if</span> (ch <span style="color: #333333">&gt;=</span> <span style="color: #8888FF">&#39;A&#39;</span> <span style="color: #333333">&amp;&amp;</span> ch <span style="color: #333333">&lt;=</span> <span style="color: #8888FF">&#39;D&#39;</span>) {
		    <span style="color: #228899; font-weight: bold">switch</span> (ch) {
			<span style="color: #228899; font-weight: bold">case</span> <span style="color: #8888FF">&#39;A&#39;</span>: pushed <span style="color: #333333">=</span> CMD_UP; <span style="color: #228899; font-weight: bold">break</span>;
			<span style="color: #228899; font-weight: bold">case</span> <span style="color: #8888FF">&#39;B&#39;</span>: pushed <span style="color: #333333">=</span> CMD_DOWN; <span style="color: #228899; font-weight: bold">break</span>;
			<span style="color: #228899; font-weight: bold">case</span> <span style="color: #8888FF">&#39;C&#39;</span>: pushed <span style="color: #333333">=</span> CMD_RIGHT; <span style="color: #228899; font-weight: bold">break</span>;
			<span style="color: #228899; font-weight: bold">case</span> <span style="color: #8888FF">&#39;D&#39;</span>: pushed <span style="color: #333333">=</span> CMD_LEFT; <span style="color: #228899; font-weight: bold">break</span>;
		    }
		    state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		} <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (ch <span style="color: #333333">==</span> <span style="color: #8888FF">&#39;1&#39;</span> <span style="color: #333333">||</span> ch <span style="color: #333333">==</span> <span style="color: #8888FF">&#39;2&#39;</span> <span style="color: #333333">||</span> ch <span style="color: #333333">==</span> <span style="color: #8888FF">&#39;5&#39;</span>) {
		    <span style="color: #228899; font-weight: bold">switch</span> (ch) {
			<span style="color: #228899; font-weight: bold">case</span> <span style="color: #8888FF">&#39;2&#39;</span>: pushed <span style="color: #333333">=</span> CMD_MOVE_LEFT; <span style="color: #228899; font-weight: bold">break</span>;
			<span style="color: #228899; font-weight: bold">case</span> <span style="color: #8888FF">&#39;1&#39;</span>: pushed <span style="color: #333333">=</span> CMD_ENTER; <span style="color: #228899; font-weight: bold">break</span>;
			<span style="color: #228899; font-weight: bold">case</span> <span style="color: #8888FF">&#39;5&#39;</span>: pushed <span style="color: #333333">=</span> CMD_MOVE_RIGHT; <span style="color: #228899; font-weight: bold">break</span>;
		    }
		    state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">3</span>; <span style="color: #666666; font-style: italic">/* Consume a &#39;~&#39;. */</span>
		} <span style="color: #228899; font-weight: bold">else</span> {
		    state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		    <span style="color: #228899; font-weight: bold">if</span> (valid_typing (ch)) {
			<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">			 * Note that we may be discarding an ESC (27) and </span>
<span style="color: #666666; font-style: italic">			 * a bracket (91), but we don&#39;t use either as </span>
<span style="color: #666666; font-style: italic">			 * typed input anyway.</span>
<span style="color: #666666; font-style: italic">			 */</span>
			typed_a_char (ch);
		    } <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">10</span> <span style="color: #333333">==</span> ch <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">13</span> <span style="color: #333333">==</span> ch) {
			pushed <span style="color: #333333">=</span> CMD_TYPED;
		    }
		}
		<span style="color: #228899; font-weight: bold">break</span>;
	    <span style="color: #228899; font-weight: bold">case</span> <span style="color: #6666ff; font-weight: bold">3</span>:
		state <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #8888FF">&#39;~&#39;</span> <span style="color: #333333">==</span> ch) {
		    <span style="color: #666666; font-style: italic">/* Consume it silently. */</span>
		} <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (valid_typing (ch)) {
		    typed_a_char (ch);
		} <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">10</span> <span style="color: #333333">==</span> ch <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">13</span> <span style="color: #333333">==</span> ch) {
		    pushed <span style="color: #333333">=</span> CMD_TYPED;
		}
		<span style="color: #228899; font-weight: bold">break</span>;
	}
<span style="color: #557799">#else </span><span style="color: #666666; font-style: italic">/* USE_TUX_CONTROLLER */</span><span style="color: #557799"></span>
	<span style="color: #666666; font-style: italic">/* Tux controller mode; still need to support typed commands. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (valid_typing (ch)) {
	    typed_a_char (ch);
	} <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">10</span> <span style="color: #333333">==</span> ch <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">13</span> <span style="color: #333333">==</span> ch) {
	    pushed <span style="color: #333333">=</span> CMD_TYPED;
	}
<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* USE_TUX_CONTROLLER */</span><span style="color: #557799"></span>
    }

    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * Once a direction is pushed, that command remains active</span>
<span style="color: #666666; font-style: italic">     * until a turn is taken.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (pushed <span style="color: #333333">==</span> CMD_NONE) {
        command <span style="color: #333333">=</span> CMD_NONE;
    }
    <span style="color: #228899; font-weight: bold">return</span> pushed;
}
<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> *function: get_cmd_button</span>
<span style="color: #666666; font-style: italic"> *description: assigns each 8-bit value to a command enumerated in input.h</span>
<span style="color: #666666; font-style: italic"> *				considering that the buttons are active low so the corresponding</span>
<span style="color: #666666; font-style: italic"> *				bit is set to zero when the button is pressed while the others</span>
<span style="color: #666666; font-style: italic"> *				are set to 1. </span>
<span style="color: #666666; font-style: italic"> *			 	__7___6___5___4___3___2___1_____0___</span>
<span style="color: #666666; font-style: italic"> * 				| R | L | D | U | c | b | a | Start | </span>
<span style="color: #666666; font-style: italic"> * 				+---+---+---+----+---+---+---+------+</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *input: none</span>
<span style="color: #666666; font-style: italic"> *output: none</span>
<span style="color: #666666; font-style: italic"> *return value: command corresponding to pushed button</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">cmd_t</span>
<span style="color: #55eedd; font-weight: bold">get_cmd_button</span>()
{
	<span style="color: #6666ff; font-weight: bold">cmd_t</span> pushed <span style="color: #333333">=</span> CMD_NONE;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> arg <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	ioctl(fd, TUX_BUTTONS, <span style="color: #333333">&amp;</span>arg);
 
	<span style="color: #228899; font-weight: bold">switch</span>(arg)
	{
		<span style="color: #666666; font-style: italic">//getting what button is pressed.</span>
		<span style="color: #666666; font-style: italic">//since active low in tuxctl_ioctl.c and 8 bit array above hex values assigned to command</span>
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x80</span>): pushed <span style="color: #333333">=</span> CMD_RIGHT; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x40</span>): pushed <span style="color: #333333">=</span> CMD_LEFT; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x20</span>): pushed <span style="color: #333333">=</span> CMD_DOWN; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x10</span>): pushed <span style="color: #333333">=</span> CMD_UP; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x08</span>): pushed <span style="color: #333333">=</span> CMD_MOVE_RIGHT; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x04</span>): pushed <span style="color: #333333">=</span> CMD_ENTER; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x02</span>): pushed <span style="color: #333333">=</span> CMD_MOVE_LEFT; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #228899; font-weight: bold">case</span>(<span style="color: #005588; font-weight: bold">0x01</span>): pushed <span style="color: #333333">=</span> CMD_QUIT; <span style="color: #228899; font-weight: bold">break</span>;
		<span style="color: #997700; font-weight: bold">default:</span>
			<span style="color: #228899; font-weight: bold">break</span>;
	}<span style="color: #666666; font-style: italic">//end switch</span>

	<span style="color: #228899; font-weight: bold">return</span> pushed;
}<span style="color: #666666; font-style: italic">//end get_cmd_button</span>

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * shutdown_input</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Cleans up state associated with input control.  Restores</span>
<span style="color: #666666; font-style: italic"> *                original terminal settings.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none </span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: restores original terminal settings</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">shutdown_input</span> ()
{
    (<span style="color: #6666ff; font-weight: bold">void</span>)tcsetattr (fileno (stdin), TCSANOW, <span style="color: #333333">&amp;</span>tio_orig);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * display_time_on_tux</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Show number of elapsed seconds as minutes:seconds</span>
<span style="color: #666666; font-style: italic"> *                on the Tux controller&#39;s 7-segment displays.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: num_seconds -- total seconds elapsed so far</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none </span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: changes state of controller&#39;s display</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">display_time_on_tux</span> (<span style="color: #6666ff; font-weight: bold">int</span> num_seconds)
{
<span style="color: #666666; font-style: italic">/*#if (USE_TUX_CONTROLLER != 0)</span>
<span style="color: #666666; font-style: italic">#error &quot;Tux controller code is not operational yet.&quot;</span>
<span style="color: #666666; font-style: italic">#endif*/</span> 
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> time_to_be_displayed;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> minutes, seconds;

	<span style="color: #666666; font-style: italic">//getting the number of minutes and seconds elapsed based on argument passed in</span>
	minutes <span style="color: #333333">=</span> num_seconds <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">60</span>;
	seconds <span style="color: #333333">=</span> num_seconds <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">60</span>;

	<span style="color: #666666; font-style: italic">//enable LED&#39;s 0, 1, and 2 only</span>
	<span style="color: #228899; font-weight: bold">if</span> (minutes <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">10</span>)
	{
		time_to_be_displayed <span style="color: #333333">=</span> <span style="color: #005588; font-weight: bold">0x04070000</span>;		<span style="color: #666666; font-style: italic">//in 32 bit arg highest 4 bits ignored, 3rd 4 highest same, second highest 4 is for dp 4th highest four for LED&#39;s</span>
	} <span style="color: #666666; font-style: italic">//end if</span>

	<span style="color: #666666; font-style: italic">//enabling all LED&#39;s</span>
	<span style="color: #228899; font-weight: bold">else</span>
	{
		time_to_be_displayed <span style="color: #333333">=</span> <span style="color: #005588; font-weight: bold">0x040F0000</span>;		<span style="color: #666666; font-style: italic">//enabling all four LED&#39;s to display</span>
	}<span style="color: #666666; font-style: italic">//end else</span>

	<span style="color: #666666; font-style: italic">//getting the values to be displayed and calling TUX_SET_LED</span>
	time_to_be_displayed <span style="color: #333333">=</span> time_to_be_displayed <span style="color: #333333">|</span> (((minutes <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">10</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">12</span>) <span style="color: #333333">|</span> ((minutes <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">10</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">8</span>) <span style="color: #333333">|</span> ((seconds <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">10</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">4</span>) <span style="color: #333333">|</span> (seconds <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">10</span>));

	ioctl(fd, TUX_SET_LED, time_to_be_displayed);
	
	<span style="color: #666666; font-style: italic">/*unsigned long arg = 0xFFFF0123;</span>
<span style="color: #666666; font-style: italic">	ioctl(fd, TUX_SET_LED, arg);*/</span>
}<span style="color: #666666; font-style: italic">//end display_time_on_tux</span>


<span style="color: #557799">#if (TEST_INPUT_DRIVER == 1)</span>
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">main</span> ()
{
    <span style="color: #6666ff; font-weight: bold">cmd_t</span> last_cmd <span style="color: #333333">=</span> CMD_NONE;
    <span style="color: #6666ff; font-weight: bold">cmd_t</span> cmd;
    <span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">const</span> cmd_name[NUM_COMMANDS] <span style="color: #333333">=</span> {
        <span style="background-color: #e0e0ff">&quot;none&quot;</span>, <span style="background-color: #e0e0ff">&quot;right&quot;</span>, <span style="background-color: #e0e0ff">&quot;left&quot;</span>, <span style="background-color: #e0e0ff">&quot;up&quot;</span>, <span style="background-color: #e0e0ff">&quot;down&quot;</span>, 
	<span style="background-color: #e0e0ff">&quot;move left&quot;</span>, <span style="background-color: #e0e0ff">&quot;enter&quot;</span>, <span style="background-color: #e0e0ff">&quot;move right&quot;</span>, <span style="background-color: #e0e0ff">&quot;typed command&quot;</span>, <span style="background-color: #e0e0ff">&quot;quit&quot;</span>
    };

    <span style="color: #666666; font-style: italic">/* Grant ourselves permission to use ports 0-1023 */</span>
    <span style="color: #228899; font-weight: bold">if</span> (ioperm (<span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #6666ff; font-weight: bold">1024</span>, <span style="color: #6666ff; font-weight: bold">1</span>) <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>) {
	perror (<span style="background-color: #e0e0ff">&quot;ioperm&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">3</span>;
    }

    init_input ();

<span style="color: #666666; font-style: italic">/*	FILE * fd = open(&quot;/dev/ttyS0&quot;, O_RDWR | O_NOCTTY);</span>
<span style="color: #666666; font-style: italic">	int ldisc_num = N_MOUSE;</span>
<span style="color: #666666; font-style: italic">	ioctl(fd, TIOCSETD, &amp;ldisc_num);	</span>

<span style="color: #666666; font-style: italic">	ioctl(fd, TUX_INIT);*/</span>

	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">int</span> buts <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	<span style="color: #228899; font-weight: bold">while</span>(<span style="color: #6666ff; font-weight: bold">1</span>)
	{
		ioctl(fd, TUX_SET_LED, <span style="color: #005588; font-weight: bold">0x0F0F0477</span>);
		ioctl(fd, TUX_BUTTONS, <span style="color: #333333">&amp;</span>buts);
		
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x80</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_RIGHT]); fflush (stdout);
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x40</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_LEFT]); fflush (stdout);
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x20</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_DOWN]); fflush (stdout);
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x10</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_UP]); fflush (stdout);
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x08</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_MOVE_RIGHT]); fflush (stdout);
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x04</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_ENTER]); fflush (stdout);
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x02</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_MOVE_LEFT]); fflush (stdout);
		<span style="color: #228899; font-weight: bold">if</span>(buts <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x01</span>)
			printf(<span style="background-color: #e0e0ff">&quot;buttons pressed %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[CMD_QUIT]); fflush (stdout);
		usleep(<span style="color: #6666ff; font-weight: bold">100000</span>);
	}
    <span style="color: #228899; font-weight: bold">while</span> (<span style="color: #6666ff; font-weight: bold">1</span>) 
    {
        <span style="color: #228899; font-weight: bold">while</span> ((cmd <span style="color: #333333">=</span> get_command ()) <span style="color: #333333">==</span> last_cmd);
		last_cmd <span style="color: #333333">=</span> cmd;
		printf (<span style="background-color: #e0e0ff">&quot;command issued: %s</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, cmd_name[cmd]);

		ioctl(fd, TUX_SET_LED, <span style="color: #6666ff; font-weight: bold">0</span>);

		<span style="color: #228899; font-weight: bold">if</span> (cmd <span style="color: #333333">==</span> CMD_QUIT)
	    	<span style="color: #228899; font-weight: bold">break</span>;
		display_time_on_tux (<span style="color: #6666ff; font-weight: bold">83</span>);
    }<span style="color: #666666; font-style: italic">//end while</span>
    shutdown_input ();
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}
<span style="color: #557799">#endif</span>
</pre></div>
<p></p>    
            </section>
        
        
        
        
        
        
        
        
             <!--input.h-->
            <section>
            <hnew id="input.h">input.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * input.h - header file for input control to maze game</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2004-2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    3</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Thu Sep  9 22:22:00 2004</span>
<span style="color: #666666; font-style: italic"> * Filename:	    input.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Thu Sep  9 22:22:00 2004</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sun Sep 13 04:11:44 2009</span>
<span style="color: #666666; font-style: italic"> *		Changed display interface for Tux controller.</span>
<span style="color: #666666; font-style: italic"> *	SL	3	Wed Sep 14 02:06:59 2011</span>
<span style="color: #666666; font-style: italic"> *		Updated command names and numbers for adventure game.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#ifndef INPUT_H</span>
<span style="color: #557799">#define INPUT_H</span>

<span style="color: #666666; font-style: italic">/* possible commands from input device, whether keyboard or game controller */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">enum</span> {
    CMD_NONE, CMD_RIGHT, CMD_LEFT, CMD_UP, CMD_DOWN,
    CMD_MOVE_LEFT, CMD_ENTER, CMD_MOVE_RIGHT,
    CMD_TYPED,
    CMD_QUIT,
    NUM_COMMANDS
} <span style="color: #6666ff; font-weight: bold">cmd_t</span>;

<span style="color: #557799">#define MAX_TYPED_LEN 20</span>

<span style="color: #666666; font-style: italic">/* Initialize the input device. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">init_input</span> ();

<span style="color: #666666; font-style: italic">/* Read a command from the input device. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">cmd_t</span> <span style="color: #55eedd; font-weight: bold">get_command</span> ();

<span style="color: #666666; font-style: italic">/* Get currently typed command string. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">get_typed_command</span> ();

<span style="color: #666666; font-style: italic">/* Reset typed command. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">reset_typed_command</span> ();

<span style="color: #666666; font-style: italic">/* Shut down the input device. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">shutdown_input</span> ();

<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">cmd_t</span> <span style="color: #55eedd; font-weight: bold">get_cmd_button</span>();

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * Show the elapsed seconds on the Tux controller (no effect when</span>
<span style="color: #666666; font-style: italic"> * compiled for a keyboard).</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">display_time_on_tux</span> (<span style="color: #6666ff; font-weight: bold">int</span> num_seconds);

<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* INPUT_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
            
            <!--modex.c-->
            <section>
            <hnew id="modex.c">modex.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*                  tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * modex.c - VGA mode X graphics routines</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2004-2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:      Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:     5</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Fri Sep 10 09:59:17 2004</span>
<span style="color: #666666; font-style: italic"> * Filename:      modex.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *  SL  1 Fri Sep 10 09:59:17 2004</span>
<span style="color: #666666; font-style: italic"> *    First written.</span>
<span style="color: #666666; font-style: italic"> *  SL  2 Sat Sep 12 16:41:45 2009</span>
<span style="color: #666666; font-style: italic"> *    Integrated original release back into main code base.</span>
<span style="color: #666666; font-style: italic"> *  SL  3 Sat Sep 12 17:58:20 2009</span>
<span style="color: #666666; font-style: italic"> *              Added display re-enable to VGA blank routine and comments</span>
<span style="color: #666666; font-style: italic"> *              on other VirtualPC-&gt;QEMU migration changes.</span>
<span style="color: #666666; font-style: italic"> *  SL  4 Sat Sep 10 20:43:47 2011</span>
<span style="color: #666666; font-style: italic"> *    Modified for MP2 F11 adventure game.</span>
<span style="color: #666666; font-style: italic"> *  SL  5 Sat Sep 14 16:13:20 2011</span>
<span style="color: #666666; font-style: italic"> *    Split fill_palette by mode and cleaned up code for release.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#include &lt;fcntl.h&gt;</span>
<span style="color: #557799">#include &lt;stdio.h&gt;</span>
<span style="color: #557799">#include &lt;string.h&gt;</span>
<span style="color: #557799">#include &lt;sys/io.h&gt;</span>
<span style="color: #557799">#include &lt;sys/mman.h&gt;</span>
<span style="color: #557799">#include &lt;unistd.h&gt;</span>

<span style="color: #557799">#include &quot;modex.h&quot;</span>
<span style="color: #557799">#include &quot;text.h&quot;</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * Calculate the image build buffer parameters.  SCROLL_SIZE is the space</span>
<span style="color: #666666; font-style: italic"> * needed for one plane of an image.  SCREEN_SIZE is the space needed for</span>
<span style="color: #666666; font-style: italic"> * all four planes.  The extra +1 supports logical view x coordinates that </span>
<span style="color: #666666; font-style: italic"> * are not multiples of four.  In these cases, some plane addresses are </span>
<span style="color: #666666; font-style: italic"> * shifted by 1 byte forward.  The planes are stored in the build buffer </span>
<span style="color: #666666; font-style: italic"> * in reverse order to allow those planes that shift forward to do so </span>
<span style="color: #666666; font-style: italic"> * without running into planes that aren&#39;t shifted.  For example, when </span>
<span style="color: #666666; font-style: italic"> * the leftmost x pixel in the logical view is 3 mod 4, planes 2, 1, and 0 </span>
<span style="color: #666666; font-style: italic"> * are shifted forward, while plane 3 is not, so there is one unused byte </span>
<span style="color: #666666; font-style: italic"> * between the image of plane 3 and that of plane 2.  BUILD_BUF_SIZE is</span>
<span style="color: #666666; font-style: italic"> * the size of the space allocated for building images.  We add 20000 bytes</span>
<span style="color: #666666; font-style: italic"> * to reduce the number of memory copies required during scrolling.</span>
<span style="color: #666666; font-style: italic"> * Strictly speaking (try it), no extra space is necessary, but the minimum </span>
<span style="color: #666666; font-style: italic"> * means an extra 64kB memory copy with every scroll pixel.  Finally,</span>
<span style="color: #666666; font-style: italic"> * BUILD_BASE_INIT places initial (or transferred) logical view in the</span>
<span style="color: #666666; font-style: italic"> * middle of the available buffer area.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#define SCROLL_SIZE     (SCROLL_X_WIDTH * SCROLL_Y_DIM) </span>
<span style="color: #557799">#define SCREEN_SIZE (SCROLL_SIZE * 4 + 1)</span>
<span style="color: #557799">#define BUILD_BUF_SIZE  (SCREEN_SIZE + 20000) </span>
<span style="color: #557799">#define BUILD_BASE_INIT ((BUILD_BUF_SIZE - SCREEN_SIZE) / 2)</span>

<span style="color: #666666; font-style: italic">/* Mode X and general VGA parameters */</span>
<span style="color: #557799">#define VID_MEM_SIZE       131072</span>
<span style="color: #557799">#define MODE_X_MEM_SIZE     65536</span>
<span style="color: #557799">#define NUM_SEQUENCER_REGS      5</span>
<span style="color: #557799">#define NUM_CRTC_REGS          25</span>
<span style="color: #557799">#define NUM_GRAPHICS_REGS       9</span>
<span style="color: #557799">#define NUM_ATTR_REGS          22</span>




<span style="color: #666666; font-style: italic">/* VGA register settings for mode X */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> mode_X_seq[NUM_SEQUENCER_REGS] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x0100</span>, <span style="color: #005588; font-weight: bold">0x2101</span>, <span style="color: #005588; font-weight: bold">0x0F02</span>, <span style="color: #005588; font-weight: bold">0x0003</span>, <span style="color: #005588; font-weight: bold">0x0604</span>
};
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> mode_X_CRTC[NUM_CRTC_REGS] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x5F00</span>, <span style="color: #005588; font-weight: bold">0x4F01</span>, <span style="color: #005588; font-weight: bold">0x5002</span>, <span style="color: #005588; font-weight: bold">0x8203</span>, <span style="color: #005588; font-weight: bold">0x5404</span>, <span style="color: #005588; font-weight: bold">0x8005</span>, <span style="color: #005588; font-weight: bold">0xBF06</span>, <span style="color: #005588; font-weight: bold">0x1F07</span>,
    <span style="color: #005588; font-weight: bold">0x0008</span>, <span style="color: #005588; font-weight: bold">0x0109</span>, <span style="color: #005588; font-weight: bold">0x000A</span>, <span style="color: #005588; font-weight: bold">0x000B</span>, <span style="color: #005588; font-weight: bold">0x000C</span>, <span style="color: #005588; font-weight: bold">0x000D</span>, <span style="color: #005588; font-weight: bold">0x000E</span>, <span style="color: #005588; font-weight: bold">0x000F</span>,
    <span style="color: #005588; font-weight: bold">0x9C10</span>, <span style="color: #005588; font-weight: bold">0x8E11</span>, <span style="color: #005588; font-weight: bold">0x8F12</span>, <span style="color: #005588; font-weight: bold">0x2813</span>, <span style="color: #005588; font-weight: bold">0x0014</span>, <span style="color: #005588; font-weight: bold">0x9615</span>, <span style="color: #005588; font-weight: bold">0xB916</span>, <span style="color: #005588; font-weight: bold">0xE317</span>,
    <span style="color: #005588; font-weight: bold">0x6B18</span>

    <span style="color: #666666; font-style: italic">//changed values in register to split screen manually</span>
};
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> mode_X_attr[NUM_ATTR_REGS <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">2</span>] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x01</span>, <span style="color: #005588; font-weight: bold">0x01</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x03</span>, <span style="color: #005588; font-weight: bold">0x03</span>, 
    <span style="color: #005588; font-weight: bold">0x04</span>, <span style="color: #005588; font-weight: bold">0x04</span>, <span style="color: #005588; font-weight: bold">0x05</span>, <span style="color: #005588; font-weight: bold">0x05</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x07</span>, <span style="color: #005588; font-weight: bold">0x07</span>, 
    <span style="color: #005588; font-weight: bold">0x08</span>, <span style="color: #005588; font-weight: bold">0x08</span>, <span style="color: #005588; font-weight: bold">0x09</span>, <span style="color: #005588; font-weight: bold">0x09</span>, <span style="color: #005588; font-weight: bold">0x0A</span>, <span style="color: #005588; font-weight: bold">0x0A</span>, <span style="color: #005588; font-weight: bold">0x0B</span>, <span style="color: #005588; font-weight: bold">0x0B</span>, 
    <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0D</span>, <span style="color: #005588; font-weight: bold">0x0D</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>,
    <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x41</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x12</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x13</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
    <span style="color: #005588; font-weight: bold">0x14</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>
};
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> mode_X_graphics[NUM_GRAPHICS_REGS] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x0000</span>, <span style="color: #005588; font-weight: bold">0x0001</span>, <span style="color: #005588; font-weight: bold">0x0002</span>, <span style="color: #005588; font-weight: bold">0x0003</span>, <span style="color: #005588; font-weight: bold">0x0004</span>, <span style="color: #005588; font-weight: bold">0x4005</span>, <span style="color: #005588; font-weight: bold">0x0506</span>, <span style="color: #005588; font-weight: bold">0x0F07</span>,
    <span style="color: #005588; font-weight: bold">0xFF08</span>
};

<span style="color: #666666; font-style: italic">/* VGA register settings for text mode 3 (color text) */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> text_seq[NUM_SEQUENCER_REGS] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x0100</span>, <span style="color: #005588; font-weight: bold">0x2001</span>, <span style="color: #005588; font-weight: bold">0x0302</span>, <span style="color: #005588; font-weight: bold">0x0003</span>, <span style="color: #005588; font-weight: bold">0x0204</span>
};
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> text_CRTC[NUM_CRTC_REGS] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x5F00</span>, <span style="color: #005588; font-weight: bold">0x4F01</span>, <span style="color: #005588; font-weight: bold">0x5002</span>, <span style="color: #005588; font-weight: bold">0x8203</span>, <span style="color: #005588; font-weight: bold">0x5504</span>, <span style="color: #005588; font-weight: bold">0x8105</span>, <span style="color: #005588; font-weight: bold">0xBF06</span>, <span style="color: #005588; font-weight: bold">0x1F07</span>,
    <span style="color: #005588; font-weight: bold">0x0008</span>, <span style="color: #005588; font-weight: bold">0x4F09</span>, <span style="color: #005588; font-weight: bold">0x0D0A</span>, <span style="color: #005588; font-weight: bold">0x0E0B</span>, <span style="color: #005588; font-weight: bold">0x000C</span>, <span style="color: #005588; font-weight: bold">0x000D</span>, <span style="color: #005588; font-weight: bold">0x000E</span>, <span style="color: #005588; font-weight: bold">0x000F</span>,
    <span style="color: #005588; font-weight: bold">0x9C10</span>, <span style="color: #005588; font-weight: bold">0x8E11</span>, <span style="color: #005588; font-weight: bold">0x8F12</span>, <span style="color: #005588; font-weight: bold">0x2813</span>, <span style="color: #005588; font-weight: bold">0x1F14</span>, <span style="color: #005588; font-weight: bold">0x9615</span>, <span style="color: #005588; font-weight: bold">0xB916</span>, <span style="color: #005588; font-weight: bold">0xA317</span>,
    <span style="color: #005588; font-weight: bold">0xFF18</span>
};
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> text_attr[NUM_ATTR_REGS <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">2</span>] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x01</span>, <span style="color: #005588; font-weight: bold">0x01</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x03</span>, <span style="color: #005588; font-weight: bold">0x03</span>, 
    <span style="color: #005588; font-weight: bold">0x04</span>, <span style="color: #005588; font-weight: bold">0x04</span>, <span style="color: #005588; font-weight: bold">0x05</span>, <span style="color: #005588; font-weight: bold">0x05</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x07</span>, <span style="color: #005588; font-weight: bold">0x07</span>, 
    <span style="color: #005588; font-weight: bold">0x08</span>, <span style="color: #005588; font-weight: bold">0x08</span>, <span style="color: #005588; font-weight: bold">0x09</span>, <span style="color: #005588; font-weight: bold">0x09</span>, <span style="color: #005588; font-weight: bold">0x0A</span>, <span style="color: #005588; font-weight: bold">0x0A</span>, <span style="color: #005588; font-weight: bold">0x0B</span>, <span style="color: #005588; font-weight: bold">0x0B</span>, 
    <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0D</span>, <span style="color: #005588; font-weight: bold">0x0D</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>,
    <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x12</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x13</span>, <span style="color: #005588; font-weight: bold">0x08</span>,
    <span style="color: #005588; font-weight: bold">0x14</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>
};
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> text_graphics[NUM_GRAPHICS_REGS] <span style="color: #333333">=</span> {
    <span style="color: #005588; font-weight: bold">0x0000</span>, <span style="color: #005588; font-weight: bold">0x0001</span>, <span style="color: #005588; font-weight: bold">0x0002</span>, <span style="color: #005588; font-weight: bold">0x0003</span>, <span style="color: #005588; font-weight: bold">0x0004</span>, <span style="color: #005588; font-weight: bold">0x1005</span>, <span style="color: #005588; font-weight: bold">0x0E06</span>, <span style="color: #005588; font-weight: bold">0x0007</span>,
    <span style="color: #005588; font-weight: bold">0xFF08</span>
};


<span style="color: #666666; font-style: italic">/* local functions--see function headers for details */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">open_memory_and_ports</span> ();
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">VGA_blank</span> (<span style="color: #6666ff; font-weight: bold">int</span> blank_bit);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">set_seq_regs_and_reset</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> table[NUM_SEQUENCER_REGS],
            <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> val);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">set_CRTC_registers</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> table[NUM_CRTC_REGS]);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">set_attr_registers</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> table[NUM_ATTR_REGS <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">2</span>]);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">set_graphics_registers</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> table[NUM_GRAPHICS_REGS]);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">fill_palette_mode_x</span> ();
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">fill_palette_text</span> ();
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">write_font_data</span> ();
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">set_text_mode_3</span> (<span style="color: #6666ff; font-weight: bold">int</span> clear_scr);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">copy_image</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> img, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> scr_addr);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">copy_status_bar</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> stat_bar);


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * Images are built in this buffer, then copied to the video memory.</span>
<span style="color: #666666; font-style: italic"> * Copying to video memory with REP MOVSB is vastly faster than anything</span>
<span style="color: #666666; font-style: italic"> * else with emulation, probably because it is a single instruction</span>
<span style="color: #666666; font-style: italic"> * and translates to a native loop.  It&#39;s also a pretty good technique</span>
<span style="color: #666666; font-style: italic"> * in normal machines (albeit not as elegant as some others for reducing</span>
<span style="color: #666666; font-style: italic"> * the number of video memory writes; unfortunately, these techniques</span>
<span style="color: #666666; font-style: italic"> * are slower in emulation...). </span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The size allows the four plane images to move within an area of</span>
<span style="color: #666666; font-style: italic"> * about twice the size necessary (to reduce the need to deal with</span>
<span style="color: #666666; font-style: italic"> * the boundary conditions by moving the data within the buffer).</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Plane 3 is first, followed by 2, 1, and 0.  The reverse ordering</span>
<span style="color: #666666; font-style: italic"> * is used because the logical address of 0 increases first; if plane</span>
<span style="color: #666666; font-style: italic"> * 0 were first, we would need a buffer byte to keep it from colliding</span>
<span style="color: #666666; font-style: italic"> * with plane 1 when plane 0 was offset by 1 from plane 1, i.e., when</span>
<span style="color: #666666; font-style: italic"> * displaying a one-pixel left shift.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The memory fence (included when NDEBUG is not defined) allocates</span>
<span style="color: #666666; font-style: italic"> * the build buffer with extra space on each side.  The extra space</span>
<span style="color: #666666; font-style: italic"> * is filled with magic numbers (something unlikely to be written in</span>
<span style="color: #666666; font-style: italic"> * error), and the fence areas are checked for those magic values at</span>
<span style="color: #666666; font-style: italic"> * the end of the program to detect array access bugs (writes past</span>
<span style="color: #666666; font-style: italic"> * the ends of the build buffer).</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#if !defined(NDEBUG)</span>
<span style="color: #557799">#define MEM_FENCE_WIDTH 256</span>
<span style="color: #557799">#else</span>
<span style="color: #557799">#define MEM_FENCE_WIDTH 0</span>
<span style="color: #557799">#endif</span>
<span style="color: #557799">#define MEM_FENCE_MAGIC 0xF3</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> build[BUILD_BUF_SIZE <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">2</span> <span style="color: #333333">*</span> MEM_FENCE_WIDTH];
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> img3_off;        <span style="color: #666666; font-style: italic">/* offset of upper left pixel   */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> img3;     <span style="color: #666666; font-style: italic">/* pointer to upper left pixel  */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> show_x, show_y;          <span style="color: #666666; font-style: italic">/* logical view coordinates     */</span>

<span style="color: #666666; font-style: italic">/* displayed video memory variables */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> mem_image;    <span style="color: #666666; font-style: italic">/* pointer to start of video memory */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> target_img;   <span style="color: #666666; font-style: italic">/* offset of displayed screen image */</span>

<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> status_bar_buffer[STATUS_BAR_SIZE];

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * functions provided by the caller to set_mode_X() and used to obtain  </span>
<span style="color: #666666; font-style: italic"> * graphic images of lines (pixels) to be mapped into the build buffer</span>
<span style="color: #666666; font-style: italic"> * planes for display in mode X</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #55eedd; font-weight: bold">void</span> (<span style="color: #333333">*</span>horiz_line_fn) (<span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span>[SCROLL_X_DIM]);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #55eedd; font-weight: bold">void</span> (<span style="color: #333333">*</span>vert_line_fn) (<span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span>[SCROLL_Y_DIM]);
  

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * macro used to target a specific video plane or planes when writing</span>
<span style="color: #666666; font-style: italic"> * to video memory in mode X; bits 8-11 in the mask_hi_bits enable writes</span>
<span style="color: #666666; font-style: italic"> * to planes 0-3, respectively</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#define SET_WRITE_MASK(mask_hi_bits)                                    \</span>
<span style="color: #557799">do {                                                                    \</span>
<span style="color: #557799">    asm volatile (&quot;                                                     \</span>
<span style="color: #557799">  movw $0x03C4,%%dx     </span><span style="color: #666666; font-style: italic">/* set write mask                    */</span><span style="color: #557799">;\</span>
<span style="color: #557799">  movb $0x02,%b0                                                 ;\</span>
<span style="color: #557799">  outw %w0,(%%dx)                                                 \</span>
<span style="color: #557799">    &quot; : : &quot;a&quot; ((mask_hi_bits)) : &quot;edx&quot;, &quot;memory&quot;);                      \</span>
<span style="color: #557799">} while (0)</span>

<span style="color: #666666; font-style: italic">/* macro used to write a byte to a port */</span>
<span style="color: #557799">#define OUTB(port,val)                                                  \</span>
<span style="color: #557799">do {                                                                    \</span>
<span style="color: #557799">    asm volatile (&quot;                                                     \</span>
<span style="color: #557799">        outb %b1,(%w0)                                                  \</span>
<span style="color: #557799">    &quot; : </span><span style="color: #666666; font-style: italic">/* no outputs */</span><span style="color: #557799">                                                \</span>
<span style="color: #557799">      : &quot;d&quot; ((port)), &quot;a&quot; ((val))                                       \</span>
<span style="color: #557799">      : &quot;memory&quot;, &quot;cc&quot;);                                                \</span>
<span style="color: #557799">} while (0)</span>

<span style="color: #666666; font-style: italic">/* macro used to write two bytes to two consecutive ports */</span>
<span style="color: #557799">#define OUTW(port,val)                                                  \</span>
<span style="color: #557799">do {                                                                    \</span>
<span style="color: #557799">    asm volatile (&quot;                                                     \</span>
<span style="color: #557799">        outw %w1,(%w0)                                                  \</span>
<span style="color: #557799">    &quot; : </span><span style="color: #666666; font-style: italic">/* no outputs */</span><span style="color: #557799">                                                \</span>
<span style="color: #557799">      : &quot;d&quot; ((port)), &quot;a&quot; ((val))                                       \</span>
<span style="color: #557799">      : &quot;memory&quot;, &quot;cc&quot;);                                                \</span>
<span style="color: #557799">} while (0)</span>

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * macro used to write an array of two-byte values to two consecutive ports </span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#define REP_OUTSW(port,source,count)                                    \</span>
<span style="color: #557799">do {                                                                    \</span>
<span style="color: #557799">    asm volatile (&quot;                                                     \</span>
<span style="color: #557799">     1: movw 0(%1),%%ax                                                ;\</span>
<span style="color: #557799">  outw %%ax,(%w2)                                                ;\</span>
<span style="color: #557799">  addl $2,%1                                                     ;\</span>
<span style="color: #557799">  decl %0                                                        ;\</span>
<span style="color: #557799">  jne 1b                                                          \</span>
<span style="color: #557799">    &quot; : </span><span style="color: #666666; font-style: italic">/* no outputs */</span><span style="color: #557799">                                                \</span>
<span style="color: #557799">      : &quot;c&quot; ((count)), &quot;S&quot; ((source)), &quot;d&quot; ((port))                     \</span>
<span style="color: #557799">      : &quot;eax&quot;, &quot;memory&quot;, &quot;cc&quot;);                                         \</span>
<span style="color: #557799">} while (0)</span>

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * macro used to write an array of one-byte values to two consecutive ports </span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#define REP_OUTSB(port,source,count)                                    \</span>
<span style="color: #557799">do {                                                                    \</span>
<span style="color: #557799">    asm volatile (&quot;                                                     \</span>
<span style="color: #557799">     1: movb 0(%1),%%al                                                ;\</span>
<span style="color: #557799">  outb %%al,(%w2)                                                ;\</span>
<span style="color: #557799">  incl %1                                                        ;\</span>
<span style="color: #557799">  decl %0                                                        ;\</span>
<span style="color: #557799">  jne 1b                                                          \</span>
<span style="color: #557799">    &quot; : </span><span style="color: #666666; font-style: italic">/* no outputs */</span><span style="color: #557799">                                                \</span>
<span style="color: #557799">      : &quot;c&quot; ((count)), &quot;S&quot; ((source)), &quot;d&quot; ((port))                     \</span>
<span style="color: #557799">      : &quot;eax&quot;, &quot;memory&quot;, &quot;cc&quot;);                                         \</span>
<span style="color: #557799">} while (0)</span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * set_mode_X</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Puts the VGA into mode X.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: horiz_fill_fn -- this function is used as a callback (by</span>
<span style="color: #666666; font-style: italic"> *              draw_horiz_line) to obtain a graphical </span>
<span style="color: #666666; font-style: italic"> *              image of a particular logical line for </span>
<span style="color: #666666; font-style: italic"> *              drawing to the build buffer</span>
<span style="color: #666666; font-style: italic"> *           vert_fill_fn -- this function is used as a callback (by</span>
<span style="color: #666666; font-style: italic"> *             draw_vert_line) to obtain a graphical </span>
<span style="color: #666666; font-style: italic"> *             image of a particular logical line for </span>
<span style="color: #666666; font-style: italic"> *             drawing to the build buffer</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 0 on success, -1 on failure</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: initializes the logical view window; maps video memory</span>
<span style="color: #666666; font-style: italic"> *                 and obtains permission for VGA ports; clears video memory</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">set_mode_X</span> (<span style="color: #6666ff; font-weight: bold">void</span> (<span style="color: #333333">*</span>horiz_fill_fn) (<span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span>[SCROLL_X_DIM]),
            <span style="color: #6666ff; font-weight: bold">void</span> (<span style="color: #333333">*</span>vert_fill_fn) (<span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span>[SCROLL_Y_DIM]))
{
    <span style="color: #6666ff; font-weight: bold">int</span> i; <span style="color: #666666; font-style: italic">/* loop index for filling memory fence with magic numbers */</span>

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Record callback functions for obtaining horizontal and vertical </span>
<span style="color: #666666; font-style: italic">     * line images.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (horiz_fill_fn <span style="color: #333333">==</span> <span style="color: #007722">NULL</span> <span style="color: #333333">||</span> vert_fill_fn <span style="color: #333333">==</span> <span style="color: #007722">NULL</span>)
        <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
    horiz_line_fn <span style="color: #333333">=</span> horiz_fill_fn;
    vert_line_fn <span style="color: #333333">=</span> vert_fill_fn;

    <span style="color: #666666; font-style: italic">/* Initialize the logical view window to position (0,0). */</span>
    show_x <span style="color: #333333">=</span> show_y <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    img3_off <span style="color: #333333">=</span> BUILD_BASE_INIT;
    img3 <span style="color: #333333">=</span> build <span style="color: #333333">+</span> img3_off <span style="color: #333333">+</span> MEM_FENCE_WIDTH;

    <span style="color: #666666; font-style: italic">/* Set up the memory fence on the build buffer. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> MEM_FENCE_WIDTH; i<span style="color: #333333">++</span>) {
        build[i] <span style="color: #333333">=</span> MEM_FENCE_MAGIC;
        build[BUILD_BUF_SIZE <span style="color: #333333">+</span> MEM_FENCE_WIDTH <span style="color: #333333">+</span> i] <span style="color: #333333">=</span> MEM_FENCE_MAGIC;
    }

    <span style="color: #666666; font-style: italic">/* One display page goes at the start of video memory. */</span>
    target_img <span style="color: #333333">=</span> <span style="color: #005588; font-weight: bold">0x1680</span> ; <span style="color: #666666; font-style: italic">//target_img = 320*18</span>

    <span style="color: #666666; font-style: italic">/* Map video memory and obtain permission for VGA port access. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (open_memory_and_ports () <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>)
        <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * The code below was produced by recording a call to set mode 0013h</span>
<span style="color: #666666; font-style: italic">     * with display memory clearing and a windowed frame buffer, then</span>
<span style="color: #666666; font-style: italic">     * modifying the code to set mode X instead.  The code was then</span>
<span style="color: #666666; font-style: italic">     * generalized into functions...</span>
<span style="color: #666666; font-style: italic">     *</span>
<span style="color: #666666; font-style: italic">     * modifications from mode 13h to mode X include...</span>
<span style="color: #666666; font-style: italic">     *   Sequencer Memory Mode Register: 0x0E to 0x06 (0x3C4/0x04)</span>
<span style="color: #666666; font-style: italic">     *   Underline Location Register   : 0x40 to 0x00 (0x3D4/0x14)</span>
<span style="color: #666666; font-style: italic">     *   CRTC Mode Control Register    : 0xA3 to 0xE3 (0x3D4/0x17)</span>
<span style="color: #666666; font-style: italic">     */</span>

    VGA_blank (<span style="color: #6666ff; font-weight: bold">1</span>);                               <span style="color: #666666; font-style: italic">/* blank the screen      */</span>
    set_seq_regs_and_reset (mode_X_seq, <span style="color: #005588; font-weight: bold">0x63</span>);   <span style="color: #666666; font-style: italic">/* sequencer registers   */</span>
    set_CRTC_registers (mode_X_CRTC);            <span style="color: #666666; font-style: italic">/* CRT control registers */</span>
    set_attr_registers (mode_X_attr);            <span style="color: #666666; font-style: italic">/* attribute registers   */</span>
    set_graphics_registers (mode_X_graphics);    <span style="color: #666666; font-style: italic">/* graphics registers    */</span>
    fill_palette_mode_x ();      <span style="color: #666666; font-style: italic">/* palette colors        */</span>
    clear_screens ();        <span style="color: #666666; font-style: italic">/* zero video memory     */</span>
    VGA_blank (<span style="color: #6666ff; font-weight: bold">0</span>);               <span style="color: #666666; font-style: italic">/* unblank the screen    */</span>

    <span style="color: #666666; font-style: italic">/* Return success. */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * clear_mode_X</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Puts the VGA into text mode 3 (color text).</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: restores font data to video memory; clears screens;</span>
<span style="color: #666666; font-style: italic"> *                 unmaps video memory; checks memory fence integrity</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">clear_mode_X</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int</span> i;   <span style="color: #666666; font-style: italic">/* loop index for checking memory fence */</span>
    
    <span style="color: #666666; font-style: italic">/* Put VGA into text mode, restore font data, and clear screens. */</span>
    set_text_mode_3 (<span style="color: #6666ff; font-weight: bold">1</span>);

    <span style="color: #666666; font-style: italic">/* Unmap video memory. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)munmap (mem_image, VID_MEM_SIZE);

    <span style="color: #666666; font-style: italic">/* Check validity of build buffer memory fence.  Report breakage. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> MEM_FENCE_WIDTH; i<span style="color: #333333">++</span>) {
  <span style="color: #228899; font-weight: bold">if</span> (build[i] <span style="color: #333333">!=</span> MEM_FENCE_MAGIC) {
      puts (<span style="background-color: #e0e0ff">&quot;lower build fence was broken&quot;</span>);
      <span style="color: #228899; font-weight: bold">break</span>;
  }
    }
    <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> MEM_FENCE_WIDTH; i<span style="color: #333333">++</span>) {
        <span style="color: #228899; font-weight: bold">if</span> (build[BUILD_BUF_SIZE <span style="color: #333333">+</span> MEM_FENCE_WIDTH <span style="color: #333333">+</span> i] <span style="color: #333333">!=</span> MEM_FENCE_MAGIC) {
      puts (<span style="background-color: #e0e0ff">&quot;upper build fence was broken&quot;</span>);
      <span style="color: #228899; font-weight: bold">break</span>;
  }
    }
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * set_view_window</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Set the logical view window, moving its location within</span>
<span style="color: #666666; font-style: italic"> *                the build buffer if necessary to keep all on-screen data</span>
<span style="color: #666666; font-style: italic"> *                in the build buffer.  If the location within the build</span>
<span style="color: #666666; font-style: italic"> *                buffer moves, this function copies all data from the old</span>
<span style="color: #666666; font-style: italic"> *                window that are within the new screen to the appropriate</span>
<span style="color: #666666; font-style: italic"> *                new location, so only data not previously on the screen </span>
<span style="color: #666666; font-style: italic"> *                must be drawn before calling show_screen.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: (scr_x,scr_y) -- new upper left pixel of logical view window</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may shift position of logical view window within build </span>
<span style="color: #666666; font-style: italic"> *                 buffer</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">set_view_window</span> (<span style="color: #6666ff; font-weight: bold">int</span> scr_x, <span style="color: #6666ff; font-weight: bold">int</span> scr_y)
{
    <span style="color: #6666ff; font-weight: bold">int</span> old_x, old_y;     <span style="color: #666666; font-style: italic">/* old position of logical view window           */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> start_x, start_y; <span style="color: #666666; font-style: italic">/* starting position for copying from old to new */</span> 
    <span style="color: #6666ff; font-weight: bold">int</span> end_x, end_y;     <span style="color: #666666; font-style: italic">/* ending position for copying from old to new   */</span> 
    <span style="color: #6666ff; font-weight: bold">int</span> start_off;        <span style="color: #666666; font-style: italic">/* offset of copy start relative to old build    */</span>
                  <span style="color: #666666; font-style: italic">/*    buffer start position                      */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> length;           <span style="color: #666666; font-style: italic">/* amount of data to be copied                   */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> i;            <span style="color: #666666; font-style: italic">/* copy loop index                               */</span>
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> start_addr;  <span style="color: #666666; font-style: italic">/* starting memory address of copy     */</span>
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> target_addr; <span style="color: #666666; font-style: italic">/* destination memory address for copy */</span>

    <span style="color: #666666; font-style: italic">/* Record the old position. */</span>
    old_x <span style="color: #333333">=</span> show_x;
    old_y <span style="color: #333333">=</span> show_y;

    <span style="color: #666666; font-style: italic">/* Keep track of the new view window. */</span>
    show_x <span style="color: #333333">=</span> scr_x;
    show_y <span style="color: #333333">=</span> scr_y;

    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * If the new view window fits within the boundaries of the build </span>
<span style="color: #666666; font-style: italic">     * buffer, we need move nothing around.</span>
<span style="color: #666666; font-style: italic">    */</span>
    <span style="color: #228899; font-weight: bold">if</span> (img3_off <span style="color: #333333">+</span> (scr_x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">+</span> scr_y <span style="color: #333333">*</span> SCROLL_X_WIDTH <span style="color: #333333">&gt;=</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&amp;&amp;</span>
        img3_off <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> SCROLL_SIZE <span style="color: #333333">+</span>
      ((scr_x <span style="color: #333333">+</span> SCROLL_X_DIM <span style="color: #333333">-</span> <span style="color: #6666ff; font-weight: bold">1</span>) <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">+</span> 
      (scr_y <span style="color: #333333">+</span> SCROLL_Y_DIM <span style="color: #333333">-</span> <span style="color: #6666ff; font-weight: bold">1</span>) <span style="color: #333333">*</span> SCROLL_X_WIDTH <span style="color: #333333">&lt;</span> BUILD_BUF_SIZE)
  <span style="color: #228899; font-weight: bold">return</span>;

    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * If the new screen does not overlap at all with the old screen, none</span>
<span style="color: #666666; font-style: italic">     * of the old data need to be saved, and we can simply reposition the</span>
<span style="color: #666666; font-style: italic">     * valid window of the build buffer in the middle of that buffer.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (scr_x <span style="color: #333333">&lt;=</span> old_x <span style="color: #333333">-</span> SCROLL_X_DIM <span style="color: #333333">||</span> scr_x <span style="color: #333333">&gt;=</span> old_x <span style="color: #333333">+</span> SCROLL_X_DIM <span style="color: #333333">||</span>
  scr_y <span style="color: #333333">&lt;=</span> old_y <span style="color: #333333">-</span> SCROLL_Y_DIM <span style="color: #333333">||</span> scr_y <span style="color: #333333">&gt;=</span> old_y <span style="color: #333333">+</span> SCROLL_Y_DIM) {
  img3_off <span style="color: #333333">=</span> BUILD_BASE_INIT <span style="color: #333333">-</span> (scr_x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">-</span> scr_y <span style="color: #333333">*</span> SCROLL_X_WIDTH;
  img3 <span style="color: #333333">=</span> build <span style="color: #333333">+</span> img3_off <span style="color: #333333">+</span> MEM_FENCE_WIDTH;
  <span style="color: #228899; font-weight: bold">return</span>;
    }

    <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic">     * Any still-visible portion of the old screen should be retained.</span>
<span style="color: #666666; font-style: italic">     * Rather than clipping exactly, we copy all contiguous data between</span>
<span style="color: #666666; font-style: italic">     * a clipped starting point to a clipped ending point (which may</span>
<span style="color: #666666; font-style: italic">     * include non-visible data).</span>
<span style="color: #666666; font-style: italic">     *</span>
<span style="color: #666666; font-style: italic">     * The starting point is the maximum (x,y) coordinates between the</span>
<span style="color: #666666; font-style: italic">     * new and old screens.  The ending point is the minimum (x,y)</span>
<span style="color: #666666; font-style: italic">     * coordinates between the old and new screens (offset by the screen</span>
<span style="color: #666666; font-style: italic">     * size).</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (scr_x <span style="color: #333333">&gt;</span> old_x) {
        start_x <span style="color: #333333">=</span> scr_x;
  end_x <span style="color: #333333">=</span> old_x;
    } <span style="color: #228899; font-weight: bold">else</span> {
        start_x <span style="color: #333333">=</span> old_x;
  end_x <span style="color: #333333">=</span> scr_x;
    }
    end_x <span style="color: #333333">+=</span> SCROLL_X_DIM <span style="color: #333333">-</span> <span style="color: #6666ff; font-weight: bold">1</span>;
    <span style="color: #228899; font-weight: bold">if</span> (scr_y <span style="color: #333333">&gt;</span> old_y) {
        start_y <span style="color: #333333">=</span> scr_y;
  end_y <span style="color: #333333">=</span> old_y;
    } <span style="color: #228899; font-weight: bold">else</span> {
        start_y <span style="color: #333333">=</span> old_y;
  end_y <span style="color: #333333">=</span> scr_y;
    }
    end_y <span style="color: #333333">+=</span> SCROLL_Y_DIM <span style="color: #333333">-</span> <span style="color: #6666ff; font-weight: bold">1</span>;

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * We now calculate the starting and ending addresses for the copy</span>
<span style="color: #666666; font-style: italic">     * as well as the new offsets for use with the build buffer.  The</span>
<span style="color: #666666; font-style: italic">     * length to be copied is basically the ending offset minus the starting</span>
<span style="color: #666666; font-style: italic">     * offset plus one (plus the three screens in between planes 3 and 0).</span>
<span style="color: #666666; font-style: italic">     */</span>
    start_off <span style="color: #333333">=</span> (start_x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">+</span> start_y <span style="color: #333333">*</span> SCROLL_X_WIDTH;
    start_addr <span style="color: #333333">=</span> img3 <span style="color: #333333">+</span> start_off;
    length <span style="color: #333333">=</span> (end_x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">+</span> end_y <span style="color: #333333">*</span> SCROLL_X_WIDTH <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">-</span> start_off <span style="color: #333333">+</span> 
       <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> SCROLL_SIZE;
    img3_off <span style="color: #333333">=</span> BUILD_BASE_INIT <span style="color: #333333">-</span> (show_x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">-</span> show_y <span style="color: #333333">*</span> SCROLL_X_WIDTH;
    img3 <span style="color: #333333">=</span> build <span style="color: #333333">+</span> img3_off <span style="color: #333333">+</span> MEM_FENCE_WIDTH;
    target_addr <span style="color: #333333">=</span> img3 <span style="color: #333333">+</span> start_off;

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Copy the relevant portion of the screen from the old location to the</span>
<span style="color: #666666; font-style: italic">     * new one.  The areas may overlap, so copy direction is important. </span>
<span style="color: #666666; font-style: italic">     * (You should be able to explain why!)</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (start_addr <span style="color: #333333">&lt;</span> target_addr)
  <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> length; i<span style="color: #333333">--</span> <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span>; )
      target_addr[i] <span style="color: #333333">=</span> start_addr[i];
    <span style="color: #228899; font-weight: bold">else</span>
  <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> length; i<span style="color: #333333">++</span>)
      target_addr[i] <span style="color: #333333">=</span> start_addr[i];
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * show_screen</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Show the logical view window on the video display.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: copies from the build buffer to video memory;</span>
<span style="color: #666666; font-style: italic"> *                 shifts the VGA display source to point to the new image</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">show_screen</span> ()
{
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> addr;  <span style="color: #666666; font-style: italic">/* source address for copy             */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> p_off;            <span style="color: #666666; font-style: italic">/* plane offset of first display plane */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> i;      <span style="color: #666666; font-style: italic">/* loop index over video planes        */</span>

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Calculate offset of build buffer plane to be mapped into plane 0 </span>
<span style="color: #666666; font-style: italic">     * of display.</span>
<span style="color: #666666; font-style: italic">     */</span>
    p_off <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">-</span> (show_x <span style="color: #333333">&amp;</span> <span style="color: #6666ff; font-weight: bold">3</span>));

    <span style="color: #666666; font-style: italic">/* Switch to the other target screen in video memory. */</span>
    target_img <span style="color: #333333">^=</span> <span style="color: #005588; font-weight: bold">0x4000</span>;

    <span style="color: #666666; font-style: italic">/* Calculate the source address. */</span>
    addr <span style="color: #333333">=</span> img3 <span style="color: #333333">+</span> (show_x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">+</span> show_y <span style="color: #333333">*</span> SCROLL_X_WIDTH;

    <span style="color: #666666; font-style: italic">/* Draw to each plane in the video memory. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">4</span>; i<span style="color: #333333">++</span>) {
      SET_WRITE_MASK (<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">&lt;&lt;</span> (i <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">8</span>));
      copy_image (addr <span style="color: #333333">+</span> ((p_off <span style="color: #333333">-</span> i <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">4</span>) <span style="color: #333333">&amp;</span> <span style="color: #6666ff; font-weight: bold">3</span>) <span style="color: #333333">*</span> SCROLL_SIZE <span style="color: #333333">+</span> (p_off <span style="color: #333333">&lt;</span> i), 
                  target_img);
    }

    show_status_bar();

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Change the VGA registers to point the top left of the screen</span>
<span style="color: #666666; font-style: italic">     * to the video memory that we just filled.</span>
<span style="color: #666666; font-style: italic">     */</span>
    OUTW (<span style="color: #005588; font-weight: bold">0x03D4</span>, (target_img <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0xFF00</span>) <span style="color: #333333">|</span> <span style="color: #005588; font-weight: bold">0x0C</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x03D4</span>, ((target_img <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x00FF</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">8</span>) <span style="color: #333333">|</span> <span style="color: #005588; font-weight: bold">0x0D</span>);



}

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * show_status_bar()</span>
<span style="color: #666666; font-style: italic"> *    DESCRIPTION: Displays the status bar on the screen</span>
<span style="color: #666666; font-style: italic"> *    INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *    OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *    RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *    SIDE EFFECTS: Like show_screen, copies from build buffer to</span>
<span style="color: #666666; font-style: italic"> *                  video memory</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">show_status_bar</span>()
{
  <span style="color: #666666; font-style: italic">//creating variable used for loops</span>
  <span style="color: #6666ff; font-weight: bold">int</span> i,j; 
  <span style="color: #6666ff; font-weight: bold">int</span> p_off;                   

  <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> status_bar_buffer_planed[STATUS_BAR_SIZE];
 
  <span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> STATUS_BAR_HEIGHT; i<span style="color: #333333">++</span>)
  {
    <span style="color: #228899; font-weight: bold">for</span>(j<span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; j <span style="color: #333333">&lt;</span> STATUS_BAR_WIDTH; j<span style="color: #333333">++</span>)
    {
        p_off <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">-</span> (j <span style="color: #333333">&amp;</span> <span style="color: #6666ff; font-weight: bold">3</span>));
        status_bar_buffer_planed[STATUS_BAR_SCROLLSIZE<span style="color: #333333">*</span>p_off<span style="color: #333333">+</span>((i <span style="color: #333333">*</span> STATUS_BAR_WIDTH <span style="color: #333333">+</span> j) <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">4</span>)] <span style="color: #333333">=</span> status_bar_buffer[i <span style="color: #333333">*</span> STATUS_BAR_WIDTH <span style="color: #333333">+</span> j];
    }
  }

  <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">4</span>; i<span style="color: #333333">++</span>)   <span style="color: #666666; font-style: italic">//copies plane by plane</span>
  {
    SET_WRITE_MASK(<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">&lt;&lt;</span> (i <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">8</span>));
    copy_status_bar(status_bar_buffer_planed <span style="color: #333333">+</span> (<span style="color: #6666ff; font-weight: bold">3</span><span style="color: #333333">-</span>i) <span style="color: #333333">*</span> STATUS_BAR_SCROLLSIZE);
  }<span style="color: #666666; font-style: italic">//end for</span>
  
}<span style="color: #666666; font-style: italic">//end show_status_bar</span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * clear_screens</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Fills the video memory with zeroes. </span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: fills all 256kB of VGA video memory with zeroes</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">clear_screens</span> ()
{
    <span style="color: #666666; font-style: italic">/* Write to all four planes at once. */</span> 
    SET_WRITE_MASK (<span style="color: #005588; font-weight: bold">0x0F00</span>);

    <span style="color: #666666; font-style: italic">/* Set 64kB to zero (times four planes = 256kB). */</span>
    memset (mem_image, <span style="color: #6666ff; font-weight: bold">0</span>, MODE_X_MEM_SIZE);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * The functions inside the preprocessor block below rely on functions</span>
<span style="color: #666666; font-style: italic"> * in maze.c to generate graphical images of the maze.  These functions</span>
<span style="color: #666666; font-style: italic"> * are neither available nor necessary for the text restoration program</span>
<span style="color: #666666; font-style: italic"> * based on this file, and are omitted to simplify linking that program.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#if !defined(TEXT_RESTORE_PROGRAM)</span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * draw_vert_line</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Draw a vertical map line into the build buffer.  The </span>
<span style="color: #666666; font-style: italic"> *                line should be offset from the left side of the logical</span>
<span style="color: #666666; font-style: italic"> *                view window screen by the given number of pixels.  </span>
<span style="color: #666666; font-style: italic"> *   INPUTS: x -- the 0-based pixel column number of the line to be drawn</span>
<span style="color: #666666; font-style: italic"> *                within the logical view window (equivalent to the number</span>
<span style="color: #666666; font-style: italic"> *                of pixels from the leftmost pixel to the line to be</span>
<span style="color: #666666; font-style: italic"> *                drawn)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: Returns 0 on success.  If x is outside of the valid </span>
<span style="color: #666666; font-style: italic"> *                 SCROLL range, the function returns -1.  </span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: draws into the build buffer</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">draw_vert_line</span> (<span style="color: #6666ff; font-weight: bold">int</span> x)
{
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> buf[SCROLL_Y_DIM];
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> addr;

    <span style="color: #6666ff; font-weight: bold">int</span> p_off;
    <span style="color: #6666ff; font-weight: bold">int</span> i;

    <span style="color: #666666; font-style: italic">//Checking if requested line is in logical view window</span>
    <span style="color: #228899; font-weight: bold">if</span> (x <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">||</span> x <span style="color: #333333">&gt;</span> SCROLL_X_DIM)
      <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;

    <span style="color: #666666; font-style: italic">//Adjusting x to the logical row value</span>
    x <span style="color: #333333">=</span> x <span style="color: #333333">+</span> show_x;

    <span style="color: #666666; font-style: italic">//Getting the image of the column</span>
    (<span style="color: #333333">*</span>vert_line_fn) (x, show_y, buf);

    <span style="color: #666666; font-style: italic">//Calculating starting address in build buffer</span>
    addr <span style="color: #333333">=</span> img3 <span style="color: #333333">+</span> (x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">+</span> show_y <span style="color: #333333">*</span> SCROLL_X_WIDTH;

    <span style="color: #666666; font-style: italic">//Calculating plane offset of first pixel</span>
    p_off <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">-</span> (x <span style="color: #333333">&amp;</span> <span style="color: #6666ff; font-weight: bold">3</span>));

    <span style="color: #666666; font-style: italic">//Copying image data into appropriate planes in build buffer</span>
    <span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> SCROLL_Y_DIM; i<span style="color: #333333">++</span>)
    {
      addr[p_off <span style="color: #333333">*</span> SCROLL_SIZE] <span style="color: #333333">=</span> buf[i];
      addr <span style="color: #333333">=</span> addr <span style="color: #333333">+</span> SCROLL_X_WIDTH;
    }<span style="color: #666666; font-style: italic">//end for</span>

    <span style="color: #666666; font-style: italic">//Returning 0 if success</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * draw_horiz_line</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Draw a horizontal map line into the build buffer.  The </span>
<span style="color: #666666; font-style: italic"> *                line should be offset from the top of the logical view </span>
<span style="color: #666666; font-style: italic"> *                window screen by the given number of pixels.  </span>
<span style="color: #666666; font-style: italic"> *   INPUTS: y -- the 0-based pixel row number of the line to be drawn</span>
<span style="color: #666666; font-style: italic"> *                within the logical view window (equivalent to the number</span>
<span style="color: #666666; font-style: italic"> *                of pixels from the top pixel to the line to be drawn)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: Returns 0 on success.  If y is outside of the valid </span>
<span style="color: #666666; font-style: italic"> *                 SCROLL range, the function returns -1.  </span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: draws into the build buffer</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">draw_horiz_line</span> (<span style="color: #6666ff; font-weight: bold">int</span> y)
{
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> buf[SCROLL_X_DIM]; <span style="color: #666666; font-style: italic">/* buffer for graphical image of line */</span>
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> addr;             <span style="color: #666666; font-style: italic">/* address of first pixel in build    */</span>
               <span style="color: #666666; font-style: italic">/*     buffer (without plane offset)  */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> p_off;                       <span style="color: #666666; font-style: italic">/* offset of plane of first pixel     */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> i;           <span style="color: #666666; font-style: italic">/* loop index over pixels             */</span>

    <span style="color: #666666; font-style: italic">/* Check whether requested line falls in the logical view window. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (y <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">||</span> y <span style="color: #333333">&gt;=</span> SCROLL_Y_DIM)
  <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;

    <span style="color: #666666; font-style: italic">/* Adjust y to the logical row value. */</span>
    y <span style="color: #333333">+=</span> show_y;

    <span style="color: #666666; font-style: italic">/* Get the image of the line. */</span>
    (<span style="color: #333333">*</span>horiz_line_fn) (show_x, y, buf);

    <span style="color: #666666; font-style: italic">/* Calculate starting address in build buffer. */</span>
    addr <span style="color: #333333">=</span> img3 <span style="color: #333333">+</span> (show_x <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">+</span> y <span style="color: #333333">*</span> SCROLL_X_WIDTH;

    <span style="color: #666666; font-style: italic">/* Calculate plane offset of first pixel. */</span>
    p_off <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">-</span> (show_x <span style="color: #333333">&amp;</span> <span style="color: #6666ff; font-weight: bold">3</span>));

    <span style="color: #666666; font-style: italic">/* Copy image data into appropriate planes in build buffer. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> SCROLL_X_DIM; i<span style="color: #333333">++</span>) {
        addr[p_off <span style="color: #333333">*</span> SCROLL_SIZE] <span style="color: #333333">=</span> buf[i];
  <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">--</span>p_off <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">0</span>) {
      p_off <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">3</span>;
      addr<span style="color: #333333">++</span>;
  }
    }

    <span style="color: #666666; font-style: italic">/* Return success. */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}

<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* !defined(TEXT_RESTORE_PROGRAM) */</span><span style="color: #557799"></span>


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * open_memory_and_ports</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Map video memory into our address space; obtain permission</span>
<span style="color: #666666; font-style: italic"> *                to access VGA ports.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 0 on success, -1 on failure</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: prints an error message to stdout on failure</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">open_memory_and_ports</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int</span> mem_fd;  <span style="color: #666666; font-style: italic">/* file descriptor for physical memory image */</span>

    <span style="color: #666666; font-style: italic">/* Obtain permission to access ports 0x03C0 through 0x03DA. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (ioperm (<span style="color: #005588; font-weight: bold">0x03C0</span>, <span style="color: #005588; font-weight: bold">0x03DA</span> <span style="color: #333333">-</span> <span style="color: #005588; font-weight: bold">0x03C0</span> <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #6666ff; font-weight: bold">1</span>) <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>) {
  perror (<span style="background-color: #e0e0ff">&quot;set port permissions&quot;</span>);
  <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
    }

    <span style="color: #666666; font-style: italic">/* Open file to access physical memory. */</span>
    <span style="color: #228899; font-weight: bold">if</span> ((mem_fd <span style="color: #333333">=</span> open (<span style="background-color: #e0e0ff">&quot;/dev/mem&quot;</span>, O_RDWR)) <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>) {
        perror (<span style="background-color: #e0e0ff">&quot;open /dev/mem&quot;</span>);
  <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
    }

    <span style="color: #666666; font-style: italic">/* Map video memory (0xA0000 - 0xBFFFF) into our address space. */</span>
    <span style="color: #228899; font-weight: bold">if</span> ((mem_image <span style="color: #333333">=</span> mmap (<span style="color: #6666ff; font-weight: bold">0</span>, VID_MEM_SIZE, PROT_READ <span style="color: #333333">|</span> PROT_WRITE,
         MAP_SHARED, mem_fd, <span style="color: #005588; font-weight: bold">0xA0000</span>)) <span style="color: #333333">==</span> MAP_FAILED) {
  perror (<span style="background-color: #e0e0ff">&quot;mmap video memory&quot;</span>);
  <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>;
    }

    <span style="color: #666666; font-style: italic">/* Close /dev/mem file descriptor and return success. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)close (mem_fd);
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * VGA_blank</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Blank or unblank the VGA display.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: blank_bit -- set to 1 to blank, 0 to unblank</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">VGA_blank</span> (<span style="color: #6666ff; font-weight: bold">int</span> blank_bit)
{
    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Move blanking bit into position for VGA sequencer register </span>
<span style="color: #666666; font-style: italic">     * (index 1). </span>
<span style="color: #666666; font-style: italic">     */</span>
    blank_bit <span style="color: #333333">=</span> ((blank_bit <span style="color: #333333">&amp;</span> <span style="color: #6666ff; font-weight: bold">1</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">5</span>);

    asm <span style="color: #228899; font-weight: bold">volatile</span> (
  <span style="background-color: #e0e0ff">&quot;movb $0x01,%%al         /* Set sequencer index to 1. */       ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;movw $0x03C4,%%dx                                             ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;outb %%al,(%%dx)                                              ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;incw %%dx                                                     ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;inb (%%dx),%%al         /* Read old value.           */       ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;andb $0xDF,%%al         /* Calculate new value.      */       ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;orl %0,%%eax                                                  ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;outb %%al,(%%dx)        /* Write new value.          */       ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;movw $0x03DA,%%dx       /* Enable display (0x20-&gt;P[0x3C0]) */ ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;inb (%%dx),%%al         /* Set attr reg state to index. */    ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;movw $0x03C0,%%dx       /* Write index 0x20 to enable. */     ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;movb $0x20,%%al                                               ;&quot;</span>
  <span style="background-color: #e0e0ff">&quot;outb %%al,(%%dx)                                               &quot;</span>
      <span style="color: #333333">:</span> <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;g&quot;</span> (blank_bit) <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;eax&quot;</span>, <span style="background-color: #e0e0ff">&quot;edx&quot;</span>, <span style="background-color: #e0e0ff">&quot;memory&quot;</span>);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * set_seq_regs_and_reset</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Set VGA sequencer registers and miscellaneous output</span>
<span style="color: #666666; font-style: italic"> *                register; array of registers should force a reset of</span>
<span style="color: #666666; font-style: italic"> *                the VGA sequencer, which is restored to normal operation</span>
<span style="color: #666666; font-style: italic"> *                after a brief delay.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: table -- table of sequencer register values to use</span>
<span style="color: #666666; font-style: italic"> *           val -- value to which miscellaneous output register should be set</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">set_seq_regs_and_reset</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> table[NUM_SEQUENCER_REGS],
      <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> val)
{
    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Dump table of values to sequencer registers.  Includes forced reset</span>
<span style="color: #666666; font-style: italic">     * as well as video blanking.</span>
<span style="color: #666666; font-style: italic">     */</span>
    REP_OUTSW (<span style="color: #005588; font-weight: bold">0x03C4</span>, table, NUM_SEQUENCER_REGS);

    <span style="color: #666666; font-style: italic">/* Delay a bit... */</span>
    {<span style="color: #228899; font-weight: bold">volatile</span> <span style="color: #6666ff; font-weight: bold">int</span> ii; <span style="color: #228899; font-weight: bold">for</span> (ii <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; ii <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">10000</span>; ii<span style="color: #333333">++</span>);}

    <span style="color: #666666; font-style: italic">/* Set VGA miscellaneous output register. */</span>
    OUTB (<span style="color: #005588; font-weight: bold">0x03C2</span>, val);

    <span style="color: #666666; font-style: italic">/* Turn sequencer on (array values above should always force reset). */</span>
    OUTW (<span style="color: #005588; font-weight: bold">0x03C4</span>,<span style="color: #005588; font-weight: bold">0x0300</span>);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * set_CRTC_registers</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Set VGA cathode ray tube controller (CRTC) registers.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: table -- table of CRTC register values to use</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">set_CRTC_registers</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> table[NUM_CRTC_REGS])
{
    <span style="color: #666666; font-style: italic">/* clear protection bit to enable write access to first few registers */</span>
    OUTW (<span style="color: #005588; font-weight: bold">0x03D4</span>, <span style="color: #005588; font-weight: bold">0x0011</span>); 
    REP_OUTSW (<span style="color: #005588; font-weight: bold">0x03D4</span>, table, NUM_CRTC_REGS);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * set_attr_registers</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Set VGA attribute registers.  Attribute registers use</span>
<span style="color: #666666; font-style: italic"> *                a single port and are thus written as a sequence of bytes</span>
<span style="color: #666666; font-style: italic"> *                rather than a sequence of words.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: table -- table of attribute register values to use</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">set_attr_registers</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> table[NUM_ATTR_REGS <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">2</span>])
{
    <span style="color: #666666; font-style: italic">/* Reset attribute register to write index next rather than data. */</span>
    asm <span style="color: #228899; font-weight: bold">volatile</span> (
  <span style="background-color: #e0e0ff">&quot;inb (%%dx),%%al&quot;</span>
      <span style="color: #333333">:</span> <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;d&quot;</span> (<span style="color: #005588; font-weight: bold">0x03DA</span>) <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;eax&quot;</span>, <span style="background-color: #e0e0ff">&quot;memory&quot;</span>);
    REP_OUTSB (<span style="color: #005588; font-weight: bold">0x03C0</span>, table, NUM_ATTR_REGS <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">2</span>);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * set_graphics_registers</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Set VGA graphics registers.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: table -- table of graphics register values to use</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">set_graphics_registers</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> table[NUM_GRAPHICS_REGS])
{
    REP_OUTSW (<span style="color: #005588; font-weight: bold">0x03CE</span>, table, NUM_GRAPHICS_REGS);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * fill_palette_mode_x</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Fill VGA palette with necessary colors for the adventure </span>
<span style="color: #666666; font-style: italic"> *                game.  Only the first 64 (of 256) colors are written.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: changes the first 64 palette colors</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">fill_palette_mode_x</span> ()
{
    <span style="color: #666666; font-style: italic">/* 6-bit RGB (red, green, blue) values for first 64 colors */</span>
    <span style="color: #666666; font-style: italic">/* these are coded for 2 bits red, 2 bits green, 2 bits blue */</span>
    <span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> palette_RGB[<span style="color: #6666ff; font-weight: bold">64</span>][<span style="color: #6666ff; font-weight: bold">3</span>] <span style="color: #333333">=</span> {
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x2A</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>}
    };

    <span style="color: #666666; font-style: italic">/* Start writing at color 0. */</span>
    OUTB (<span style="color: #005588; font-weight: bold">0x03C8</span>, <span style="color: #005588; font-weight: bold">0x00</span>);

    <span style="color: #666666; font-style: italic">/* Write all 64 colors from array. */</span>
    REP_OUTSB (<span style="color: #005588; font-weight: bold">0x03C9</span>, palette_RGB, <span style="color: #6666ff; font-weight: bold">64</span> <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">3</span>);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * fill_palette_text</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Fill VGA palette with default VGA colors.</span>
<span style="color: #666666; font-style: italic"> *                Only the first 32 (of 256) colors are written.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: changes the first 32 palette colors</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">fill_palette_text</span> ()
{
    <span style="color: #666666; font-style: italic">/* 6-bit RGB (red, green, blue) values VGA colors and grey scale */</span>
    <span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> palette_RGB[<span style="color: #6666ff; font-weight: bold">32</span>][<span style="color: #6666ff; font-weight: bold">3</span>] <span style="color: #333333">=</span> {
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>},   <span style="color: #666666; font-style: italic">/* palette 0x00 - 0x0F    */</span>
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>},   <span style="color: #666666; font-style: italic">/* basic VGA colors       */</span>
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x2A</span>},
  {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>, <span style="color: #005588; font-weight: bold">0x2A</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>}, {<span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x15</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x15</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>},
  {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}, {<span style="color: #005588; font-weight: bold">0x05</span>, <span style="color: #005588; font-weight: bold">0x05</span>, <span style="color: #005588; font-weight: bold">0x05</span>},   <span style="color: #666666; font-style: italic">/* palette 0x10 - 0x1F    */</span>
  {<span style="color: #005588; font-weight: bold">0x08</span>, <span style="color: #005588; font-weight: bold">0x08</span>, <span style="color: #005588; font-weight: bold">0x08</span>}, {<span style="color: #005588; font-weight: bold">0x0B</span>, <span style="color: #005588; font-weight: bold">0x0B</span>, <span style="color: #005588; font-weight: bold">0x0B</span>},   <span style="color: #666666; font-style: italic">/* VGA grey scale         */</span>
  {<span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x0E</span>}, {<span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x11</span>},
  {<span style="color: #005588; font-weight: bold">0x14</span>, <span style="color: #005588; font-weight: bold">0x14</span>, <span style="color: #005588; font-weight: bold">0x14</span>}, {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
  {<span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x1C</span>}, {<span style="color: #005588; font-weight: bold">0x20</span>, <span style="color: #005588; font-weight: bold">0x20</span>, <span style="color: #005588; font-weight: bold">0x20</span>},
  {<span style="color: #005588; font-weight: bold">0x24</span>, <span style="color: #005588; font-weight: bold">0x24</span>, <span style="color: #005588; font-weight: bold">0x24</span>}, {<span style="color: #005588; font-weight: bold">0x28</span>, <span style="color: #005588; font-weight: bold">0x28</span>, <span style="color: #005588; font-weight: bold">0x28</span>},
  {<span style="color: #005588; font-weight: bold">0x2D</span>, <span style="color: #005588; font-weight: bold">0x2D</span>, <span style="color: #005588; font-weight: bold">0x2D</span>}, {<span style="color: #005588; font-weight: bold">0x32</span>, <span style="color: #005588; font-weight: bold">0x32</span>, <span style="color: #005588; font-weight: bold">0x32</span>},
  {<span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x38</span>}, {<span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x3F</span>}
    };

    <span style="color: #666666; font-style: italic">/* Start writing at color 0. */</span>
    OUTB (<span style="color: #005588; font-weight: bold">0x03C8</span>, <span style="color: #005588; font-weight: bold">0x00</span>);

    <span style="color: #666666; font-style: italic">/* Write all 32 colors from array. */</span>
    REP_OUTSB (<span style="color: #005588; font-weight: bold">0x03C9</span>, palette_RGB, <span style="color: #6666ff; font-weight: bold">32</span> <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">3</span>);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * write_font_data</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Copy font data into VGA memory, changing and restoring</span>
<span style="color: #666666; font-style: italic"> *                VGA register values in order to do so. </span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: leaves VGA registers in final text mode state</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">write_font_data</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int</span> i;                <span style="color: #666666; font-style: italic">/* loop index over characters                   */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> j;                <span style="color: #666666; font-style: italic">/* loop index over font bytes within characters */</span>
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> fonts; <span style="color: #666666; font-style: italic">/* pointer into video memory                    */</span>

    <span style="color: #666666; font-style: italic">/* Prepare VGA to write font data into video memory. */</span>
    OUTW (<span style="color: #005588; font-weight: bold">0x3C4</span>, <span style="color: #005588; font-weight: bold">0x0402</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3C4</span>, <span style="color: #005588; font-weight: bold">0x0704</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3CE</span>, <span style="color: #005588; font-weight: bold">0x0005</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3CE</span>, <span style="color: #005588; font-weight: bold">0x0406</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3CE</span>, <span style="color: #005588; font-weight: bold">0x0204</span>);

    <span style="color: #666666; font-style: italic">/* Copy font data from array into video memory. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>, fonts <span style="color: #333333">=</span> mem_image; i <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">256</span>; i<span style="color: #333333">++</span>) {
  <span style="color: #228899; font-weight: bold">for</span> (j <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; j <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">16</span>; j<span style="color: #333333">++</span>)
      fonts[j] <span style="color: #333333">=</span> font_data[i][j];
  fonts <span style="color: #333333">+=</span> <span style="color: #6666ff; font-weight: bold">32</span>; <span style="color: #666666; font-style: italic">/* skip 16 bytes between characters */</span>
    }

    <span style="color: #666666; font-style: italic">/* Prepare VGA for text mode. */</span>
    OUTW (<span style="color: #005588; font-weight: bold">0x3C4</span>, <span style="color: #005588; font-weight: bold">0x0302</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3C4</span>, <span style="color: #005588; font-weight: bold">0x0304</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3CE</span>, <span style="color: #005588; font-weight: bold">0x1005</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3CE</span>, <span style="color: #005588; font-weight: bold">0x0E06</span>);
    OUTW (<span style="color: #005588; font-weight: bold">0x3CE</span>, <span style="color: #005588; font-weight: bold">0x0004</span>);
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * set_text_mode_3</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Put VGA into text mode 3 (color text).</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: clear_scr -- if non-zero, clear screens; otherwise, do not</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may clear screens; writes font data to video memory</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">set_text_mode_3</span> (<span style="color: #6666ff; font-weight: bold">int</span> clear_scr)
{
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span><span style="color: #333333">*</span> txt_scr; <span style="color: #666666; font-style: italic">/* pointer to text screens in video memory */</span>
    <span style="color: #6666ff; font-weight: bold">int</span> i;                  <span style="color: #666666; font-style: italic">/* loop over text screen words             */</span>

    VGA_blank (<span style="color: #6666ff; font-weight: bold">1</span>);                               <span style="color: #666666; font-style: italic">/* blank the screen        */</span>
    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * The value here had been changed to 0x63, but seems to work</span>
<span style="color: #666666; font-style: italic">     * fine in QEMU (and VirtualPC, where I got it) with the 0x04</span>
<span style="color: #666666; font-style: italic">     * bit set (VGA_MIS_DCLK_28322_720).  </span>
<span style="color: #666666; font-style: italic">     */</span>
    set_seq_regs_and_reset (text_seq, <span style="color: #005588; font-weight: bold">0x67</span>);     <span style="color: #666666; font-style: italic">/* sequencer registers     */</span>
    set_CRTC_registers (text_CRTC);              <span style="color: #666666; font-style: italic">/* CRT control registers   */</span>
    set_attr_registers (text_attr);              <span style="color: #666666; font-style: italic">/* attribute registers     */</span>
    set_graphics_registers (text_graphics);      <span style="color: #666666; font-style: italic">/* graphics registers      */</span>
    fill_palette_text ();      <span style="color: #666666; font-style: italic">/* palette colors          */</span>
    <span style="color: #228899; font-weight: bold">if</span> (clear_scr) {         <span style="color: #666666; font-style: italic">/* clear screens if needed */</span>
  txt_scr <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span><span style="color: #333333">*</span>)(mem_image <span style="color: #333333">+</span> <span style="color: #005588; font-weight: bold">0x18000</span>); 
  <span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> <span style="color: #6666ff; font-weight: bold">8192</span>; i<span style="color: #333333">++</span>)
      <span style="color: #333333">*</span>txt_scr<span style="color: #333333">++</span> <span style="color: #333333">=</span> <span style="color: #005588; font-weight: bold">0x07200720</span>;
    }
    write_font_data ();                          <span style="color: #666666; font-style: italic">/* copy fonts to video mem */</span>
    VGA_blank (<span style="color: #6666ff; font-weight: bold">0</span>);               <span style="color: #666666; font-style: italic">/* unblank the screen      */</span>
}


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * copy_image</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Copy one plane of a screen from the build buffer to the </span>
<span style="color: #666666; font-style: italic"> *                video memory.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: img -- a pointer to a single screen plane in the build buffer</span>
<span style="color: #666666; font-style: italic"> *           scr_addr -- the destination offset in video memory</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: copies a plane from the build buffer to video memory</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">copy_image</span> (<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> img, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">short</span> scr_addr)
{
    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * memcpy is actually probably good enough here, and is usually</span>
<span style="color: #666666; font-style: italic">     * implemented using ISA-specific features like those below,</span>
<span style="color: #666666; font-style: italic">     * but the code here provides an example of x86 string moves</span>
<span style="color: #666666; font-style: italic">     */</span>
    asm <span style="color: #228899; font-weight: bold">volatile</span> (
        <span style="background-color: #e0e0ff">&quot;cld                                                 ;&quot;</span>
        <span style="background-color: #e0e0ff">&quot;movl $16000,%%ecx                                   ;&quot;</span>
        <span style="background-color: #e0e0ff">&quot;rep movsb    # copy ECX bytes from M[ESI] to M[EDI]  &quot;</span>
      <span style="color: #333333">:</span> <span style="color: #666666; font-style: italic">/* no outputs */</span>
      <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;S&quot;</span> (img), <span style="background-color: #e0e0ff">&quot;D&quot;</span> (mem_image <span style="color: #333333">+</span> scr_addr) 
      <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;eax&quot;</span>, <span style="background-color: #e0e0ff">&quot;ecx&quot;</span>, <span style="background-color: #e0e0ff">&quot;memory&quot;</span>
    );
}



<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * copy_status_bar</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Copy one group of 4 planes for status bar to the screen from the second build </span>
<span style="color: #666666; font-style: italic"> *                buffer of the double buffering technique to the video </span>
<span style="color: #666666; font-style: italic"> *                memory (the way the image is copied to the screen)</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: stat_bar -- pointer to one screen plane from second build buffer</span>
<span style="color: #666666; font-style: italic"> *           scr_addr -- destination offset in video memory</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: Adds a status bar on the screen</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">copy_status_bar</span>(<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> stat_bar)
{
  asm <span style="color: #228899; font-weight: bold">volatile</span> (
        <span style="background-color: #e0e0ff">&quot;cld                                                 ;&quot;</span>
        <span style="background-color: #e0e0ff">&quot;movl $1440,%%ecx                                   ;&quot;</span>
        <span style="background-color: #e0e0ff">&quot;rep movsb    # copy ECX bytes from M[ESI] to M[EDI]  &quot;</span>
      <span style="color: #333333">:</span> <span style="color: #666666; font-style: italic">/* no outputs */</span>
      <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;S&quot;</span> (stat_bar), <span style="background-color: #e0e0ff">&quot;D&quot;</span> (mem_image) 
      <span style="color: #333333">:</span> <span style="background-color: #e0e0ff">&quot;eax&quot;</span>, <span style="background-color: #e0e0ff">&quot;ecx&quot;</span>, <span style="background-color: #e0e0ff">&quot;memory&quot;</span>
    );
}<span style="color: #666666; font-style: italic">//end status bar</span>

<span style="color: #557799">#if defined(TEXT_RESTORE_PROGRAM)</span>




<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * main -- for the &quot;tr&quot; program</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Put the VGA into text mode 3 without clearing the screens,</span>
<span style="color: #666666; font-style: italic"> *                which serves as a useful debugging tool when trying to </span>
<span style="color: #666666; font-style: italic"> *                debug programs that rely on having the VGA in mode X for</span>
<span style="color: #666666; font-style: italic"> *                normal operation.  Writes font data to video memory.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none (command line arguments are ignored)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 0 on success, 3 in panic scenarios</span>
<span style="color: #666666; font-style: italic"> */</span>   
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">main</span> ()
{
    <span style="color: #666666; font-style: italic">/* Map video memory and obtain permission for VGA port access. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (open_memory_and_ports () <span style="color: #333333">==</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>)
        <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">3</span>;

    <span style="color: #666666; font-style: italic">/* Put VGA into text mode without clearing the screen. */</span>
    set_text_mode_3 (<span style="color: #6666ff; font-weight: bold">0</span>);

    <span style="color: #666666; font-style: italic">/* Unmap video memory. */</span> 
    (<span style="color: #6666ff; font-weight: bold">void</span>)munmap (mem_image, VID_MEM_SIZE);

    <span style="color: #666666; font-style: italic">/* Return success. */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}

<span style="color: #557799">#endif</span>
</pre></div>
<p></p>                
            </section>
        
        
            <!--modex.h-->
            <section>
            <hnew id="modex.h">modex.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * modex.h - header file for mode X 320x200 graphics</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2004-2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    4</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Thu Sep  9 23:08:21 2004</span>
<span style="color: #666666; font-style: italic"> * Filename:	    modex.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Thu Sep  9 23:08:21 2004</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sat Sep 12 13:35:41 2009</span>
<span style="color: #666666; font-style: italic"> *		Integrated original release back into main code base.</span>
<span style="color: #666666; font-style: italic"> *	SL	3	Sat Sep 10 20:40:18 2011</span>
<span style="color: #666666; font-style: italic"> *		Modified for MP2 F11 adventure game.</span>
<span style="color: #666666; font-style: italic"> *	SL	4	Sat Sep 14 16:26:25 2011</span>
<span style="color: #666666; font-style: italic"> *		Split fill_palette by mode and cleaned up code for release.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#ifndef MODEX_H</span>
<span style="color: #557799">#define MODEX_H</span>


<span style="color: #557799">#include &quot;text.h&quot;</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * IMAGE  is the whole screen in mode X: 320x200 pixels in our flavor.</span>
<span style="color: #666666; font-style: italic"> * SCROLL is the scrolling region of the screen.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * X_DIM   is a horizontal screen dimension in pixels.</span>
<span style="color: #666666; font-style: italic"> * X_WIDTH is a horizontal screen dimension in &#39;natural&#39; units</span>
<span style="color: #666666; font-style: italic"> *         (addresses, characters of text, etc.)</span>
<span style="color: #666666; font-style: italic"> * Y_DIM   is a vertical screen dimension in pixels.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#define IMAGE_X_DIM     320   </span><span style="color: #666666; font-style: italic">/* pixels; must be divisible by 4             */</span><span style="color: #557799"></span>
<span style="color: #557799">#define IMAGE_Y_DIM     182   </span><span style="color: #666666; font-style: italic">/* pixels; 200-18 from status bar             */</span><span style="color: #557799"></span>
<span style="color: #557799">#define IMAGE_X_WIDTH   (IMAGE_X_DIM / 4)          </span><span style="color: #666666; font-style: italic">/* addresses (bytes)     */</span><span style="color: #557799"></span>
<span style="color: #557799">#define SCROLL_X_DIM	IMAGE_X_DIM                </span><span style="color: #666666; font-style: italic">/* full image width      */</span><span style="color: #557799"></span>
<span style="color: #557799">#define SCROLL_Y_DIM    IMAGE_Y_DIM                </span><span style="color: #666666; font-style: italic">/* full image width      */</span><span style="color: #557799"></span>
<span style="color: #557799">#define SCROLL_X_WIDTH  (IMAGE_X_DIM / 4)          </span><span style="color: #666666; font-style: italic">/* addresses (bytes)     */</span><span style="color: #557799"></span>
<span style="color: #557799">#define STATUS_BAR_SCROLLSIZE 1440 </span><span style="color: #666666; font-style: italic">/* number of groups of four in the status bar 320*18/4 */</span><span style="color: #557799"></span>
<span style="color: #557799">#define STATUS_BAR_SIZE 5760 </span><span style="color: #666666; font-style: italic">/* total number of planes for entire scroll bar */</span><span style="color: #557799"></span>
<span style="color: #557799">#define STATUS_BAR_TXTSIZE 5120 	</span><span style="color: #666666; font-style: italic">// 320 * (18-2) because one line above, one line under </span>

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * NOTES</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Mode X is an (originally) undocumented variant of mode 13h, the first</span>
<span style="color: #666666; font-style: italic"> * IBM 256-color graphics mode.  Each pixel uses a single byte to specify</span>
<span style="color: #666666; font-style: italic"> * one of the 256 possible colors, and a palette is used to map each color</span>
<span style="color: #666666; font-style: italic"> * into an 18-bit space (6-bit red, green, and blue intensities).</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The map from memory as seen by the host processor is non-linear, and was</span>
<span style="color: #666666; font-style: italic"> * originally designed to allow high-performance hardware designs.  Video</span>
<span style="color: #666666; font-style: italic"> * memory is in words of 32 bits, and is divided into four planes.  In mode</span>
<span style="color: #666666; font-style: italic"> * X, groups of four pixels are mapped into a single host address and written</span>
<span style="color: #666666; font-style: italic"> * individually or together by setting a bit mask of planes to be written</span>
<span style="color: #666666; font-style: italic"> * (a VGA register).</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * each four pixels counts as one (one-byte) address -&gt;</span>
<span style="color: #666666; font-style: italic"> * 0123012301230123012301230123012301230123012301230123012301230123</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The mapping is more contorted than with mode 13h, but allows use of</span>
<span style="color: #666666; font-style: italic"> * graphics tricks such as double-buffering.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The design here is strongly influenced by the fact that we are running</span>
<span style="color: #666666; font-style: italic"> * in a virtual machine in which writes to video memory are exorbitantly</span>
<span style="color: #666666; font-style: italic"> * expensive.  In particular, writing a chunk of 16kB with a single x86</span>
<span style="color: #666666; font-style: italic"> * instruction (REP MOVSB) is much faster than writing two hundred bytes</span>
<span style="color: #666666; font-style: italic"> * with many instructions.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * That said, the design is not unreasonable, and is only slightly different</span>
<span style="color: #666666; font-style: italic"> * than was (and is) often used today.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Double-buffering uses two sections of memory to allow a program to</span>
<span style="color: #666666; font-style: italic"> * draw the next screen to be displayed without having the partially drawn</span>
<span style="color: #666666; font-style: italic"> * screen visible on the monitor (which causes flicker).  When the drawing</span>
<span style="color: #666666; font-style: italic"> * is complete, the video adapter is told to display the new screen instead</span>
<span style="color: #666666; font-style: italic"> * of the old one, and the memory used for the old screen is then used to</span>
<span style="color: #666666; font-style: italic"> * draw a third screen, the video adapter is switched back, and the process</span>
<span style="color: #666666; font-style: italic"> * starts again.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * In our variant of double-buffering, we use non-video memory as the</span>
<span style="color: #666666; font-style: italic"> * scratch pad, copy the drawn screen as a whole into one of two buffers</span>
<span style="color: #666666; font-style: italic"> * in video memory, and switch the picture between the two buffers.  The</span>
<span style="color: #666666; font-style: italic"> * cost of the copy is negligible; the cost of writing to video memory</span>
<span style="color: #666666; font-style: italic"> * instead is quite high (under most virtual machines).</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * In order to reduce drawing time, we reuse most of the screen data between</span>
<span style="color: #666666; font-style: italic"> * video frames.  New data are drawn only when the viewing window moves</span>
<span style="color: #666666; font-style: italic"> * within a logical space defined by the program.  For example, if this</span>
<span style="color: #666666; font-style: italic"> * window shifts one pixel to the left, only the left border of the screen</span>
<span style="color: #666666; font-style: italic"> * is drawn.  Other data are left untouched in most cases.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #666666; font-style: italic">/* configure VGA for mode X; initializes logical view to (0,0) */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">set_mode_X</span> (<span style="color: #6666ff; font-weight: bold">void</span> (<span style="color: #333333">*</span>horiz_fill_fn)
                            (<span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span>[SCROLL_X_DIM]),
		       <span style="color: #6666ff; font-weight: bold">void</span> (<span style="color: #333333">*</span>vert_fill_fn) 
		            (<span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">int</span>, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span>[SCROLL_Y_DIM]));

<span style="color: #666666; font-style: italic">/* return to text mode */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">clear_mode_X</span> ();

<span style="color: #666666; font-style: italic">/* set logical view window coordinates */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">set_view_window</span> (<span style="color: #6666ff; font-weight: bold">int</span> scr_x, <span style="color: #6666ff; font-weight: bold">int</span> scr_y);

<span style="color: #666666; font-style: italic">/* show the logical view window on the monitor */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">show_screen</span> ();

<span style="color: #666666; font-style: italic">/* show the status bar on the screen */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">show_status_bar</span> ();

<span style="color: #666666; font-style: italic">/* clear the video memory in mode X */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">clear_screens</span> ();

<span style="color: #666666; font-style: italic">/* draw a horizontal line at vertical pixel y within the logical view window */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">draw_horiz_line</span> (<span style="color: #6666ff; font-weight: bold">int</span> y);

<span style="color: #666666; font-style: italic">/* draw a vertical line at horizontal pixel x within the logical view window */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">draw_vert_line</span> (<span style="color: #6666ff; font-weight: bold">int</span> x);

<span style="color: #666666; font-style: italic">/* buffer to hold status bar content */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> status_bar_buffer[STATUS_BAR_SIZE];


<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* MODEX_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
            <!--Module-->
            <section>
            <hnew id="Module">Module</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <div align="center">
            
                    <a href="#tuxctl-ioctl.c"class="buttonInPage"> tuxctl-ioctl.c </a>
                    <a href="#tuxctl-ioctl.h"class="buttonInPage"> tuxctl-ioctl.h </a>
                    <a href="#tuxctl-ld.c"class="buttonInPage"> tuxctl-ld.c </a>
                    <a href="#tuxctl-ld.h"class="buttonInPage"> tuxctl-ld.h </a>
                    <a href="#MakefileMod"class="buttonInPage"> Makefile </a>
            
                </div>
                <p></p>
                
                
                
                
                
                
                
                <!--tuxctl-ioctl.c-->
                <section>
                <hnew style="margin-left: 40px" id="tuxctl-ioctl.c">tuxctl-ioctl.c</hnew><br>
                    <a style="margin-left: 40px" href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="margin-left: 40px;background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/* tuxctl-ioctl.c</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Driver (skeleton) for the mp2 tuxcontrollers for ECE391 at UIUC.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Mark Murphy 2006</span>
<span style="color: #666666; font-style: italic"> * Andrew Ofisher 2007</span>
<span style="color: #666666; font-style: italic"> * Steve Lumetta 12-13 Sep 2009</span>
<span style="color: #666666; font-style: italic"> * Puskar Naha 2013</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#include &lt;asm/current.h&gt;</span>
<span style="color: #557799">#include &lt;asm/uaccess.h&gt;</span>

<span style="color: #557799">#include &lt;linux/kernel.h&gt;</span>
<span style="color: #557799">#include &lt;linux/init.h&gt;</span>
<span style="color: #557799">#include &lt;linux/module.h&gt;</span>
<span style="color: #557799">#include &lt;linux/fs.h&gt;</span>
<span style="color: #557799">#include &lt;linux/sched.h&gt;</span>
<span style="color: #557799">#include &lt;linux/file.h&gt;</span>
<span style="color: #557799">#include &lt;linux/miscdevice.h&gt;</span>
<span style="color: #557799">#include &lt;linux/kdev_t.h&gt;</span>
<span style="color: #557799">#include &lt;linux/tty.h&gt;</span>
<span style="color: #557799">#include &lt;linux/spinlock.h&gt;</span>

<span style="color: #557799">#include &quot;tuxctl-ld.h&quot;</span>
<span style="color: #557799">#include &quot;tuxctl-ioctl.h&quot;</span>
<span style="color: #557799">#include &quot;mtcp.h&quot;</span>


<span style="color: #557799">#define debug(str, ...) \</span>
<span style="color: #557799">	printk(KERN_DEBUG &quot;%s: &quot; str, __FUNCTION__, ## __VA_ARGS__)</span>

<span style="color: #666666; font-style: italic">/*********************** GLOVAL VARIABLES *************************/</span>
<span style="color: #6666ff; font-weight: bold">int</span> error_flag <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
<span style="color: #6666ff; font-weight: bold">char</span> led_buffer[<span style="color: #6666ff; font-weight: bold">6</span>];
<span style="color: #6666ff; font-weight: bold">char</span> led[<span style="color: #6666ff; font-weight: bold">4</span>];
<span style="color: #6666ff; font-weight: bold">char</span> dp[<span style="color: #6666ff; font-weight: bold">4</span>];
<span style="color: #666666; font-style: italic">//values to be displayed are in hex so can be 0, 1, 2, 3, ...9 or A, B, ...F</span>
<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> possible_values_displayed[<span style="color: #6666ff; font-weight: bold">16</span>] <span style="color: #333333">=</span> {<span style="color: #005588; font-weight: bold">0xE7</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0xCB</span>, <span style="color: #005588; font-weight: bold">0x8F</span>, <span style="color: #005588; font-weight: bold">0x2E</span>, <span style="color: #005588; font-weight: bold">0xAD</span>, 
	<span style="color: #005588; font-weight: bold">0xED</span>, <span style="color: #005588; font-weight: bold">0x86</span>, <span style="color: #005588; font-weight: bold">0xEF</span>, <span style="color: #005588; font-weight: bold">0xAF</span>, <span style="color: #005588; font-weight: bold">0xEE</span>, <span style="color: #005588; font-weight: bold">0x6D</span>, <span style="color: #005588; font-weight: bold">0xE1</span>, <span style="color: #005588; font-weight: bold">0x4F</span>, <span style="color: #005588; font-weight: bold">0xE9</span>, <span style="color: #005588; font-weight: bold">0xE8</span>};

<span style="color: #666666; font-style: italic">//creating a lock for acknowledge</span>
<span style="color: #228899; font-weight: bold">struct</span> acknowledge_stat
{
	<span style="color: #6666ff; font-weight: bold">spinlock_t</span> lock_cmd_success;
	<span style="color: #6666ff; font-weight: bold">int</span> cmd_success_flag;
};
<span style="color: #666666; font-style: italic">//initializing lock</span>
<span style="color: #228899; font-weight: bold">struct</span> acknowledge_stat acknowledge_cmd <span style="color: #333333">=</span> {
	.lock_cmd_success <span style="color: #333333">=</span> SPIN_LOCK_UNLOCKED,
	.cmd_success_flag <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>,
};


<span style="color: #666666; font-style: italic">//creating a lock for button status</span>
<span style="color: #228899; font-weight: bold">struct</span> button_from_tuxctl
{
	<span style="color: #6666ff; font-weight: bold">spinlock_t</span> lock_buttons_status;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> buttons;
};
<span style="color: #666666; font-style: italic">//initializing lock</span>
<span style="color: #228899; font-weight: bold">struct</span> button_from_tuxctl tuxctl_button_stat <span style="color: #333333">=</span> {
	.lock_buttons_status <span style="color: #333333">=</span> SPIN_LOCK_UNLOCKED,
	.buttons <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>,
};


<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> occupied <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> led_arg;

<span style="color: #666666; font-style: italic">/*********************** FUNCTIONS IMPLEMENTED *************************/</span>
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ioctl_tux_init</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span> tty);
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ioctl_tux_buttons</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span> tty, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> arg);
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ioctl_tux_set_led</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span> tty, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> arg);
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_handle_button</span>(<span style="color: #6666ff; font-weight: bold">unsigned</span> b, <span style="color: #6666ff; font-weight: bold">unsigned</span> c);

<span style="color: #666666; font-style: italic">/*********************** Protocol Implementation *************************/</span>

<span style="color: #666666; font-style: italic">/* tuxctl_handle_packet()</span>
<span style="color: #666666; font-style: italic"> * IMPORTANT : Read the header for tuxctl_ldisc_data_callback() in </span>
<span style="color: #666666; font-style: italic"> * tuxctl-ld.c. It calls this function, so all warnings there apply </span>
<span style="color: #666666; font-style: italic"> * here as well.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">tuxctl_handle_packet</span> (<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span> tty, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> packet)
{
    <span style="color: #6666ff; font-weight: bold">unsigned</span> a, b, c;

    <span style="color: #666666; font-style: italic">//check if already taking care of a case, in which case, return and call back later</span>
    <span style="color: #228899; font-weight: bold">if</span> (occupied <span style="color: #333333">==</span> <span style="color: #6666ff; font-weight: bold">1</span>)
    {
    	<span style="color: #228899; font-weight: bold">return</span>;
    }<span style="color: #666666; font-style: italic">//end if</span>

    a <span style="color: #333333">=</span> packet[FIRST_ARG]; <span style="color: #666666; font-style: italic">/* Avoid printk() sign extending the 8-bit */</span>
    b <span style="color: #333333">=</span> packet[SCD_ARG]; <span style="color: #666666; font-style: italic">/* values when printing them. */</span>
    c <span style="color: #333333">=</span> packet[THIRD_ARG];

    <span style="color: #228899; font-weight: bold">switch</span>(a)
    {
    	<span style="color: #666666; font-style: italic">/*case MTCP_ERROR:</span>
<span style="color: #666666; font-style: italic">    		error_flag = 1;</span>
<span style="color: #666666; font-style: italic">    		return;*/</span>

    	<span style="color: #228899; font-weight: bold">case</span> MTCP_ACK:
    		spin_lock(acknowledge_cmd.lock_cmd_success);
    		acknowledge_cmd.cmd_success_flag <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;
    		spin_unlock(acknowledge_cmd.lock_cmd_success);
    		<span style="color: #228899; font-weight: bold">return</span>;

    	<span style="color: #228899; font-weight: bold">case</span> MTCP_RESET:
    		tuxctl_ioctl_tux_init(tty);
    		tuxctl_ioctl_tux_set_led(tty, led_arg);
    		<span style="color: #228899; font-weight: bold">return</span>;

    	<span style="color: #228899; font-weight: bold">case</span> MTCP_BIOC_EVENT:
    		<span style="color: #666666; font-style: italic">//occupied works like a lock not to do several things at the same time</span>
    		occupied <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;

    		tuxctl_handle_button(b, c);

    		occupied <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    		<span style="color: #228899; font-weight: bold">return</span>;

    	<span style="color: #997700; font-weight: bold">default:</span>
    		<span style="color: #228899; font-weight: bold">return</span>;
    }<span style="color: #666666; font-style: italic">//end switch a</span>

    <span style="color: #666666; font-style: italic">/*printk(&quot;packet : %x %x %x\n&quot;, a, b, c); */</span>
}

<span style="color: #666666; font-style: italic">/******** IMPORTANT NOTE: READ THIS BEFORE IMPLEMENTING THE IOCTLS ************</span>
<span style="color: #666666; font-style: italic"> *                                                                            *</span>
<span style="color: #666666; font-style: italic"> * The ioctls should not spend any time waiting for responses to the commands *</span>
<span style="color: #666666; font-style: italic"> * they send to the controller. The data is sent over the serial line at      *</span>
<span style="color: #666666; font-style: italic"> * 9600 BAUD. At this rate, a byte takes approximately 1 millisecond to       *</span>
<span style="color: #666666; font-style: italic"> * transmit; this means that there will be about 9 milliseconds between       *</span>
<span style="color: #666666; font-style: italic"> * the time you request that the low-level serial driver send the             *</span>
<span style="color: #666666; font-style: italic"> * 6-byte SET_LEDS packet and the time the 3-byte ACK packet finishes         *</span>
<span style="color: #666666; font-style: italic"> * arriving. This is far too long a time for a system call to take. The       *</span>
<span style="color: #666666; font-style: italic"> * ioctls should return immediately with success if their parameters are      *</span>
<span style="color: #666666; font-style: italic"> * valid.                                                                     *</span>
<span style="color: #666666; font-style: italic"> *                                                                            *</span>
<span style="color: #666666; font-style: italic"> ******************************************************************************/</span>
<span style="color: #6666ff; font-weight: bold">int</span> 
<span style="color: #55eedd; font-weight: bold">tuxctl_ioctl</span> (<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span> tty, <span style="color: #228899; font-weight: bold">struct</span> file<span style="color: #333333">*</span> file, 
	      <span style="color: #6666ff; font-weight: bold">unsigned</span> cmd, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> arg)
{
    <span style="color: #228899; font-weight: bold">switch</span> (cmd) 
    {
		<span style="color: #228899; font-weight: bold">case</span> TUX_INIT:
			<span style="color: #228899; font-weight: bold">return</span> tuxctl_ioctl_tux_init(tty);

		<span style="color: #228899; font-weight: bold">case</span> TUX_BUTTONS:
			<span style="color: #228899; font-weight: bold">return</span> tuxctl_ioctl_tux_buttons(tty, arg);

		<span style="color: #228899; font-weight: bold">case</span> TUX_SET_LED:
			<span style="color: #228899; font-weight: bold">return</span> tuxctl_ioctl_tux_set_led(tty, arg);

		<span style="color: #228899; font-weight: bold">case</span> TUX_LED_ACK:
			<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;

		<span style="color: #228899; font-weight: bold">case</span> TUX_LED_REQUEST:
			<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;

		<span style="color: #228899; font-weight: bold">case</span> TUX_READ_LED:
			<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;

		<span style="color: #997700; font-weight: bold">default:</span>
	    	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span>EINVAL;
    }
}

<span style="color: #666666; font-style: italic">/*function: tuxctl_ioctl_tux_init</span>
<span style="color: #666666; font-style: italic"> *description: this function is called whenever the driver needs</span>
<span style="color: #666666; font-style: italic"> *				to be intialized or reset. Initializes variables </span>
<span style="color: #666666; font-style: italic"> *				associated to the driver.</span>
<span style="color: #666666; font-style: italic"> *input: tty</span>
<span style="color: #666666; font-style: italic"> *output: none</span>
<span style="color: #666666; font-style: italic"> *return value: returns 0</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ioctl_tux_init</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span> tty)
{
	<span style="color: #666666; font-style: italic">//creating a buffer to hold </span>
	<span style="color: #6666ff; font-weight: bold">char</span> hold_init_mtcp[HOLD_INIT_MTCP_SIZE	];
	led_arg <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;


	spin_lock(acknowledge_cmd.lock_cmd_success);
	acknowledge_cmd.cmd_success_flag <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	spin_unlock(acknowledge_cmd.lock_cmd_success);


	<span style="color: #666666; font-style: italic">//enabling the button interrupt-on-change and putting LED display to user mode</span>
	hold_init_mtcp[HOLD_INIT_MTCP_FIRST] <span style="color: #333333">=</span> MTCP_BIOC_ON;
	hold_init_mtcp[HOLD_INIT_MTCP_SEC] <span style="color: #333333">=</span> MTCP_LED_USR;
	tuxctl_ldisc_put(tty, hold_init_mtcp, HOLD_INIT_MTCP_SIZE	);


	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}<span style="color: #666666; font-style: italic">//end tuxctl_ioctl_tux_init</span>


<span style="color: #666666; font-style: italic">/*function: tuxctl_ioctl_tux_buttons</span>
<span style="color: #666666; font-style: italic"> *description: this function is called ___________</span>
<span style="color: #666666; font-style: italic"> *				</span>
<span style="color: #666666; font-style: italic"> *				</span>
<span style="color: #666666; font-style: italic"> *input: tty, arg which holds the info to use for the TUX</span>
<span style="color: #666666; font-style: italic"> *output: none</span>
<span style="color: #666666; font-style: italic"> *return value: returns 0</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ioctl_tux_buttons</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span> tty, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> arg)
{
	<span style="color: #6666ff; font-weight: bold">long</span> flags;
	<span style="color: #6666ff; font-weight: bold">int</span> check_val;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> but_ptr;
	but_ptr <span style="color: #333333">=</span> <span style="color: #333333">~</span>(tuxctl_button_stat.buttons); 

	<span style="color: #666666; font-style: italic">// getting lock and saving flags</span>
	spin_lock_irqsave(<span style="color: #333333">&amp;</span>(tuxctl_button_stat.lock_buttons_status), flags);

	check_val <span style="color: #333333">=</span> copy_to_user((<span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #333333">*</span>) arg, <span style="color: #333333">&amp;</span>but_ptr, <span style="color: #6666ff; font-weight: bold">1</span>);

	<span style="color: #666666; font-style: italic">// releasing lock and restoring flags</span>
	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>(tuxctl_button_stat.lock_buttons_status), flags);

	<span style="color: #228899; font-weight: bold">if</span>(check_val <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span>)
	{
		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span>EFAULT;
	}<span style="color: #666666; font-style: italic">//end if</span>

	<span style="color: #228899; font-weight: bold">else</span> 
	{
		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}<span style="color: #666666; font-style: italic">//end else</span>
}<span style="color: #666666; font-style: italic">//end tuxctl_ioctl_tux_buttons</span>


<span style="color: #666666; font-style: italic">/*function: tuxctl_ioctl_tux_set_led</span>
<span style="color: #666666; font-style: italic"> *description: this function is called whenever the LED&#39;s are set</span>
<span style="color: #666666; font-style: italic"> *				to a new &quot;value&quot; to display. Gets which leds are on</span>
<span style="color: #666666; font-style: italic"> *				and which dp&#39;s are on.</span>
<span style="color: #666666; font-style: italic"> *input: tty, arg which holds info from TUX LED&#39;s</span>
<span style="color: #666666; font-style: italic"> *output: right values on TUX LED&#39;s</span>
<span style="color: #666666; font-style: italic"> *return value: returns 0</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ioctl_tux_set_led</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span> tty, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> arg)
{
		<span style="color: #6666ff; font-weight: bold">int</span> led_on;
		<span style="color: #6666ff; font-weight: bold">int</span> i;
		
		<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> values_to_be_displayed[TOT_LED];
		<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> mask <span style="color: #333333">=</span> TUX_SET_LED_MASK; 	<span style="color: #666666; font-style: italic">//will move to x00F0, x0F00, xF000 to get each value to display</span>


		led[FIRST_ARG]<span style="color: #333333">=</span> led[SCD_ARG] <span style="color: #333333">=</span> led[THIRD_ARG] <span style="color: #333333">=</span> led[FOURTH_ARG] <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		dp[FIRST_ARG] <span style="color: #333333">=</span> dp[SCD_ARG] <span style="color: #333333">=</span> dp[THIRD_ARG] <span style="color: #333333">=</span> dp[FOURTH_ARG] <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

		spin_lock(acknowledge_cmd.lock_cmd_success);
		<span style="color: #228899; font-weight: bold">if</span>(acknowledge_cmd.cmd_success_flag <span style="color: #333333">==</span> <span style="color: #6666ff; font-weight: bold">0</span>)
		{			
			spin_unlock(acknowledge_cmd.lock_cmd_success);
			<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">1</span>;
		}

		acknowledge_cmd.cmd_success_flag <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		spin_unlock(acknowledge_cmd.lock_cmd_success);

		<span style="color: #666666; font-style: italic">//getting the values to be displayed for each LED</span>
		<span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> TOT_LED; i<span style="color: #333333">++</span>)
		{
			values_to_be_displayed[i] <span style="color: #333333">=</span> (arg <span style="color: #333333">&amp;</span> mask) <span style="color: #333333">&gt;&gt;</span> (MOVE_FOUR <span style="color: #333333">*</span> i);
			mask <span style="color: #333333">=</span> mask <span style="color: #333333">&lt;&lt;</span> MOVE_FOUR;
		}<span style="color: #666666; font-style: italic">//end for i</span>

		<span style="color: #666666; font-style: italic">//getting value for each LED (on or off)</span>
		led[FIRST_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_FIRST_ARG_LED) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;
		led[SCD_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_SCD_ARG_LED) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;
		led[THIRD_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_THIRD_ARG_LED) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;
		led[FOURTH_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_FOURTH_ARG_LED) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;

		<span style="color: #666666; font-style: italic">//led_buffer[1] = 0;</span>
		led_buffer[SCD_ARG] <span style="color: #333333">=</span> (led[FOURTH_ARG] <span style="color: #333333">&lt;&lt;</span> SHIFT_THREE) <span style="color: #333333">|</span> (led[THIRD_ARG] <span style="color: #333333">&lt;&lt;</span> SHIFT_TWO) 
								<span style="color: #333333">|</span> (led[SCD_ARG] <span style="color: #333333">&lt;&lt;</span> SHIFT_ONE) <span style="color: #333333">|</span> led[FIRST_ARG];	<span style="color: #666666; font-style: italic">//getting what LED&#39;s are on </span>

		<span style="color: #666666; font-style: italic">//getting value for each decimal point (on or off)</span>
		dp[FIRST_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_FIRST_ARG_DP) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;
		dp[SCD_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_SCD_ARG_DP) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;
		dp[THIRD_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_THIRD_ARG_DP) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;
		dp[FOURTH_ARG] <span style="color: #333333">=</span> (arg <span style="color: #333333">&gt;&gt;</span> SHIFT_FOURTH_ARG_DP) <span style="color: #333333">&amp;</span> CHECK_ON_SHIFT;

		<span style="color: #666666; font-style: italic">//initializing buffer to display info we got from arg</span>
		led_buffer[FIRST_ARG] <span style="color: #333333">=</span> MTCP_LED_SET;					<span style="color: #666666; font-style: italic">//getting the values to actually display on TUX</span>
		led_buffer[SCD_ARG] <span style="color: #333333">=</span> ALL_LEDS_ON; 						<span style="color: #666666; font-style: italic">// all LED&#39;s will be on if needed</span>
		
		led_on <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;									<span style="color: #666666; font-style: italic">//value incremented when there is a value to display</span>

		<span style="color: #228899; font-weight: bold">for</span> (i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> TOT_LED; i<span style="color: #333333">++</span>)
		{
			<span style="color: #228899; font-weight: bold">if</span> (led[i] <span style="color: #333333">==</span> <span style="color: #6666ff; font-weight: bold">1</span>)
			{
				<span style="color: #666666; font-style: italic">//setting the values to be displayed</span>
				values_to_be_displayed[i] <span style="color: #333333">=</span> possible_values_displayed[values_to_be_displayed[i]];

				<span style="color: #666666; font-style: italic">//checking if dp has to be on </span>
				<span style="color: #228899; font-weight: bold">if</span> (dp[i] <span style="color: #333333">==</span> <span style="color: #6666ff; font-weight: bold">1</span>)
				{
					values_to_be_displayed[i] <span style="color: #333333">=</span> values_to_be_displayed[i] <span style="color: #333333">|</span> DP_MASK;
				}<span style="color: #666666; font-style: italic">//end if dp</span>

				<span style="color: #666666; font-style: italic">//incrementing led_on if there actually is value to display</span>
				<span style="color: #228899; font-weight: bold">if</span>(values_to_be_displayed[i] <span style="color: #333333">!=</span> <span style="color: #6666ff; font-weight: bold">0</span>)
				{
					led_on<span style="color: #333333">++</span>;
				}<span style="color: #666666; font-style: italic">//end if led_on</span>

				led_buffer[<span style="color: #6666ff; font-weight: bold">2</span><span style="color: #333333">+</span>i] <span style="color: #333333">=</span> values_to_be_displayed[i];
			}<span style="color: #666666; font-style: italic">//end if</span>

			<span style="color: #228899; font-weight: bold">else</span>
			{
				led_buffer[<span style="color: #6666ff; font-weight: bold">2</span><span style="color: #333333">+</span>i] <span style="color: #333333">=</span> BUF_ZERO;
			}<span style="color: #666666; font-style: italic">//end else</span>
			
		}<span style="color: #666666; font-style: italic">//end for</span>

		led_arg <span style="color: #333333">=</span> arg;

		<span style="color: #666666; font-style: italic">//calling ldisc_put function to display</span>
		tuxctl_ldisc_put(tty, led_buffer, TOT_BUF_SIZE);

		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
		
}<span style="color: #666666; font-style: italic">//end tuxctl_ioctl_tux_set_led</span>


<span style="color: #666666; font-style: italic">/*function: tuxctl_handle_button</span>
<span style="color: #666666; font-style: italic"> *description: this function is called to get what buttons are </span>
<span style="color: #666666; font-style: italic"> *				pressed.</span>
<span style="color: #666666; font-style: italic"> *input: tty, arg which holds info from TUX LED&#39;s</span>
<span style="color: #666666; font-style: italic"> *output: none</span>
<span style="color: #666666; font-style: italic"> *return value: returns 0</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_handle_button</span>(<span style="color: #6666ff; font-weight: bold">unsigned</span> b, <span style="color: #6666ff; font-weight: bold">unsigned</span> c)
{
	<span style="color: #6666ff; font-weight: bold">long</span> flags;

	<span style="color: #666666; font-style: italic">// getting lock and saving flags</span>
	spin_lock_irqsave(<span style="color: #333333">&amp;</span>(tuxctl_button_stat.lock_buttons_status), flags);

	tuxctl_button_stat.buttons <span style="color: #333333">=</span> (b <span style="color: #333333">&amp;</span> ALL_BUTTONS_ON) <span style="color: #333333">|</span> ((((c <span style="color: #333333">&amp;</span> ALL_BUTTONS_ON) <span style="color: #333333">&lt;&lt;</span> MOVE_FOUR)) <span style="color: #333333">&amp;</span> GET_RxxUCBAS_MASK) 
									<span style="color: #333333">|</span> (((c <span style="color: #333333">&amp;</span> GET_L_MASK) <span style="color: #333333">&lt;&lt;</span> MOVE_FIVE)) <span style="color: #333333">|</span> (((c <span style="color: #333333">&amp;</span> GET_D_MASK) <span style="color: #333333">&lt;&lt;</span> MOVE_THREE));

	<span style="color: #666666; font-style: italic">// releasing lock and restoring flags</span>
	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>(tuxctl_button_stat.lock_buttons_status), flags);

	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;

}<span style="color: #666666; font-style: italic">//end tuxctl handle button</span>
</pre></div>
<p></p>
                
                </section>
                
                
                
                
                
                
                
                
                <!--tuxctl-ioctl.h-->
                <section>
                <hnew style="margin-left: 40px" id="tuxctl-ioctl.h">tuxctl-ioctl.h</hnew><br>
                    <a style="margin-left: 40px" href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="margin-left: 40px;background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">// All necessary declarations for the Tux Controller driver must be in this file</span>

<span style="color: #557799">#ifndef TUXCTL_H</span>
<span style="color: #557799">#define TUXCTL_H</span>

<span style="color: #557799">#define TUX_SET_LED _IOR(&#39;E&#39;, 0x10, unsigned long)</span>
<span style="color: #557799">#define TUX_READ_LED _IOW(&#39;E&#39;, 0x11, unsigned long*)</span>
<span style="color: #557799">#define TUX_BUTTONS _IOW(&#39;E&#39;, 0x12, unsigned long*)</span>
<span style="color: #557799">#define TUX_INIT _IO(&#39;E&#39;, 0x13)</span>
<span style="color: #557799">#define TUX_LED_REQUEST _IO(&#39;E&#39;, 0x14)</span>
<span style="color: #557799">#define TUX_LED_ACK _IO(&#39;E&#39;, 0x15)</span>

<span style="color: #557799">#define HOLD_INIT_MTCP_SIZE		2</span>
<span style="color: #557799">#define HOLD_INIT_MTCP_FIRST	0</span>
<span style="color: #557799">#define HOLD_INIT_MTCP_SEC		1</span>

<span style="color: #557799">#define TUX_SET_LED_MASK		0x000F</span>

<span style="color: #557799">#define TOT_LED					4</span>
<span style="color: #557799">#define FIRST_ARG				0</span>
<span style="color: #557799">#define SCD_ARG					1</span>
<span style="color: #557799">#define THIRD_ARG				2</span>
<span style="color: #557799">#define FOURTH_ARG				3</span>

<span style="color: #557799">#define SHIFT_FIRST_ARG_LED		16		</span>
<span style="color: #557799">#define SHIFT_SCD_ARG_LED		17	</span>
<span style="color: #557799">#define SHIFT_THIRD_ARG_LED		18		</span>
<span style="color: #557799">#define SHIFT_FOURTH_ARG_LED	19	</span>

<span style="color: #557799">#define SHIFT_FIRST_ARG_DP		24		</span>
<span style="color: #557799">#define SHIFT_SCD_ARG_DP		25	</span>
<span style="color: #557799">#define SHIFT_THIRD_ARG_DP		26		</span>
<span style="color: #557799">#define SHIFT_FOURTH_ARG_DP		27	</span>

<span style="color: #557799">#define CHECK_ON_SHIFT			0x1</span>

<span style="color: #557799">#define MOVE_THREE				3</span>
<span style="color: #557799">#define MOVE_FOUR 				4</span>
<span style="color: #557799">#define MOVE_FIVE				5</span>

<span style="color: #557799">#define SHIFT_THREE				3</span>
<span style="color: #557799">#define SHIFT_TWO				2</span>
<span style="color: #557799">#define SHIFT_ONE				1</span>

<span style="color: #557799">#define ALL_LEDS_ON				0x0F</span>

<span style="color: #557799">#define DP_MASK					0x10</span>

<span style="color: #557799">#define BUF_ZERO				0x00</span>

<span style="color: #557799">#define ALL_BUTTONS_ON			0x0F</span>

<span style="color: #557799">#define GET_RxxUCBAS_MASK		0x9F</span>
<span style="color: #557799">#define GET_L_MASK				0x02</span>
<span style="color: #557799">#define GET_D_MASK				0x04</span>

<span style="color: #557799">#define TOT_BUF_SIZE			6</span>

<span style="color: #557799">#endif</span>
</pre></div>
<p></p>
                
                </section>
                
                
                
                
                
                
                
                <!--tuxctl-ld.c-->
                <section>
                <hnew style="margin-left: 40px" id="tuxctl-ld.c">tuxctl-ld.c</hnew><br>
                    <a style="margin-left: 40px" href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="margin-left: 40px;background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/* tuxctl-ld.c</span>
<span style="color: #666666; font-style: italic"> * The line discipline for the MP2 Tuxcontroller wrapper. </span>
<span style="color: #666666; font-style: italic"> * Mark Murphy 2006</span>
<span style="color: #666666; font-style: italic"> * Andrew Ofisher 2007</span>
<span style="color: #666666; font-style: italic"> * Puskar Naha 2013</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#include &lt;linux/tty.h&gt;</span>
<span style="color: #557799">#include &lt;linux/tty_ldisc.h&gt;</span>

<span style="color: #557799">#include &lt;linux/slab.h&gt;</span>
<span style="color: #557799">#include &lt;linux/kernel.h&gt;</span>
<span style="color: #557799">#include &lt;linux/spinlock.h&gt;</span>

<span style="color: #557799">#include &lt;linux/init.h&gt;</span>
<span style="color: #557799">#include &quot;tuxctl-ld.h&quot;</span>

<span style="color: #557799">#define uhoh(str, ...) printk(KERN_EMERG &quot;%s &quot; str, __FUNCTION__, ##__VA_ARGS__)</span>
<span style="color: #557799">#define debug(str, ...) printk(KERN_DEBUG &quot;%s &quot; str, __FUNCTION__,\</span>
<span style="color: #557799">							 ## __VA_ARGS__)</span>

<span style="color: #666666; font-style: italic">/* Here&#39;s an interesting tidbit: tty_struct has no synchronization available</span>
<span style="color: #666666; font-style: italic"> * to us to protect against races involving the tty-&gt;disc_data field. So,</span>
<span style="color: #666666; font-style: italic"> * rather than do something tricky, we&#39;ll employ the &#39;one-big-freakin-lock&#39;</span>
<span style="color: #666666; font-style: italic"> * strategy for synchronizing the methods in this file. This can&#39;t be a</span>
<span style="color: #666666; font-style: italic"> * semaphore because of the following chain of function calls:</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * rs_interrupt()  				(serial.c)</span>
<span style="color: #666666; font-style: italic"> *	tty_flip_buffer_push() 			(tty_io.c)</span>
<span style="color: #666666; font-style: italic"> * 		flush_to_ldisc() 		(tty_io.c)</span>
<span style="color: #666666; font-style: italic"> *			ldisc.receive_buf() 	(this file)</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Specifically, rs_interrupt is, well, an interrupt. Sleeping in an </span>
<span style="color: #666666; font-style: italic"> * interrupt is a recipe for breaking things, so a spinlock it is.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">spinlock_t</span> tuxctl_ldisc_lock <span style="color: #333333">=</span> SPIN_LOCK_UNLOCKED;


<span style="color: #666666; font-style: italic">/* Line Discipline specific stuff */</span>
<span style="color: #557799">#define TUXCTL_MAGIC 0x74757863</span>

<span style="color: #557799">#define sanity(data) if((data)-&gt;magic != TUXCTL_MAGIC){\</span>
<span style="color: #557799">			uhoh(&quot;MAGIC MISMATCH!\n&quot;);\</span>
<span style="color: #557799">			BUG();}</span>
			

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_open</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_close</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_rcv_buf</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span>, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>, 
					<span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>, <span style="color: #6666ff; font-weight: bold">int</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_write_wakeup</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span>);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_data_callback</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty);

<span style="color: #557799">#define TUXCTL_BUFSIZE 64</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> tuxctl_ldisc_data {
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> magic;

	<span style="color: #6666ff; font-weight: bold">char</span> rx_buf[TUXCTL_BUFSIZE];
	<span style="color: #6666ff; font-weight: bold">int</span> rx_start, rx_end;

	<span style="color: #6666ff; font-weight: bold">char</span> tx_buf[TUXCTL_BUFSIZE];
	<span style="color: #6666ff; font-weight: bold">int</span> tx_start, tx_end;

} <span style="color: #6666ff; font-weight: bold">tuxctl_ldisc_data_t</span>;


<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">struct</span> tty_ldisc tuxctl_ldisc  <span style="color: #333333">=</span> {
	.magic <span style="color: #333333">=</span> TUXCTL_MAGIC,
	.name <span style="color: #333333">=</span> <span style="background-color: #e0e0ff">&quot;tuxcontroller&quot;</span>,
	.open <span style="color: #333333">=</span> tuxctl_ldisc_open,
	.close <span style="color: #333333">=</span> tuxctl_ldisc_close,
        .ioctl <span style="color: #333333">=</span> tuxctl_ioctl,
	.receive_buf <span style="color: #333333">=</span> tuxctl_ldisc_rcv_buf,
	.write_wakeup <span style="color: #333333">=</span> tuxctl_ldisc_write_wakeup,
};

<span style="color: #6666ff; font-weight: bold">int</span> __init
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_init</span>(<span style="color: #6666ff; font-weight: bold">void</span>)
{
	<span style="color: #6666ff; font-weight: bold">int</span> err <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	<span style="color: #228899; font-weight: bold">if</span>((err <span style="color: #333333">=</span> tty_register_ldisc(N_MOUSE, <span style="color: #333333">&amp;</span>tuxctl_ldisc))){
		debug(<span style="background-color: #e0e0ff">&quot;tuxctl line discipline register failed</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>);
	}<span style="color: #228899; font-weight: bold">else</span>{
		printk(<span style="background-color: #e0e0ff">&quot;tuxctl line discipline registered</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>);
	}
	<span style="color: #228899; font-weight: bold">return</span> err;
}
module_init(tuxctl_ldisc_init);

<span style="color: #6666ff; font-weight: bold">void</span> __exit
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_exit</span>(<span style="color: #6666ff; font-weight: bold">void</span>)
{
	tty_unregister_ldisc(N_MOUSE);
	printk(<span style="background-color: #e0e0ff">&quot;tuxctl line discipline removed</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>);
}
module_exit(tuxctl_ldisc_exit);


<span style="color: #557799">#define buf_used(start,end) ((start) &lt;= (end) ? \</span>
<span style="color: #557799">				  ((end) - (start))  \</span>
<span style="color: #557799">				: (TUXCTL_BUFSIZE + (end) - (start)))</span>

<span style="color: #557799">#define buf_room(start,end) (TUXCTL_BUFSIZE - buf_used(start,end) - 1)</span>

<span style="color: #557799">#define buf_empty(start, end) ((start) == (end))</span>
<span style="color: #557799">#define buf_full(start, end) ((((end)+1)%TUXCTL_BUFSIZE) == (start))</span>
<span style="color: #557799">#define buf_incidx(idx) ((idx) = ((idx)+1) % TUXCTL_BUFSIZE)</span>


<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> 
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_open</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty)
{
	<span style="color: #6666ff; font-weight: bold">tuxctl_ldisc_data_t</span> <span style="color: #333333">*</span>data;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> flags;

	<span style="color: #228899; font-weight: bold">if</span>(<span style="color: #333333">!</span>(data <span style="color: #333333">=</span> kmalloc(<span style="color: #228899; font-weight: bold">sizeof</span>(<span style="color: #333333">*</span>data), GFP_KERNEL))){
		uhoh(<span style="background-color: #e0e0ff">&quot;kmalloc failed!</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>);
		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">-</span>ENOMEM;
	}
	
	spin_lock_irqsave(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	data<span style="color: #333333">-&gt;</span>magic <span style="color: #333333">=</span> TUXCTL_MAGIC;

	data<span style="color: #333333">-&gt;</span>rx_start <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	data<span style="color: #333333">-&gt;</span>rx_end <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

	data<span style="color: #333333">-&gt;</span>tx_start <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	data<span style="color: #333333">-&gt;</span>tx_end <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	tty<span style="color: #333333">-&gt;</span>disc_data <span style="color: #333333">=</span> data;

	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
}

<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_close</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty)
{
	<span style="color: #6666ff; font-weight: bold">tuxctl_ldisc_data_t</span> <span style="color: #333333">*</span>data; 
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> flags;

	spin_lock_irqsave(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	data <span style="color: #333333">=</span> tty<span style="color: #333333">-&gt;</span>disc_data;
	tty<span style="color: #333333">-&gt;</span>disc_data <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	kfree(data);
}


<span style="color: #666666; font-style: italic">/* tuxctl_ldisc_rcv_buf</span>
<span style="color: #666666; font-style: italic"> * The receive_buf() method of our line discipline. It receives count bytes</span>
<span style="color: #666666; font-style: italic"> * from cp. fp points to some flag/error bytes which I conveniently ignore. </span>
<span style="color: #666666; font-style: italic"> * This is called when there are bytes received from the serial driver, and</span>
<span style="color: #666666; font-style: italic"> * is called from an interrupt handler.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_rcv_buf</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>cp, 
			<span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>fp, <span style="color: #6666ff; font-weight: bold">int</span> count)
{
	<span style="color: #6666ff; font-weight: bold">int</span> call <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>, c<span style="color: #333333">=</span><span style="color: #6666ff; font-weight: bold">0</span>;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> flags;
	<span style="color: #6666ff; font-weight: bold">tuxctl_ldisc_data_t</span> <span style="color: #333333">*</span>data;

	spin_lock_irqsave(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);
	<span style="color: #228899; font-weight: bold">if</span>(<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> (data <span style="color: #333333">=</span> tty<span style="color: #333333">-&gt;</span>disc_data)){
		call <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;

		<span style="color: #228899; font-weight: bold">while</span>(count<span style="color: #333333">--</span> <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>buf_full(data<span style="color: #333333">-&gt;</span>rx_start, data<span style="color: #333333">-&gt;</span>rx_end)) {
			data<span style="color: #333333">-&gt;</span>rx_buf[data<span style="color: #333333">-&gt;</span>rx_end] <span style="color: #333333">=</span> <span style="color: #333333">*</span>cp<span style="color: #333333">++</span>;
			buf_incidx(data<span style="color: #333333">-&gt;</span>rx_end);
			c<span style="color: #333333">++</span>;
		}
	}

	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	<span style="color: #228899; font-weight: bold">if</span>(call){
		tuxctl_ldisc_data_callback(tty);
	}
}

<span style="color: #666666; font-style: italic">/* tuxctl_ldisc_write_wakeup()</span>
<span style="color: #666666; font-style: italic"> * Called by the lower level serial driver when it can accept more </span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_write_wakeup</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty)
{
	<span style="color: #6666ff; font-weight: bold">tuxctl_ldisc_data_t</span> <span style="color: #333333">*</span>data;
	<span style="color: #6666ff; font-weight: bold">int</span> sent, n <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>, room;
	<span style="color: #6666ff; font-weight: bold">char</span> buf[TUXCTL_BUFSIZE];
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> flags;

	<span style="color: #666666; font-style: italic">/* I hope that this doesn&#39;t need synchronization. */</span>
	room <span style="color: #333333">=</span> tty<span style="color: #333333">-&gt;</span>driver<span style="color: #333333">-&gt;</span>write_room(tty);
	
	spin_lock_irqsave(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);
	data <span style="color: #333333">=</span> tty<span style="color: #333333">-&gt;</span>disc_data;

	<span style="color: #228899; font-weight: bold">while</span>(n <span style="color: #333333">&lt;=</span> room <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>buf_empty(data<span style="color: #333333">-&gt;</span>tx_start, data<span style="color: #333333">-&gt;</span>tx_end)){
		buf[n<span style="color: #333333">++</span>] <span style="color: #333333">=</span> data<span style="color: #333333">-&gt;</span>tx_buf[data<span style="color: #333333">-&gt;</span>tx_start];
		buf_incidx(data<span style="color: #333333">-&gt;</span>tx_start);
	}

	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	sent <span style="color: #333333">=</span> tty<span style="color: #333333">-&gt;</span>driver<span style="color: #333333">-&gt;</span>write(tty, buf, n);

	<span style="color: #228899; font-weight: bold">if</span>(sent <span style="color: #333333">!=</span> n){
		debug(<span style="background-color: #e0e0ff">&quot;driver lied to us? We lost some data&quot;</span>);
	}
}

<span style="color: #666666; font-style: italic">/*********** Interface to the char driver ********************/</span>


<span style="color: #666666; font-style: italic">/* tuxctl_ldisc_get()</span>
<span style="color: #666666; font-style: italic"> * Read bytes that the line-discipline has received from the controller.</span>
<span style="color: #666666; font-style: italic"> * Returns the number of bytes actually read, or  -1 on error (if, for</span>
<span style="color: #666666; font-style: italic"> * example, the first argument is invalid.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span> 
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_get</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty, <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>buf, <span style="color: #6666ff; font-weight: bold">int</span> n)
{
	<span style="color: #6666ff; font-weight: bold">tuxctl_ldisc_data_t</span> <span style="color: #333333">*</span>data;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> flags;
	<span style="color: #6666ff; font-weight: bold">int</span> r <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

	spin_lock_irqsave(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);
	data <span style="color: #333333">=</span> tty<span style="color: #333333">-&gt;</span>disc_data;
	<span style="color: #228899; font-weight: bold">while</span>(n<span style="color: #333333">--</span> <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>buf_empty(data<span style="color: #333333">-&gt;</span>rx_start, data<span style="color: #333333">-&gt;</span>rx_end)){
		<span style="color: #333333">*</span>buf<span style="color: #333333">++</span> <span style="color: #333333">=</span> data<span style="color: #333333">-&gt;</span>rx_buf[data<span style="color: #333333">-&gt;</span>rx_start];
		buf_incidx(data<span style="color: #333333">-&gt;</span>rx_start);
		r<span style="color: #333333">++</span>;
	}
	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	<span style="color: #228899; font-weight: bold">return</span> r;
}

<span style="color: #666666; font-style: italic">/* tuxctl_ldisc_put()</span>
<span style="color: #666666; font-style: italic"> * Write bytes out to the device. Returns the number of bytes *not* written.</span>
<span style="color: #666666; font-style: italic"> * This means, 0 on success and &gt;0 if the line discipline&#39;s internal buffer</span>
<span style="color: #666666; font-style: italic"> * is full.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span> 
<span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_put</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty, <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #333333">*</span>buf, <span style="color: #6666ff; font-weight: bold">int</span> n)
{
	<span style="color: #6666ff; font-weight: bold">tuxctl_ldisc_data_t</span> <span style="color: #333333">*</span>data;
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> flags;

	spin_lock_irqsave(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	data <span style="color: #333333">=</span> tty<span style="color: #333333">-&gt;</span>disc_data;

	<span style="color: #228899; font-weight: bold">while</span> (n <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>buf_full(data<span style="color: #333333">-&gt;</span>tx_start, data<span style="color: #333333">-&gt;</span>tx_end)) {
		data<span style="color: #333333">-&gt;</span>tx_buf[data<span style="color: #333333">-&gt;</span>tx_end] <span style="color: #333333">=</span> <span style="color: #333333">*</span>buf<span style="color: #333333">++</span>;
		buf_incidx(data<span style="color: #333333">-&gt;</span>tx_end);
		<span style="color: #333333">--</span>n;
	}

	spin_unlock_irqrestore(<span style="color: #333333">&amp;</span>tuxctl_ldisc_lock, flags);

	<span style="color: #666666; font-style: italic">/* Potential race conditions here ...  ?*/</span>

	tuxctl_ldisc_write_wakeup(tty);

	<span style="color: #228899; font-weight: bold">return</span> n;
}

<span style="color: #666666; font-style: italic">/* tuxctl_ldisc_data_callback()</span>
<span style="color: #666666; font-style: italic"> * This is the function called from the line-discipline when data is</span>
<span style="color: #666666; font-style: italic"> * available from the device. This is how responses to polling the buttons</span>
<span style="color: #666666; font-style: italic"> * and ACK&#39;s for setting the LEDs will be transmitted to the tuxctl driver.</span>
<span style="color: #666666; font-style: italic"> * The tuxctl driver must implement this function. The &#39;tty&#39; parameter</span>
<span style="color: #666666; font-style: italic"> * can be passed back to the tuxctl_ldisc_read function to read</span>
<span style="color: #666666; font-style: italic"> * data from the lower-level buffers.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * IMPORTANT: This function is called from an interrupt context, so it </span>
<span style="color: #666666; font-style: italic"> *            cannot acquire any semaphores or otherwise sleep, or access</span>
<span style="color: #666666; font-style: italic"> *            the &#39;current&#39; pointer. It also must not take up too much time.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_data_callback</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty)
{
	<span style="color: #666666; font-style: italic">/* Should probably synchronize these */</span>
	<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> saved[<span style="color: #6666ff; font-weight: bold">2</span>];
	<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span> n_saved <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	
	<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> packet[<span style="color: #6666ff; font-weight: bold">12</span>], <span style="color: #333333">*</span>p;
	<span style="color: #6666ff; font-weight: bold">int</span> n, i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>, j;

	<span style="color: #228899; font-weight: bold">for</span>(i<span style="color: #333333">=</span><span style="color: #6666ff; font-weight: bold">0</span>; i<span style="color: #333333">&lt;</span> n_saved; i<span style="color: #333333">++</span>)
		packet[i] <span style="color: #333333">=</span> saved[i];
	
	n <span style="color: #333333">=</span> n_saved <span style="color: #333333">+</span> tuxctl_ldisc_get(tty, packet <span style="color: #333333">+</span> n_saved,  <span style="color: #6666ff; font-weight: bold">12</span> <span style="color: #333333">-</span> n_saved);

	<span style="color: #666666; font-style: italic">/* Look at all bytes as potential packet beginnings except for </span>
<span style="color: #666666; font-style: italic">	 * the last two bytes. Save them for next time. */</span>
	<span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> n<span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">2</span>; ){
		p <span style="color: #333333">=</span> packet <span style="color: #333333">+</span> i;

		<span style="color: #666666; font-style: italic">/* Check the framing bits to detect lost bytes */</span>
		<span style="color: #228899; font-weight: bold">if</span>(<span style="color: #333333">!</span>(p[<span style="color: #6666ff; font-weight: bold">0</span>]<span style="color: #333333">&amp;</span><span style="color: #005588; font-weight: bold">0x80</span>) <span style="color: #333333">&amp;&amp;</span> p[<span style="color: #6666ff; font-weight: bold">1</span>]<span style="color: #333333">&amp;</span><span style="color: #005588; font-weight: bold">0x80</span> <span style="color: #333333">&amp;&amp;</span> p[<span style="color: #6666ff; font-weight: bold">2</span>]<span style="color: #333333">&amp;</span><span style="color: #005588; font-weight: bold">0x80</span>){
			tuxctl_handle_packet(tty, p);
			i <span style="color: #333333">+=</span> <span style="color: #6666ff; font-weight: bold">3</span>;
		}<span style="color: #228899; font-weight: bold">else</span>{
			i<span style="color: #333333">++</span>;
		}
	}

	<span style="color: #666666; font-style: italic">/* Save the leftovers - extra bytes for breakfast */</span>
	n_saved <span style="color: #333333">=</span> n <span style="color: #333333">-</span> i;
	<span style="color: #228899; font-weight: bold">for</span>(j <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; j <span style="color: #333333">&lt;</span> n_saved; j<span style="color: #333333">++</span>)
		saved[j] <span style="color: #333333">=</span> packet[i<span style="color: #333333">+</span>j];
}
</pre></div>
<p></p>
                
                </section>

                
                
                
                
                
                
                
                <!--tuxctl-ld.h-->
                <section>
                <hnew style="margin-left: 40px" id="tuxctl-ld.h">tuxctl-ld.h</hnew><br>
                    <a style="margin-left: 40px" href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="margin-left: 40px;background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #557799">#ifndef TUXCTL_LD_H</span>
<span style="color: #557799">#define TUXCTL_LD_H</span>

<span style="color: #557799">#include &lt;linux/module.h&gt;</span>
<span style="color: #557799">#include &lt;linux/kernel.h&gt;</span>
<span style="color: #557799">#include &lt;linux/fs.h&gt;</span>
<span style="color: #557799">#include &lt;linux/tty.h&gt;</span>

<span style="color: #666666; font-style: italic">/* tuxctl-ld.h</span>
<span style="color: #666666; font-style: italic"> * Interface between line discipline and driver */</span>

<span style="color: #666666; font-style: italic">/* tuxctl_ldisc_get()</span>
<span style="color: #666666; font-style: italic"> * Read bytes that the line-discipline has received from the controller.</span>
<span style="color: #666666; font-style: italic"> * Returns the number of bytes actually read, or  -1 on error (if, for</span>
<span style="color: #666666; font-style: italic"> * example, the first argument is invalid.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_get</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span>, <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>, <span style="color: #6666ff; font-weight: bold">int</span>);


<span style="color: #666666; font-style: italic">/* tuxctl_ldisc_put()</span>
<span style="color: #666666; font-style: italic"> * Write bytes out to the device. Returns the number of bytes *not* written.</span>
<span style="color: #666666; font-style: italic"> * This means, 0 on success and &gt;0 if the line discipline&#39;s internal buffer</span>
<span style="color: #666666; font-style: italic"> * is full.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ldisc_put</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct<span style="color: #333333">*</span>, <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #228899; font-weight: bold">const</span><span style="color: #333333">*</span>, <span style="color: #6666ff; font-weight: bold">int</span>);

<span style="color: #666666; font-style: italic">/* tuxctl_handle_packet</span>
<span style="color: #666666; font-style: italic"> * To be written by the student.  This function will handle a </span>
<span style="color: #666666; font-style: italic"> * packet sent to the computer from the tux controller.  This is</span>
<span style="color: #666666; font-style: italic"> * called by tuxctl_ldisc_data_callback().</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">tuxctl_handle_packet</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span>tty, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span>packet);


<span style="color: #666666; font-style: italic">/* ioctl for the line discipline that the students will implement.</span>
<span style="color: #666666; font-style: italic"> * Located in tuxctl.c</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">tuxctl_ioctl</span>(<span style="color: #228899; font-weight: bold">struct</span> tty_struct <span style="color: #333333">*</span> tty, <span style="color: #228899; font-weight: bold">struct</span> file <span style="color: #333333">*</span>, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">int</span> cmd, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">long</span> arg);
<span style="color: #557799">#endif</span>
</pre></div>
<p></p>                
                </section>
                
                
                
                
                
                
                
                
                <!--Makefile-->
                <section>
                <hnew style="margin-left: 40px" id="MakefileMod">Makefile</hnew><br>
                    <a style="margin-left: 40px" href="#" class="buttonBackToTop">BACK TO TOP</a>  
                <!-- HTML generated using hilite.me --><div style="margin-left: 40px;background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic"># Makefile for tux controller driver</span>
<span style="color: #666666; font-style: italic"># Created for ECE 391 - Fall 2007</span>
<span style="color: #666666; font-style: italic"># By Andrew Ofisher</span>

<span style="color: #003366">obj-m</span> <span style="color: #333333">+=</span> tuxctl.o 
<span style="color: #003366">tuxctl-objs</span> <span style="color: #333333">:=</span> tuxctl-ioctl.o tuxctl-ld.o

<span style="color: #003366">KERNEL_DIR</span> <span style="color: #333333">:=</span> /home/user/build

<span style="color: #55eedd; font-weight: bold">all</span><span style="color: #333333">:</span>
	make -C <span style="color: #228899; font-weight: bold">$(</span>KERNEL_DIR<span style="color: #228899; font-weight: bold">)</span> <span style="color: #003366">M</span><span style="color: #333333">=</span><span style="color: #228899; font-weight: bold">$(</span>PWD<span style="color: #228899; font-weight: bold">)</span> modules
<span style="color: #666666; font-style: italic">	# for simplicity when using GDB, make a copy in Linux source dir</span>
	cp -f tuxctl.o <span style="color: #228899; font-weight: bold">$(</span>KERNEL_DIR<span style="color: #228899; font-weight: bold">)</span>

<span style="color: #55eedd; font-weight: bold">clean</span><span style="color: #333333">::</span>
	make -C <span style="color: #228899; font-weight: bold">$(</span>KERNEL_DIR<span style="color: #228899; font-weight: bold">)</span> <span style="color: #003366">M</span><span style="color: #333333">=</span><span style="color: #228899; font-weight: bold">$(</span>PWD<span style="color: #228899; font-weight: bold">)</span> clean

<span style="color: #55eedd; font-weight: bold">clear</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">clean</span>
	rm -f Module.symvers
</pre></div>
<p></p>
                
                </section>
                
            </section>
        
        
            <!--mp2photo.c-->
            <section>
            <hnew id="mp2photo.c">mp2photo.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
            <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * mp2photo.c - utility program for producing adventure game room photos</span>
<span style="color: #666666; font-style: italic"> *              and object images</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    2</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Sat Sep 10 00:50:10 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    mp2photo.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Sat Sep 10 00:50:10 2011</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sat Sep 14 10:26:34 2011</span>
<span style="color: #666666; font-style: italic"> *		Merged with mp2object.c.</span>
<span style="color: #666666; font-style: italic"> */</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * This file is a standalone utility program that transforms 24-bit BMP</span>
<span style="color: #666666; font-style: italic"> * files into room photos for the Fall 2011 ECE391 MP2 adventure game.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * The input file format is fairly constrained--no compression is allowed,</span>
<span style="color: #666666; font-style: italic"> * for example.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * The output file format is 5:6:5 RGB stored in the same order as in the</span>
<span style="color: #666666; font-style: italic"> * BMP, i.e., rows from bottom to top, and from right to left within each</span>
<span style="color: #666666; font-style: italic"> * row.  The header simply gives the dimensions of the image.</span>
<span style="color: #666666; font-style: italic"> */</span>


<span style="color: #557799">#include &lt;stdint.h&gt;</span>
<span style="color: #557799">#include &lt;stdio.h&gt;</span>
<span style="color: #557799">#include &lt;stdlib.h&gt;</span>
<span style="color: #557799">#include &lt;string.h&gt;</span>

<span style="color: #557799">#include &quot;photo_headers.h&quot;</span>


<span style="color: #557799">#if !defined(WRITE_OBJECT_IMAGE)</span>
<span style="color: #557799">#define WRITE_OBJECT_IMAGE 0		</span><span style="color: #666666; font-style: italic">/* output defaults to room photo */</span><span style="color: #557799"></span>
<span style="color: #557799">#endif</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * Calculate width of one row of a BMP image in bytes, including padding</span>
<span style="color: #666666; font-style: italic"> * (to multiple of 4 bytes).</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int32_t</span>
<span style="color: #55eedd; font-weight: bold">bmp_row_width</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">bmp_header_t</span><span style="color: #333333">*</span> h)
{
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">4</span> <span style="color: #333333">*</span> ((<span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> h<span style="color: #333333">-&gt;</span>img_width <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span>) <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">4</span>);
}

<span style="color: #666666; font-style: italic">// Reads BMP header from file and checks its validity.</span>
<span style="color: #666666; font-style: italic">// Returns 1 if BMP header is valid, otherwise 0.</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">bmp_header_check</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> fname, <span style="color: #6666ff; font-weight: bold">FILE</span><span style="color: #333333">*</span> in, <span style="color: #6666ff; font-weight: bold">bmp_header_t</span><span style="color: #333333">*</span> h)
{
    <span style="color: #6666ff; font-weight: bold">char</span>     magic[<span style="color: #6666ff; font-weight: bold">3</span>];
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> row_width;

    <span style="color: #666666; font-style: italic">// Check validity of input file.</span>
    magic[<span style="color: #6666ff; font-weight: bold">2</span>] <span style="color: #333333">=</span> <span style="color: #8888FF">&#39;\0&#39;</span>;
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">2</span> <span style="color: #333333">!=</span> fread (magic, <span style="color: #228899; font-weight: bold">sizeof</span> (magic[<span style="color: #6666ff; font-weight: bold">0</span>]), <span style="color: #6666ff; font-weight: bold">2</span>, in) <span style="color: #333333">||</span>
        <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcmp (magic, BMP_MAGIC) <span style="color: #333333">||</span>
	<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fread (h, <span style="color: #228899; font-weight: bold">sizeof</span> (<span style="color: #333333">*</span>h), <span style="color: #6666ff; font-weight: bold">1</span>, in)) {
        fprintf (stderr, <span style="background-color: #e0e0ff">&quot;%s does not appear to be a BMP file.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, fname);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">4096</span> <span style="color: #333333">&lt;</span> h<span style="color: #333333">-&gt;</span>img_width <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">4096</span> <span style="color: #333333">&lt;</span> h<span style="color: #333333">-&gt;</span>img_height <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> h<span style="color: #333333">-&gt;</span>planes <span style="color: #333333">||</span> 
    	<span style="color: #6666ff; font-weight: bold">24</span> <span style="color: #333333">!=</span> h<span style="color: #333333">-&gt;</span>bits_per_pixel <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> h<span style="color: #333333">-&gt;</span>compression_type) {
        fprintf (stderr, <span style="background-color: #e0e0ff">&quot;%s must be 24-bit-color on one plane with no &quot;</span>
		 <span style="background-color: #e0e0ff">&quot;compression.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, fname);
        <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    }
    row_width <span style="color: #333333">=</span> bmp_row_width (h);
    <span style="color: #228899; font-weight: bold">if</span> (h<span style="color: #333333">-&gt;</span>img_size <span style="color: #333333">!=</span> row_width <span style="color: #333333">*</span> h<span style="color: #333333">-&gt;</span>img_height) {
        fprintf (stderr, <span style="background-color: #e0e0ff">&quot;%s image size incorrect in BMP/DIB header.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>,
		 fname);
        <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    }
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">1</span>;
}

<span style="color: #666666; font-style: italic">// Read image data from BMP file into dynamically allocated memory.</span>
<span style="color: #666666; font-style: italic">// Return pointer to memory on success, or NULL on failure.</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">uint8_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">read_bmp_image_data</span> (<span style="color: #6666ff; font-weight: bold">FILE</span><span style="color: #333333">*</span> in, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">bmp_header_t</span><span style="color: #333333">*</span> h)
{
    <span style="color: #6666ff; font-weight: bold">uint8_t</span><span style="color: #333333">*</span> img_data;

    <span style="color: #666666; font-style: italic">// Seek to image data.</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> fseek (in, h<span style="color: #333333">-&gt;</span>pixel_offset, SEEK_SET)) {
        perror (<span style="background-color: #e0e0ff">&quot;fseek to start of image data in BMP file&quot;</span>);
        <span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
    }

    <span style="color: #666666; font-style: italic">// Allocate space, then read in the image data.</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (img_data <span style="color: #333333">=</span> malloc (h<span style="color: #333333">-&gt;</span>img_size)) <span style="color: #333333">||</span>
    	<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fread (img_data, h<span style="color: #333333">-&gt;</span>img_size, <span style="color: #6666ff; font-weight: bold">1</span>, in)) {
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> img_data) {
	    free (img_data);
	}
        perror (<span style="background-color: #e0e0ff">&quot;allocate and read image&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
    }
    <span style="color: #228899; font-weight: bold">return</span> img_data;
}

<span style="color: #666666; font-style: italic">// Write header and data as either 5:6:5 RGB words (little endian) or</span>
<span style="color: #666666; font-style: italic">// 2:2:2 RGB bytes, row by row, to the output file.  Return 1 on success, </span>
<span style="color: #666666; font-style: italic">// 0 on failure.</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">write_output_file</span> (<span style="color: #6666ff; font-weight: bold">FILE</span><span style="color: #333333">*</span> out, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">bmp_header_t</span><span style="color: #333333">*</span> h, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">uint8_t</span><span style="color: #333333">*</span> img)
{
    <span style="color: #6666ff; font-weight: bold">photo_header_t</span> photo_header;
    <span style="color: #6666ff; font-weight: bold">uint32_t</span>       row_width;
    <span style="color: #6666ff; font-weight: bold">uint16_t</span>	   x;
    <span style="color: #6666ff; font-weight: bold">uint16_t</span>	   y;

    <span style="color: #666666; font-style: italic">// Write header to output file.</span>
    photo_header.width <span style="color: #333333">=</span> h<span style="color: #333333">-&gt;</span>img_width;
    photo_header.height <span style="color: #333333">=</span> h<span style="color: #333333">-&gt;</span>img_height;
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fwrite (<span style="color: #333333">&amp;</span>photo_header, <span style="color: #228899; font-weight: bold">sizeof</span> (photo_header), <span style="color: #6666ff; font-weight: bold">1</span>, out)) {
        perror (<span style="background-color: #e0e0ff">&quot;write header to output file&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    }

    <span style="color: #666666; font-style: italic">// Write image data to output file.</span>
    row_width <span style="color: #333333">=</span> bmp_row_width (h);
    <span style="color: #228899; font-weight: bold">for</span> (y <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; h<span style="color: #333333">-&gt;</span>img_height <span style="color: #333333">&gt;</span> y; y<span style="color: #333333">++</span>) {
	<span style="color: #228899; font-weight: bold">for</span> (x <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; h<span style="color: #333333">-&gt;</span>img_width <span style="color: #333333">&gt;</span> x; x<span style="color: #333333">++</span>) {
<span style="color: #557799">#if (1 == WRITE_OBJECT_IMAGE)</span>
	    <span style="color: #6666ff; font-weight: bold">uint8_t</span> vga_color;
 	    vga_color <span style="color: #333333">=</span> ((img[row_width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> x <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">2</span>] <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">6</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">4</span>) <span style="color: #333333">|</span> 
 	    		((img[row_width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> x <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">1</span>] <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">6</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">|</span> 
 			(img[row_width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> x] <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">6</span>);
	    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	     * We map any bright yellow pixel to transparent; it&#39;s easy to</span>
<span style="color: #666666; font-style: italic">	     * be more specific by conditioning on the img data (24 bits)</span>
<span style="color: #666666; font-style: italic">	     * rather than the output image data (6 bits).</span>
<span style="color: #666666; font-style: italic">	     */</span>
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #005588; font-weight: bold">0x3C</span> <span style="color: #333333">==</span> vga_color) {
 	        vga_color <span style="color: #333333">=</span> OBJ_CLR_TRANSP;
 	    }
<span style="color: #557799">#else </span><span style="color: #666666; font-style: italic">/* (1 != WRITE_OBJECT_IMAGE) */</span><span style="color: #557799"></span>
	    <span style="color: #6666ff; font-weight: bold">uint16_t</span> vga_color;
	    vga_color <span style="color: #333333">=</span> ((img[row_width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> x <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">2</span>] <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">3</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">11</span>) <span style="color: #333333">|</span> 
	    		((img[row_width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> x <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">1</span>] <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">&lt;&lt;</span> <span style="color: #6666ff; font-weight: bold">5</span>) <span style="color: #333333">|</span> 
			(img[row_width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> x] <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">3</span>);
<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* WRITE_OBJECT_IMAGE */</span><span style="color: #557799"></span>
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fwrite (<span style="color: #333333">&amp;</span>vga_color, <span style="color: #228899; font-weight: bold">sizeof</span> (vga_color), <span style="color: #6666ff; font-weight: bold">1</span>, out)) {
	        perror (<span style="background-color: #e0e0ff">&quot;write data to output file&quot;</span>);
		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	    }
	}
    }

    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">1</span>;
}

<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">main</span> (<span style="color: #6666ff; font-weight: bold">int</span> argc, <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> argv[])
{
    <span style="color: #6666ff; font-weight: bold">FILE</span><span style="color: #333333">*</span>        in;
    <span style="color: #6666ff; font-weight: bold">FILE</span><span style="color: #333333">*</span>        out;
    <span style="color: #6666ff; font-weight: bold">bmp_header_t</span> bmp_header;
    <span style="color: #6666ff; font-weight: bold">uint8_t</span><span style="color: #333333">*</span>     img_data;
    <span style="color: #6666ff; font-weight: bold">int32_t</span>      written;

    <span style="color: #666666; font-style: italic">// Check syntax of invocation.</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">!=</span> argc) {
    	fprintf (stderr, <span style="background-color: #e0e0ff">&quot;usage: %s &lt;BMP file name&gt; &lt;output file&gt;</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, argv[<span style="color: #6666ff; font-weight: bold">0</span>]);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">2</span>;
    }

    <span style="color: #666666; font-style: italic">// Try to open the two files.</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (in <span style="color: #333333">=</span> fopen (argv[<span style="color: #6666ff; font-weight: bold">1</span>], <span style="background-color: #e0e0ff">&quot;r+b&quot;</span>))) {
        perror (<span style="background-color: #e0e0ff">&quot;open BMP file&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">2</span>;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (out <span style="color: #333333">=</span> fopen (argv[<span style="color: #6666ff; font-weight: bold">2</span>], <span style="background-color: #e0e0ff">&quot;w+b&quot;</span>))) {
	fclose (in);
        perror (<span style="background-color: #e0e0ff">&quot;open output file&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">2</span>;
    }

    <span style="color: #666666; font-style: italic">// Check validity of input file, then read image data from input file.</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">!</span>bmp_header_check (argv[<span style="color: #6666ff; font-weight: bold">1</span>], in, <span style="color: #333333">&amp;</span>bmp_header) <span style="color: #333333">||</span>
	<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (img_data <span style="color: #333333">=</span> read_bmp_image_data (in, <span style="color: #333333">&amp;</span>bmp_header))) {
	fclose (in);
	fclose (out);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">2</span>;
    }

    <span style="color: #666666; font-style: italic">// Done with the input file.  Ignore remaining errors.</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);

    <span style="color: #666666; font-style: italic">// Try to write, then close, the output file.</span>
    written <span style="color: #333333">=</span> write_output_file (out, <span style="color: #333333">&amp;</span>bmp_header, img_data);
    <span style="color: #228899; font-weight: bold">if</span> (EOF <span style="color: #333333">==</span> fclose (out)) {
	perror (<span style="background-color: #e0e0ff">&quot;close output file&quot;</span>);
        written <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    }

    <span style="color: #666666; font-style: italic">// Free the image data.</span>
    free (img_data);

    <span style="color: #666666; font-style: italic">// Return value based on success of output file write and close.</span>
    <span style="color: #228899; font-weight: bold">return</span> (written <span style="color: #333333">?</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">:</span> <span style="color: #6666ff; font-weight: bold">3</span>);
}
</pre></div>
        <p></p>                
            </section>
        
        
        
        
        
        
        
        
            <!--photo.c-->
            <section>
            <hnew id="photo.c">photo.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
             <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * photo.c - photo display functions</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    3</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Fri Sep  9 21:44:10 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    photo.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Fri Sep  9 21:44:10 2011</span>
<span style="color: #666666; font-style: italic"> *		First written (based on mazegame code).</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sun Sep 11 14:57:59 2011</span>
<span style="color: #666666; font-style: italic"> *		Completed initial implementation of functions.</span>
<span style="color: #666666; font-style: italic"> *	SL	3	Wed Sep 14 21:49:44 2011</span>
<span style="color: #666666; font-style: italic"> *		Cleaned up code for distribution.</span>
<span style="color: #666666; font-style: italic"> */</span>


<span style="color: #557799">#include &lt;string.h&gt;</span>

<span style="color: #557799">#include &quot;assert.h&quot;</span>
<span style="color: #557799">#include &quot;modex.h&quot;</span>
<span style="color: #557799">#include &quot;photo.h&quot;</span>
<span style="color: #557799">#include &quot;photo_headers.h&quot;</span>
<span style="color: #557799">#include &quot;world.h&quot;</span>


<span style="color: #666666; font-style: italic">/* types local to this file (declared in types.h) */</span>

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * A room photo.  Note that you must write the code that selects the</span>
<span style="color: #666666; font-style: italic"> * optimized palette colors and fills in the pixel data using them as </span>
<span style="color: #666666; font-style: italic"> * well as the code that sets up the VGA to make use of these colors.</span>
<span style="color: #666666; font-style: italic"> * Pixel data are stored as one-byte values starting from the upper</span>
<span style="color: #666666; font-style: italic"> * left and traversing the top row before returning to the left of</span>
<span style="color: #666666; font-style: italic"> * the second row, and so forth.  No padding should be used.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">photo_t</span> {
    <span style="color: #6666ff; font-weight: bold">photo_header_t</span> hdr;			<span style="color: #666666; font-style: italic">/* defines height and width */</span>
    <span style="color: #6666ff; font-weight: bold">uint8_t</span>        palette[<span style="color: #6666ff; font-weight: bold">192</span>][<span style="color: #6666ff; font-weight: bold">3</span>];     <span style="color: #666666; font-style: italic">/* optimized palette colors */</span>
    <span style="color: #6666ff; font-weight: bold">uint8_t</span><span style="color: #333333">*</span>       img;                 <span style="color: #666666; font-style: italic">/* pixel data               */</span>
};

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * An object image.  The code for managing these images has been given</span>
<span style="color: #666666; font-style: italic"> * to you.  The data are simply loaded from a file, where they have </span>
<span style="color: #666666; font-style: italic"> * been stored as 2:2:2-bit RGB values (one byte each), including </span>
<span style="color: #666666; font-style: italic"> * transparent pixels (value OBJ_CLR_TRANSP).  As with the room photos, </span>
<span style="color: #666666; font-style: italic"> * pixel data are stored as one-byte values starting from the upper </span>
<span style="color: #666666; font-style: italic"> * left and traversing the top row before returning to the left of the </span>
<span style="color: #666666; font-style: italic"> * second row, and so forth.  No padding is used.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">image_t</span> {
    <span style="color: #6666ff; font-weight: bold">photo_header_t</span> hdr;			<span style="color: #666666; font-style: italic">/* defines height and width */</span>
    <span style="color: #6666ff; font-weight: bold">uint8_t</span><span style="color: #333333">*</span>       img;                 <span style="color: #666666; font-style: italic">/* pixel data               */</span>
};

 <span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * An octree node. Each node of the octree will hold those 5 values to</span>
<span style="color: #666666; font-style: italic"> * keep track of the color it represents, how many pixels fit best to </span>
<span style="color: #666666; font-style: italic"> * this color and what the node&#39;s index is in the octree.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">struct</span> octree_node {
  <span style="color: #6666ff; font-weight: bold">int</span> count;              <span style="color: #666666; font-style: italic">/* keeps count of many pixels correspond to this color  */</span>
  <span style="color: #6666ff; font-weight: bold">uint32_t</span> red_total;          <span style="color: #666666; font-style: italic">/* holds the 4 bits for the red component         */</span>
  <span style="color: #6666ff; font-weight: bold">uint32_t</span> green_total;        <span style="color: #666666; font-style: italic">/* holds the 4 bits for the green component       */</span>
  <span style="color: #6666ff; font-weight: bold">uint32_t</span> blue_total;         <span style="color: #666666; font-style: italic">/* holds the 4 bits for the blue component        */</span>
  <span style="color: #6666ff; font-weight: bold">uint16_t</span> index;              <span style="color: #666666; font-style: italic">/* saving index to calculate offset */</span>
  <span style="color: #6666ff; font-weight: bold">uint16_t</span> index_for_palette;  <span style="color: #666666; font-style: italic">/*      */</span>
  <span style="color: #6666ff; font-weight: bold">uint8_t</span> index_level_2;
};

<span style="color: #666666; font-style: italic">/* macro used to write a byte to a port */</span>
<span style="color: #557799">#define OUTB(port,val)                                                  \</span>
<span style="color: #557799">do {                                                                    \</span>
<span style="color: #557799">    asm volatile (&quot;                                                     \</span>
<span style="color: #557799">        outb %b1,(%w0)                                                  \</span>
<span style="color: #557799">    &quot; : </span><span style="color: #666666; font-style: italic">/* no outputs */</span><span style="color: #557799">                                                \</span>
<span style="color: #557799">      : &quot;d&quot; ((port)), &quot;a&quot; ((val))                                       \</span>
<span style="color: #557799">      : &quot;memory&quot;, &quot;cc&quot;);                                                \</span>
<span style="color: #557799">} while (0)</span>

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * macro used to write an array of one-byte values to two consecutive ports </span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#define REP_OUTSB(port,source,count)                                    \</span>
<span style="color: #557799">do {                                                                    \</span>
<span style="color: #557799">    asm volatile (&quot;                                                     \</span>
<span style="color: #557799">     1: movb 0(%1),%%al                                                ;\</span>
<span style="color: #557799">  outb %%al,(%w2)                                                ;\</span>
<span style="color: #557799">  incl %1                                                        ;\</span>
<span style="color: #557799">  decl %0                                                        ;\</span>
<span style="color: #557799">  jne 1b                                                          \</span>
<span style="color: #557799">    &quot; : </span><span style="color: #666666; font-style: italic">/* no outputs */</span><span style="color: #557799">                                                \</span>
<span style="color: #557799">      : &quot;c&quot; ((count)), &quot;S&quot; ((source)), &quot;d&quot; ((port))                     \</span>
<span style="color: #557799">      : &quot;eax&quot;, &quot;memory&quot;, &quot;cc&quot;);                                         \</span>
<span style="color: #557799">} while (0)</span>

<span style="color: #666666; font-style: italic">/* file-scope variables */</span>
<span style="color: #666666; font-style: italic">/*************************************************************************************************************************/</span>
  <span style="color: #666666; font-style: italic">//creating levels 2 and 4 of the octree as arrays</span>
  <span style="color: #228899; font-weight: bold">struct</span> octree_node level_two_array[LEV2_TOT_NODES];   <span style="color: #666666; font-style: italic">//8^2 = 64 number of nodes at level 2</span>
  <span style="color: #228899; font-weight: bold">struct</span> octree_node level_four_array[LEV4_TOT_NODES];  <span style="color: #666666; font-style: italic">//8^4 = 4096 number of nodes at level 4</span>
  <span style="color: #228899; font-weight: bold">struct</span> octree_node copy_level_four_array[LEV4_TOT_NODES];

  <span style="color: #666666; font-style: italic">//initializing average values</span>
  <span style="color: #6666ff; font-weight: bold">uint32_t</span> red_avg <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
  <span style="color: #6666ff; font-weight: bold">uint32_t</span> green_avg <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
  <span style="color: #6666ff; font-weight: bold">uint32_t</span> blue_avg <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; 

 
<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * The room currently shown on the screen.  This value is not known to </span>
<span style="color: #666666; font-style: italic"> * the mode X code, but is needed when filling buffers in callbacks from </span>
<span style="color: #666666; font-style: italic"> * that code (fill_horiz_buffer/fill_vert_buffer).  The value is set </span>
<span style="color: #666666; font-style: italic"> * by calling prep_room.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> cur_room <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>; 


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * fill_horiz_buffer</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Given the (x,y) map pixel coordinate of the leftmost </span>
<span style="color: #666666; font-style: italic"> *                pixel of a line to be drawn on the screen, this routine </span>
<span style="color: #666666; font-style: italic"> *                produces an image of the line.  Each pixel on the line</span>
<span style="color: #666666; font-style: italic"> *                is represented as a single byte in the image.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *                Note that this routine draws both the room photo and</span>
<span style="color: #666666; font-style: italic"> *                the objects in the room.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: (x,y) -- leftmost pixel of line to be drawn </span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: buf -- buffer holding image data for the line</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">fill_horiz_buffer</span> (<span style="color: #6666ff; font-weight: bold">int</span> x, <span style="color: #6666ff; font-weight: bold">int</span> y, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> buf[SCROLL_X_DIM])
{
    <span style="color: #6666ff; font-weight: bold">int</span>            idx;   <span style="color: #666666; font-style: italic">/* loop index over pixels in the line          */</span> 
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span>      obj;   <span style="color: #666666; font-style: italic">/* loop index over objects in the current room */</span>
    <span style="color: #6666ff; font-weight: bold">int</span>            imgx;  <span style="color: #666666; font-style: italic">/* loop index over pixels in object image      */</span> 
    <span style="color: #6666ff; font-weight: bold">int</span>            yoff;  <span style="color: #666666; font-style: italic">/* y offset into object image                  */</span> 
    <span style="color: #6666ff; font-weight: bold">uint8_t</span>        pixel; <span style="color: #666666; font-style: italic">/* pixel from object image                     */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> view;  <span style="color: #666666; font-style: italic">/* room photo                                  */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>        obj_x; <span style="color: #666666; font-style: italic">/* object x position                           */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>        obj_y; <span style="color: #666666; font-style: italic">/* object y position                           */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> img;   <span style="color: #666666; font-style: italic">/* object image                                */</span>

    <span style="color: #666666; font-style: italic">/* Get pointer to current photo of current room. */</span>
    view <span style="color: #333333">=</span> room_photo (cur_room);

    <span style="color: #666666; font-style: italic">/* Loop over pixels in line. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; idx <span style="color: #333333">&lt;</span> SCROLL_X_DIM; idx<span style="color: #333333">++</span>) {
        buf[idx] <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&lt;=</span> x <span style="color: #333333">+</span> idx <span style="color: #333333">&amp;&amp;</span> view<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">&gt;</span> x <span style="color: #333333">+</span> idx <span style="color: #333333">?</span>
		    view<span style="color: #333333">-&gt;</span>img[view<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> x <span style="color: #333333">+</span> idx] <span style="color: #333333">:</span> <span style="color: #6666ff; font-weight: bold">0</span>);
    }

    <span style="color: #666666; font-style: italic">/* Loop over objects in the current room. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (obj <span style="color: #333333">=</span> room_contents_iterate (cur_room); <span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> obj;
    	 obj <span style="color: #333333">=</span> obj_next (obj)) {
	obj_x <span style="color: #333333">=</span> obj_get_x (obj);
	obj_y <span style="color: #333333">=</span> obj_get_y (obj);
	img <span style="color: #333333">=</span> obj_image (obj);

        <span style="color: #666666; font-style: italic">/* Is object outside of the line we&#39;re drawing? */</span>
	<span style="color: #228899; font-weight: bold">if</span> (y <span style="color: #333333">&lt;</span> obj_y <span style="color: #333333">||</span> y <span style="color: #333333">&gt;=</span> obj_y <span style="color: #333333">+</span> img<span style="color: #333333">-&gt;</span>hdr.height <span style="color: #333333">||</span>
	    x <span style="color: #333333">+</span> SCROLL_X_DIM <span style="color: #333333">&lt;=</span> obj_x <span style="color: #333333">||</span> x <span style="color: #333333">&gt;=</span> obj_x <span style="color: #333333">+</span> img<span style="color: #333333">-&gt;</span>hdr.width) {
	    <span style="color: #228899; font-weight: bold">continue</span>;
	}

	<span style="color: #666666; font-style: italic">/* The y offset of drawing is fixed. */</span>
	yoff <span style="color: #333333">=</span> (y <span style="color: #333333">-</span> obj_y) <span style="color: #333333">*</span> img<span style="color: #333333">-&gt;</span>hdr.width;

	<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	 * The x offsets depend on whether the object starts to the left</span>
<span style="color: #666666; font-style: italic">	 * or to the right of the starting point for the line being drawn.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #228899; font-weight: bold">if</span> (x <span style="color: #333333">&lt;=</span> obj_x) {
	    idx <span style="color: #333333">=</span> obj_x <span style="color: #333333">-</span> x;
	    imgx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	} <span style="color: #228899; font-weight: bold">else</span> {
	    idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	    imgx <span style="color: #333333">=</span> x <span style="color: #333333">-</span> obj_x;
	}

	<span style="color: #666666; font-style: italic">/* Copy the object&#39;s pixel data. */</span>
	<span style="color: #228899; font-weight: bold">for</span> (; SCROLL_X_DIM <span style="color: #333333">&gt;</span> idx <span style="color: #333333">&amp;&amp;</span> img<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">&gt;</span> imgx; idx<span style="color: #333333">++</span>, imgx<span style="color: #333333">++</span>) {
	    pixel <span style="color: #333333">=</span> img<span style="color: #333333">-&gt;</span>img[yoff <span style="color: #333333">+</span> imgx];

	    <span style="color: #666666; font-style: italic">/* Don&#39;t copy transparent pixels. */</span>
	    <span style="color: #228899; font-weight: bold">if</span> (OBJ_CLR_TRANSP <span style="color: #333333">!=</span> pixel) {
		buf[idx] <span style="color: #333333">=</span> pixel;
	    }
	}
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * fill_vert_buffer</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Given the (x,y) map pixel coordinate of the top pixel of </span>
<span style="color: #666666; font-style: italic"> *                a vertical line to be drawn on the screen, this routine </span>
<span style="color: #666666; font-style: italic"> *                produces an image of the line.  Each pixel on the line</span>
<span style="color: #666666; font-style: italic"> *                is represented as a single byte in the image.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *                Note that this routine draws both the room photo and</span>
<span style="color: #666666; font-style: italic"> *                the objects in the room.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: (x,y) -- top pixel of line to be drawn </span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: buf -- buffer holding image data for the line</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">fill_vert_buffer</span> (<span style="color: #6666ff; font-weight: bold">int</span> x, <span style="color: #6666ff; font-weight: bold">int</span> y, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> buf[SCROLL_Y_DIM])
{
    <span style="color: #6666ff; font-weight: bold">int</span>            idx;   <span style="color: #666666; font-style: italic">/* loop index over pixels in the line          */</span> 
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span>      obj;   <span style="color: #666666; font-style: italic">/* loop index over objects in the current room */</span>
    <span style="color: #6666ff; font-weight: bold">int</span>            imgy;  <span style="color: #666666; font-style: italic">/* loop index over pixels in object image      */</span> 
    <span style="color: #6666ff; font-weight: bold">int</span>            xoff;  <span style="color: #666666; font-style: italic">/* x offset into object image                  */</span> 
    <span style="color: #6666ff; font-weight: bold">uint8_t</span>        pixel; <span style="color: #666666; font-style: italic">/* pixel from object image                     */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> view;  <span style="color: #666666; font-style: italic">/* room photo                                  */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>        obj_x; <span style="color: #666666; font-style: italic">/* object x position                           */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>        obj_y; <span style="color: #666666; font-style: italic">/* object y position                           */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> img;   <span style="color: #666666; font-style: italic">/* object image                                */</span>

    <span style="color: #666666; font-style: italic">/* Get pointer to current photo of current room. */</span>
    view <span style="color: #333333">=</span> room_photo (cur_room);

    <span style="color: #666666; font-style: italic">/* Loop over pixels in line. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; idx <span style="color: #333333">&lt;</span> SCROLL_Y_DIM; idx<span style="color: #333333">++</span>) {
        buf[idx] <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&lt;=</span> y <span style="color: #333333">+</span> idx <span style="color: #333333">&amp;&amp;</span> view<span style="color: #333333">-&gt;</span>hdr.height <span style="color: #333333">&gt;</span> y <span style="color: #333333">+</span> idx <span style="color: #333333">?</span>
		    view<span style="color: #333333">-&gt;</span>img[view<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> (y <span style="color: #333333">+</span> idx) <span style="color: #333333">+</span> x] <span style="color: #333333">:</span> <span style="color: #6666ff; font-weight: bold">0</span>);
    }

    <span style="color: #666666; font-style: italic">/* Loop over objects in the current room. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (obj <span style="color: #333333">=</span> room_contents_iterate (cur_room); <span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> obj;
    	 obj <span style="color: #333333">=</span> obj_next (obj)) {
	obj_x <span style="color: #333333">=</span> obj_get_x (obj);
	obj_y <span style="color: #333333">=</span> obj_get_y (obj);
	img <span style="color: #333333">=</span> obj_image (obj);

        <span style="color: #666666; font-style: italic">/* Is object outside of the line we&#39;re drawing? */</span>
	<span style="color: #228899; font-weight: bold">if</span> (x <span style="color: #333333">&lt;</span> obj_x <span style="color: #333333">||</span> x <span style="color: #333333">&gt;=</span> obj_x <span style="color: #333333">+</span> img<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">||</span>
	    y <span style="color: #333333">+</span> SCROLL_Y_DIM <span style="color: #333333">&lt;=</span> obj_y <span style="color: #333333">||</span> y <span style="color: #333333">&gt;=</span> obj_y <span style="color: #333333">+</span> img<span style="color: #333333">-&gt;</span>hdr.height) {
	    <span style="color: #228899; font-weight: bold">continue</span>;
	}

	<span style="color: #666666; font-style: italic">/* The x offset of drawing is fixed. */</span>
	xoff <span style="color: #333333">=</span> x <span style="color: #333333">-</span> obj_x;

	<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	 * The y offsets depend on whether the object starts below or </span>
<span style="color: #666666; font-style: italic">	 * above the starting point for the line being drawn.</span>
<span style="color: #666666; font-style: italic">	 */</span>
	<span style="color: #228899; font-weight: bold">if</span> (y <span style="color: #333333">&lt;=</span> obj_y) {
	    idx <span style="color: #333333">=</span> obj_y <span style="color: #333333">-</span> y;
	    imgy <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	} <span style="color: #228899; font-weight: bold">else</span> {
	    idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	    imgy <span style="color: #333333">=</span> y <span style="color: #333333">-</span> obj_y;
	}

	<span style="color: #666666; font-style: italic">/* Copy the object&#39;s pixel data. */</span>
	<span style="color: #228899; font-weight: bold">for</span> (; SCROLL_Y_DIM <span style="color: #333333">&gt;</span> idx <span style="color: #333333">&amp;&amp;</span> img<span style="color: #333333">-&gt;</span>hdr.height <span style="color: #333333">&gt;</span> imgy; idx<span style="color: #333333">++</span>, imgy<span style="color: #333333">++</span>) {
	    pixel <span style="color: #333333">=</span> img<span style="color: #333333">-&gt;</span>img[xoff <span style="color: #333333">+</span> img<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> imgy];

	    <span style="color: #666666; font-style: italic">/* Don&#39;t copy transparent pixels. */</span>
	    <span style="color: #228899; font-weight: bold">if</span> (OBJ_CLR_TRANSP <span style="color: #333333">!=</span> pixel) {
		buf[idx] <span style="color: #333333">=</span> pixel;
	    }
	}
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * image_height</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get height of object image in pixels.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: im -- object image pointer</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: height of object image im in pixels</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint32_t</span> 
<span style="color: #55eedd; font-weight: bold">image_height</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> im)
{
    <span style="color: #228899; font-weight: bold">return</span> im<span style="color: #333333">-&gt;</span>hdr.height;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * image_width</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get width of object image in pixels.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: im -- object image pointer</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: width of object image im in pixels</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint32_t</span> 
<span style="color: #55eedd; font-weight: bold">image_width</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> im)
{
    <span style="color: #228899; font-weight: bold">return</span> im<span style="color: #333333">-&gt;</span>hdr.width;
}

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * photo_height</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get height of room photo in pixels.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: p -- room photo pointer</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: height of room photo p in pixels</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint32_t</span> 
<span style="color: #55eedd; font-weight: bold">photo_height</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> p)
{
    <span style="color: #228899; font-weight: bold">return</span> p<span style="color: #333333">-&gt;</span>hdr.height;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * photo_width</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get width of room photo in pixels.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: p -- room photo pointer</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: width of room photo p in pixels</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint32_t</span> 
<span style="color: #55eedd; font-weight: bold">photo_width</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> p)
{
    <span style="color: #228899; font-weight: bold">return</span> p<span style="color: #333333">-&gt;</span>hdr.width;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * prep_room</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Prepare a new room for display.  You might want to set</span>
<span style="color: #666666; font-style: italic"> *                up the VGA palette registers according to the color</span>
<span style="color: #666666; font-style: italic"> *                palette that you chose for this room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- pointer to the new room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: changes recorded cur_room for this file</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">prep_room</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r)
{
    <span style="color: #666666; font-style: italic">/* Record the current room. */</span>
    cur_room <span style="color: #333333">=</span> r;
    <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> p <span style="color: #333333">=</span> room_photo(r);
    OUTB (<span style="color: #005588; font-weight: bold">0x03C8</span>, <span style="color: #005588; font-weight: bold">0x40</span>);

    <span style="color: #666666; font-style: italic">/* Write all 192 colors from array. */</span>
    REP_OUTSB (<span style="color: #005588; font-weight: bold">0x03C9</span>, p<span style="color: #333333">-&gt;</span>palette, <span style="color: #6666ff; font-weight: bold">192</span> <span style="color: #333333">*</span> <span style="color: #6666ff; font-weight: bold">3</span>);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * read_obj_image</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Read size and pixel data in 2:2:2 RGB format from a</span>
<span style="color: #666666; font-style: italic"> *                photo file and create an image structure from it.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: fname -- file name for input</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: pointer to newly allocated photo on success, or NULL</span>
<span style="color: #666666; font-style: italic"> *                 on failure</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: dynamically allocates memory for the image</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">read_obj_image</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> fname)
{
    <span style="color: #6666ff; font-weight: bold">FILE</span><span style="color: #333333">*</span>    in;		<span style="color: #666666; font-style: italic">/* input file               */</span>
    <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> img <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;	<span style="color: #666666; font-style: italic">/* image structure          */</span>
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> x;			<span style="color: #666666; font-style: italic">/* index over image columns */</span>
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> y;			<span style="color: #666666; font-style: italic">/* index over image rows    */</span>
    <span style="color: #6666ff; font-weight: bold">uint8_t</span>  pixel;		<span style="color: #666666; font-style: italic">/* one pixel from the file  */</span>

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Open the file, allocate the structure, read the header, do some</span>
<span style="color: #666666; font-style: italic">     * sanity checks on it, and allocate space to hold the image pixels.</span>
<span style="color: #666666; font-style: italic">     * If anything fails, clean up as necessary and return NULL.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (in <span style="color: #333333">=</span> fopen (fname, <span style="background-color: #e0e0ff">&quot;r+b&quot;</span>)) <span style="color: #333333">||</span>
	<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (img <span style="color: #333333">=</span> malloc (<span style="color: #228899; font-weight: bold">sizeof</span> (<span style="color: #333333">*</span>img))) <span style="color: #333333">||</span>
	<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> (img<span style="color: #333333">-&gt;</span>img <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>) <span style="color: #333333">||</span> <span style="color: #666666; font-style: italic">/* false clause for initialization */</span>
	<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fread (<span style="color: #333333">&amp;</span>img<span style="color: #333333">-&gt;</span>hdr, <span style="color: #228899; font-weight: bold">sizeof</span> (img<span style="color: #333333">-&gt;</span>hdr), <span style="color: #6666ff; font-weight: bold">1</span>, in) <span style="color: #333333">||</span>
	MAX_OBJECT_WIDTH <span style="color: #333333">&lt;</span> img<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">||</span>
	MAX_OBJECT_HEIGHT <span style="color: #333333">&lt;</span> img<span style="color: #333333">-&gt;</span>hdr.height <span style="color: #333333">||</span>
	<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (img<span style="color: #333333">-&gt;</span>img <span style="color: #333333">=</span> malloc 
		 (img<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> img<span style="color: #333333">-&gt;</span>hdr.height <span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">sizeof</span> (img<span style="color: #333333">-&gt;</span>img[<span style="color: #6666ff; font-weight: bold">0</span>])))) {
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> img) {
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> img<span style="color: #333333">-&gt;</span>img) {
	        free (img<span style="color: #333333">-&gt;</span>img);
	    }
	    free (img);
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> in) {
	    (<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);
	}
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
    }

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Loop over rows from bottom to top.  Note that the file is stored</span>
<span style="color: #666666; font-style: italic">     * in this order, whereas in memory we store the data in the reverse</span>
<span style="color: #666666; font-style: italic">     * order (top to bottom).</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">for</span> (y <span style="color: #333333">=</span> img<span style="color: #333333">-&gt;</span>hdr.height; y<span style="color: #333333">--</span> <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span>; ) 
    {

		<span style="color: #666666; font-style: italic">/* Loop over columns from left to right. */</span>
		<span style="color: #228899; font-weight: bold">for</span> (x <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; img<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">&gt;</span> x; x<span style="color: #333333">++</span>) 
		{
	    	<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	     	* Try to read one 8-bit pixel.  On failure, clean up and </span>
<span style="color: #666666; font-style: italic">	     	* return NULL.</span>
<span style="color: #666666; font-style: italic">	     	*/</span>
	    	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fread (<span style="color: #333333">&amp;</span>pixel, <span style="color: #228899; font-weight: bold">sizeof</span> (pixel), <span style="color: #6666ff; font-weight: bold">1</span>, in)) {
			free (img<span style="color: #333333">-&gt;</span>img);
			free (img);
	        (<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);
			<span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
	    }<span style="color: #666666; font-style: italic">//end for x</span>

	    <span style="color: #666666; font-style: italic">/* Store the pixel in the image data. */</span>
	    img<span style="color: #333333">-&gt;</span>img[img<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> x] <span style="color: #333333">=</span> pixel;
	}<span style="color: #666666; font-style: italic">//end for y</span>
    }

    <span style="color: #666666; font-style: italic">/* All done.  Return success. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);
    <span style="color: #228899; font-weight: bold">return</span> img;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * read_photo</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Read size and pixel data in 5:6:5 RGB format from a</span>
<span style="color: #666666; font-style: italic"> *                photo file and create a photo structure from it.</span>
<span style="color: #666666; font-style: italic"> *                Code provided simply maps to 2:2:2 RGB.  You must</span>
<span style="color: #666666; font-style: italic"> *                replace this code with palette color selection, and</span>
<span style="color: #666666; font-style: italic"> *                must map the image pixels into the palette colors that</span>
<span style="color: #666666; font-style: italic"> *                you have defined.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: fname -- file name for input</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: pointer to newly allocated photo on success, or NULL</span>
<span style="color: #666666; font-style: italic"> *                 on failure</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: dynamically allocates memory for the photo</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">read_photo</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> fname)
{
    <span style="color: #6666ff; font-weight: bold">FILE</span><span style="color: #333333">*</span>    in;	<span style="color: #666666; font-style: italic">/* input file               */</span>
    <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> p <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;	<span style="color: #666666; font-style: italic">/* photo structure          */</span>
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> x;		<span style="color: #666666; font-style: italic">/* index over image columns */</span>
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> y;		<span style="color: #666666; font-style: italic">/* index over image rows    */</span>
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> pixel;	<span style="color: #666666; font-style: italic">/* one pixel from the file  */</span>

	<span style="color: #666666; font-style: italic">//creating variables for function</span>
  	<span style="color: #6666ff; font-weight: bold">uint16_t</span> i;

	<span style="color: #666666; font-style: italic">//initializing array for second level of octree</span>
  	<span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> LEV2_TOT_NODES; i<span style="color: #333333">++</span>)
  	{
    	level_two_array[i].count <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_two_array[i].red_total <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_two_array[i].green_total <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_two_array[i].blue_total <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_two_array[i].index <span style="color: #333333">=</span> i;
    	level_two_array[i].index_for_palette <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_two_array[i].index_level_2 <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
 	}<span style="color: #666666; font-style: italic">//end for second loop initialization</span>

 	 <span style="color: #666666; font-style: italic">//initializing array for fourth level of octree</span>
  	<span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> LEV4_TOT_NODES; i<span style="color: #333333">++</span>)
  	{

    	level_four_array[i].count <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_four_array[i].red_total <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_four_array[i].green_total <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_four_array[i].blue_total <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	level_four_array[i].index <span style="color: #333333">=</span> i;
    	level_four_array[i].index_for_palette <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    	<span style="color: #666666; font-style: italic">//index of level 2 of node from which this level 4 node</span>
    	<span style="color: #666666; font-style: italic">//is coming from, based on the index i.</span>
    	level_four_array[i].index_level_2 <span style="color: #333333">=</span> ((i <span style="color: #333333">&gt;&gt;</span> R_SHIFT_16bit) <span style="color: #333333">&lt;&lt;</span> R_SHIFT_IDX_2) <span style="color: #333333">|</span> (((i <span style="color: #333333">&gt;&gt;</span> G_SHIFT_16bit) <span style="color: #333333">&amp;</span> LEV2_MASK) <span style="color: #333333">&lt;&lt;</span> G_SHIFT_IDX_2) 
    											<span style="color: #333333">|</span> ((i <span style="color: #333333">&gt;&gt;</span> B_SHIFT_16bit) <span style="color: #333333">&amp;</span> LEV2_MASK); 	
    																										
  	}<span style="color: #666666; font-style: italic">//end for fourth loop initialization</span>

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Open the file, allocate the structure, read the header, do some</span>
<span style="color: #666666; font-style: italic">     * sanity checks on it, and allocate space to hold the photo pixels.</span>
<span style="color: #666666; font-style: italic">     * If anything fails, clean up as necessary and return NULL.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (in <span style="color: #333333">=</span> fopen (fname, <span style="background-color: #e0e0ff">&quot;r+b&quot;</span>)) <span style="color: #333333">||</span>
	<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (p <span style="color: #333333">=</span> malloc (<span style="color: #228899; font-weight: bold">sizeof</span> (<span style="color: #333333">*</span>p))) <span style="color: #333333">||</span>
	<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> (p<span style="color: #333333">-&gt;</span>img <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>) <span style="color: #333333">||</span> <span style="color: #666666; font-style: italic">/* false clause for initialization */</span>
	<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fread (<span style="color: #333333">&amp;</span>p<span style="color: #333333">-&gt;</span>hdr, <span style="color: #228899; font-weight: bold">sizeof</span> (p<span style="color: #333333">-&gt;</span>hdr), <span style="color: #6666ff; font-weight: bold">1</span>, in) <span style="color: #333333">||</span>
	MAX_PHOTO_WIDTH <span style="color: #333333">&lt;</span> p<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">||</span>
	MAX_PHOTO_HEIGHT <span style="color: #333333">&lt;</span> p<span style="color: #333333">-&gt;</span>hdr.height <span style="color: #333333">||</span>
	<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (p<span style="color: #333333">-&gt;</span>img <span style="color: #333333">=</span> malloc 
		 (p<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> p<span style="color: #333333">-&gt;</span>hdr.height <span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">sizeof</span> (p<span style="color: #333333">-&gt;</span>img[<span style="color: #6666ff; font-weight: bold">0</span>])))) {
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> p) {
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> p<span style="color: #333333">-&gt;</span>img) {
	        free (p<span style="color: #333333">-&gt;</span>img);
	    }
	    free (p);
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> in) {
	    (<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);
	}
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
    }

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Loop over rows from bottom to top.  Note that the file is stored</span>
<span style="color: #666666; font-style: italic">     * in this order, whereas in memory we store the data in the reverse</span>
<span style="color: #666666; font-style: italic">     * order (top to bottom).</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">for</span> (y <span style="color: #333333">=</span> p<span style="color: #333333">-&gt;</span>hdr.height; y<span style="color: #333333">--</span> <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span>; ) {

	<span style="color: #666666; font-style: italic">/* Loop over columns from left to right. */</span>
	<span style="color: #228899; font-weight: bold">for</span> (x <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; p<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">&gt;</span> x; x<span style="color: #333333">++</span>) {

	    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	     * Try to read one 16-bit pixel.  On failure, clean up and </span>
<span style="color: #666666; font-style: italic">	     * return NULL.</span>
<span style="color: #666666; font-style: italic">	     */</span>
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fread (<span style="color: #333333">&amp;</span>pixel, <span style="color: #228899; font-weight: bold">sizeof</span> (pixel), <span style="color: #6666ff; font-weight: bold">1</span>, in)) {
		free (p<span style="color: #333333">-&gt;</span>img);
		free (p);
	        (<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);
		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;

	    }
	    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	     * 16-bit pixel is coded as 5:6:5 RGB (5 bits red, 6 bits green,</span>
<span style="color: #666666; font-style: italic">	     * and 6 bits blue).  We change to 2:2:2, which we&#39;ve set for the</span>
<span style="color: #666666; font-style: italic">	     * game objects.  You need to use the other 192 palette colors</span>
<span style="color: #666666; font-style: italic">	     * to specialize the appearance of each photo.</span>
<span style="color: #666666; font-style: italic">	     *</span>
<span style="color: #666666; font-style: italic">	     * In this code, you need to calculate the p-&gt;palette values,</span>
<span style="color: #666666; font-style: italic">	     * which encode 6-bit RGB as arrays of three uint8_t&#39;s.  When</span>
<span style="color: #666666; font-style: italic">	     * the game puts up a photo, you should then change the palette </span>
<span style="color: #666666; font-style: italic">	     * to match the colors needed for that photo.</span>
<span style="color: #666666; font-style: italic">	     */</span>
	    <span style="color: #666666; font-style: italic">// p-&gt;img[p-&gt;hdr.width * y + x] = (((pixel &gt;&gt; 14) &lt;&lt; 4) |</span>
					<span style="color: #666666; font-style: italic">//     (((pixel &gt;&gt; 9) &amp; 0x3) &lt;&lt; 2) |</span>
					<span style="color: #666666; font-style: italic">//     ((pixel &gt;&gt; 3) &amp; 0x3));</span>
	<span style="color: #666666; font-style: italic">/******************************************************************************************************************************/</span>


		<span style="color: #6666ff; font-weight: bold">uint16_t</span> red_temp <span style="color: #333333">=</span> ((pixel <span style="color: #333333">&gt;&gt;</span> PIXEL_RED_SHIFT) <span style="color: #333333">&amp;</span> PIXEL_RB_MASK) <span style="color: #333333">&lt;&lt;</span> SHIFT_5to6;	<span style="color: #666666; font-style: italic">//saving 0000000000RRRRR0 in red temp to be reused for indexes and values</span>
		<span style="color: #6666ff; font-weight: bold">uint16_t</span> green_temp <span style="color: #333333">=</span> (pixel <span style="color: #333333">&gt;&gt;</span> PIXEL_GREEN_SHIFT) <span style="color: #333333">&amp;</span> PIXEL_6bits_RGB_MASK;			<span style="color: #666666; font-style: italic">//saving 0000000000GGGGGG</span>
		<span style="color: #6666ff; font-weight: bold">uint16_t</span> blue_temp <span style="color: #333333">=</span> (pixel <span style="color: #333333">&amp;</span> PIXEL_RB_MASK) <span style="color: #333333">&lt;&lt;</span> SHIFT_5to6;			<span style="color: #666666; font-style: italic">//saving 0000000000BBBBB0</span>

		<span style="color: #666666; font-style: italic">//getting the index number for array level 2 that corresponds to the value RRGGBB </span>
		<span style="color: #6666ff; font-weight: bold">uint16_t</span> level_2_idx <span style="color: #333333">=</span> ((red_temp <span style="color: #333333">&gt;&gt;</span> LEV2_IDX_SHIFT) <span style="color: #333333">&lt;&lt;</span> R_SHIFT_IDX_2) <span style="color: #333333">|</span> ((green_temp <span style="color: #333333">&gt;&gt;</span> LEV2_IDX_SHIFT) <span style="color: #333333">&lt;&lt;</span> G_SHIFT_IDX_2) <span style="color: #333333">|</span> (blue_temp <span style="color: #333333">&gt;&gt;</span> LEV2_IDX_SHIFT);

		<span style="color: #666666; font-style: italic">//incrementing count</span>
        level_two_array[level_2_idx].count<span style="color: #333333">++</span>;
        <span style="color: #666666; font-style: italic">//updating total color values</span>
        level_two_array[level_2_idx].red_total <span style="color: #333333">+=</span> red_temp;
        level_two_array[level_2_idx].green_total <span style="color: #333333">+=</span> green_temp;
        level_two_array[level_2_idx].blue_total <span style="color: #333333">+=</span> blue_temp;  


        <span style="color: #666666; font-style: italic">//getting index number for array level 4</span>
        <span style="color: #6666ff; font-weight: bold">uint16_t</span> level_4_idx <span style="color: #333333">=</span> ((red_temp <span style="color: #333333">&gt;&gt;</span> LEV4_IDX_SHIFT) <span style="color: #333333">&lt;&lt;</span> R_SHIFT_IDX_4) <span style="color: #333333">|</span> ((green_temp <span style="color: #333333">&gt;&gt;</span> LEV4_IDX_SHIFT) <span style="color: #333333">&lt;&lt;</span> G_SHIFT_IDX_4) <span style="color: #333333">|</span> (blue_temp <span style="color: #333333">&gt;&gt;</span> LEV4_IDX_SHIFT);

		<span style="color: #666666; font-style: italic">//incrementing count</span>
        level_four_array[level_4_idx].count<span style="color: #333333">++</span>;
        <span style="color: #666666; font-style: italic">//updating total color values</span>
        level_four_array[level_4_idx].red_total <span style="color: #333333">+=</span> red_temp;
        level_four_array[level_4_idx].green_total <span style="color: #333333">+=</span> green_temp;
        level_four_array[level_4_idx].blue_total <span style="color: #333333">+=</span> blue_temp;  


	}<span style="color: #666666; font-style: italic">//end x </span>
    }<span style="color: #666666; font-style: italic">//end y</span>

    	<span style="color: #666666; font-style: italic">//creating a copy of the array to keep an intact copy of it</span>
    	memcpy(copy_level_four_array, level_four_array, LEV4_TOT_NODES<span style="color: #333333">*</span><span style="color: #228899; font-weight: bold">sizeof</span>(<span style="color: #228899; font-weight: bold">struct</span> octree_node));
    	<span style="color: #666666; font-style: italic">//quick sorting the copy of the array</span>
    	qsort(copy_level_four_array, LEV4_TOT_NODES, <span style="color: #228899; font-weight: bold">sizeof</span>(<span style="color: #228899; font-weight: bold">struct</span> octree_node), compare_nodes);


    	
    	<span style="color: #666666; font-style: italic">//goes through the first 128 elements of the sorted array to add the colors to the palette</span>
    	<span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> LEV4_PAL_COLORS; i<span style="color: #333333">++</span>)
    	{
    		<span style="color: #228899; font-weight: bold">if</span> (copy_level_four_array[i].count <span style="color: #333333">!=</span> <span style="color: #6666ff; font-weight: bold">0</span>)
    		{
    			<span style="color: #666666; font-style: italic">//calculating average values for each RGB component</span>
    			red_avg <span style="color: #333333">=</span> copy_level_four_array[i].red_total <span style="color: #333333">/</span> copy_level_four_array[i].count;
    			green_avg <span style="color: #333333">=</span> copy_level_four_array[i].green_total <span style="color: #333333">/</span> copy_level_four_array[i].count;
        		blue_avg <span style="color: #333333">=</span> copy_level_four_array[i].blue_total <span style="color: #333333">/</span> copy_level_four_array[i].count;
        	}<span style="color: #666666; font-style: italic">//end if not divided by 0</span>

        	<span style="color: #666666; font-style: italic">//adding color to palette </span>
        	p<span style="color: #333333">-&gt;</span>palette[LEV2_PAL_COLORS<span style="color: #333333">+</span>i][R_COMPONENT] <span style="color: #333333">=</span> (red_avg <span style="color: #333333">&amp;</span> PIXEL_6bits_RGB_MASK);		<span style="color: #666666; font-style: italic">//copying red average to palette by masking 0000000000RRRRR0</span>
        	p<span style="color: #333333">-&gt;</span>palette[LEV2_PAL_COLORS<span style="color: #333333">+</span>i][G_COMPONENT] <span style="color: #333333">=</span> (green_avg <span style="color: #333333">&amp;</span> PIXEL_6bits_RGB_MASK);			
        	p<span style="color: #333333">-&gt;</span>palette[LEV2_PAL_COLORS<span style="color: #333333">+</span>i][B_COMPONENT] <span style="color: #333333">=</span> (blue_avg <span style="color: #333333">&amp;</span> PIXEL_6bits_RGB_MASK);
        	copy_level_four_array[i].index_for_palette <span style="color: #333333">=</span> VGA_OG_PAL <span style="color: #333333">+</span> i; <span style="color: #666666; font-style: italic">//the color palette will start after the 64 already set colors</span>

        	<span style="color: #666666; font-style: italic">// remove contribution</span>
        	level_two_array[level_four_array[i].index_level_2].red_total <span style="color: #333333">-=</span> level_four_array[i].red_total;
        	level_two_array[level_four_array[i].index_level_2].green_total <span style="color: #333333">-=</span> level_four_array[i].green_total;
        	level_two_array[level_four_array[i].index_level_2].blue_total <span style="color: #333333">-=</span> level_four_array[i].blue_total;
        	level_two_array[level_four_array[i].index_level_2].count <span style="color: #333333">-=</span> level_four_array[i].count;


    	}<span style="color: #666666; font-style: italic">//end for loop</span>


		<span style="color: #666666; font-style: italic">//adding the 64 remaining colors to palette</span>
		<span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> LEV2_PAL_COLORS; i<span style="color: #333333">++</span>)
		{
			<span style="color: #228899; font-weight: bold">if</span>(level_two_array[i].count <span style="color: #333333">!=</span> <span style="color: #6666ff; font-weight: bold">0</span>)
			{
				<span style="color: #666666; font-style: italic">//calculating average values for each RGB component</span>
				red_avg <span style="color: #333333">=</span> level_two_array[i].red_total <span style="color: #333333">/</span> level_two_array[i].count;
    			green_avg <span style="color: #333333">=</span> level_two_array[i].green_total <span style="color: #333333">/</span> level_two_array[i].count;
        		blue_avg <span style="color: #333333">=</span> level_two_array[i].blue_total <span style="color: #333333">/</span> level_two_array[i].count;
			}<span style="color: #666666; font-style: italic">//end if</span>

			<span style="color: #666666; font-style: italic">//adding the colors to the palette</span>
			p<span style="color: #333333">-&gt;</span>palette[i][R_COMPONENT] <span style="color: #333333">=</span> (red_avg <span style="color: #333333">&amp;</span> PIXEL_6bits_RGB_MASK);
			p<span style="color: #333333">-&gt;</span>palette[i][G_COMPONENT] <span style="color: #333333">=</span> (green_avg <span style="color: #333333">&amp;</span> PIXEL_6bits_RGB_MASK);
			p<span style="color: #333333">-&gt;</span>palette[i][B_COMPONENT] <span style="color: #333333">=</span> (blue_avg <span style="color: #333333">&amp;</span> PIXEL_6bits_RGB_MASK);
			level_two_array[i].index_for_palette <span style="color: #333333">=</span> i;
		}<span style="color: #666666; font-style: italic">//end for 64 colors</span>

		<span style="color: #666666; font-style: italic">//going to beginning  </span>
		fseek(in, <span style="color: #228899; font-weight: bold">sizeof</span>(p<span style="color: #333333">-&gt;</span>hdr), SEEK_SET);

		<span style="color: #228899; font-weight: bold">for</span> (y <span style="color: #333333">=</span> p<span style="color: #333333">-&gt;</span>hdr.height; y<span style="color: #333333">--</span> <span style="color: #333333">&gt;</span> <span style="color: #6666ff; font-weight: bold">0</span>; ) 
		{

			<span style="color: #666666; font-style: italic">/* Loop over columns from left to right. */</span>
			<span style="color: #228899; font-weight: bold">for</span> (x <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; p<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">&gt;</span> x; x<span style="color: #333333">++</span>) 
			{
	    		<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">	    		 * Try to read one 16-bit pixel.  On failure, clean up and </span>
<span style="color: #666666; font-style: italic">	     		* return NULL.</span>
<span style="color: #666666; font-style: italic">	     		*/</span>
	    		<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> fread (<span style="color: #333333">&amp;</span>pixel, <span style="color: #228899; font-weight: bold">sizeof</span> (pixel), <span style="color: #6666ff; font-weight: bold">1</span>, in)) 
	    		{
					free (p<span style="color: #333333">-&gt;</span>img);
					free (p);
	        		(<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);
					<span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
				}<span style="color: #666666; font-style: italic">//end if</span>

	    		<span style="color: #228899; font-weight: bold">else</span>
	    		{
					<span style="color: #6666ff; font-weight: bold">uint16_t</span> red_temp_four <span style="color: #333333">=</span> (pixel <span style="color: #333333">&gt;&gt;</span> PIX_R_SHIFT_4) <span style="color: #333333">&lt;&lt;</span> R_SHIFT_IDX_4;					
					<span style="color: #6666ff; font-weight: bold">uint16_t</span> green_temp_four <span style="color: #333333">=</span> ((pixel <span style="color: #333333">&gt;&gt;</span> PIX_G_SHIFT_4) <span style="color: #333333">&lt;&lt;</span> G_SHIFT_IDX_4) <span style="color: #333333">&amp;</span> G_MASK;			
					<span style="color: #6666ff; font-weight: bold">uint16_t</span> blue_temp_four <span style="color: #333333">=</span> (pixel <span style="color: #333333">&gt;&gt;</span> PIX_B_SHIFT_4 ) <span style="color: #333333">&amp;</span> B_MASK;					

					<span style="color: #666666; font-style: italic">//calculating level 4 index</span>
					<span style="color: #6666ff; font-weight: bold">uint16_t</span> level_4_idx <span style="color: #333333">=</span> (red_temp_four <span style="color: #333333">|</span> green_temp_four <span style="color: #333333">|</span> blue_temp_four);

					<span style="color: #6666ff; font-weight: bold">int</span> flag <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

					<span style="color: #228899; font-weight: bold">for</span>(i <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> LEV4_PAL_COLORS; i<span style="color: #333333">++</span>)
					{
						<span style="color: #228899; font-weight: bold">if</span>(copy_level_four_array[i].index <span style="color: #333333">==</span> level_4_idx)
						{
							<span style="color: #666666; font-style: italic">//assigning colors to pixels</span>
							p<span style="color: #333333">-&gt;</span>img[p<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> x] <span style="color: #333333">=</span> copy_level_four_array[i].index_for_palette <span style="color: #333333">+</span> LEV2_PAL_COLORS;
							<span style="color: #666666; font-style: italic">//if color assigned from level 4, color not over written by level 2 color</span>
							flag <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">1</span>;
							<span style="color: #228899; font-weight: bold">break</span>;
						}<span style="color: #666666; font-style: italic">//end if</span>

					}<span style="color: #666666; font-style: italic">//end for</span>

					<span style="color: #228899; font-weight: bold">if</span> (flag <span style="color: #333333">==</span> <span style="color: #6666ff; font-weight: bold">0</span>)
					{
						<span style="color: #6666ff; font-weight: bold">uint8_t</span> red_temp_two <span style="color: #333333">=</span> (pixel <span style="color: #333333">&gt;&gt;</span> PIX_R_SHIFT_2) <span style="color: #333333">&lt;&lt;</span> R_SHIFT_IDX_2;					
						<span style="color: #6666ff; font-weight: bold">uint8_t</span> green_temp_two <span style="color: #333333">=</span> (((pixel <span style="color: #333333">&gt;&gt;</span> PIX_G_SHIFT_2) <span style="color: #333333">&amp;</span> LEV2_MASK ) <span style="color: #333333">&lt;&lt;</span> G_SHIFT_IDX_2);			
						<span style="color: #6666ff; font-weight: bold">uint8_t</span> blue_temp_two <span style="color: #333333">=</span> (pixel <span style="color: #333333">&gt;&gt;</span> PIX_B_SHIFT_2) <span style="color: #333333">&amp;</span> LEV2_MASK;					

						<span style="color: #666666; font-style: italic">//calculating level 2 index</span>
						<span style="color: #6666ff; font-weight: bold">uint8_t</span> level_2_idx <span style="color: #333333">=</span> (red_temp_two <span style="color: #333333">|</span> green_temp_two <span style="color: #333333">|</span> blue_temp_two);
						<span style="color: #666666; font-style: italic">//assigning colors to pixels</span>
						p<span style="color: #333333">-&gt;</span>img[p<span style="color: #333333">-&gt;</span>hdr.width <span style="color: #333333">*</span> y <span style="color: #333333">+</span> x] <span style="color: #333333">=</span> level_two_array[level_2_idx].index_for_palette <span style="color: #333333">+</span> VGA_OG_PAL;
					}<span style="color: #666666; font-style: italic">//end if</span>
	    		}<span style="color: #666666; font-style: italic">//end else</span>
			}<span style="color: #666666; font-style: italic">//END FOR X</span>
		}<span style="color: #666666; font-style: italic">//END FOR Y</span>

    	<span style="color: #666666; font-style: italic">/* All done.  Return success. */</span>
    	(<span style="color: #6666ff; font-weight: bold">void</span>)fclose (in);
    	<span style="color: #228899; font-weight: bold">return</span> p;
<span style="color: #666666; font-style: italic">// p-&gt;img[p-&gt;hdr.width * y + x] = your_fucntion(pixel);</span>
}<span style="color: #666666; font-style: italic">//end read photo</span>

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> *function: compare_nodes</span>
<span style="color: #666666; font-style: italic"> *description: compares two nodes a time. this function is called when </span>
<span style="color: #666666; font-style: italic"> *				quick sort is needed. </span>
<span style="color: #666666; font-style: italic"> *input: two nodes to be compared</span>
<span style="color: #666666; font-style: italic"> *output: none</span>
<span style="color: #666666; font-style: italic"> *return value: node_b - node_a</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int</span>
<span style="color: #55eedd; font-weight: bold">compare_nodes</span>(<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #333333">*</span> a, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #333333">*</span> b)
{
	<span style="color: #228899; font-weight: bold">const</span> <span style="color: #228899; font-weight: bold">struct</span> octree_node <span style="color: #333333">*</span> node_a <span style="color: #333333">=</span> a;
	<span style="color: #228899; font-weight: bold">const</span> <span style="color: #228899; font-weight: bold">struct</span> octree_node <span style="color: #333333">*</span> node_b <span style="color: #333333">=</span> b;
	<span style="color: #228899; font-weight: bold">return</span> (node_b<span style="color: #333333">-&gt;</span>count <span style="color: #333333">-</span> node_a<span style="color: #333333">-&gt;</span>count);

}<span style="color: #666666; font-style: italic">//end compare_level_four</span>
</pre></div>  
<p></p>                
            </section>
        
        
        
        
        
        
        
        
        
            <!--photo.h-->
            <section>
            <hnew id="photo.h">photo.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * photo.h - photo display header file</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    3</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Fri Sep  9 21:45:34 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    photo.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Fri Sep  9 21:45:34 2011</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sun Sep 11 09:59:23 2011</span>
<span style="color: #666666; font-style: italic"> *		Completed initial implementation.</span>
<span style="color: #666666; font-style: italic"> *	SL	3	Wed Sep 14 21:56:08 2011</span>
<span style="color: #666666; font-style: italic"> *		Cleaned up code for distribution.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#ifndef PHOTO_H</span>
<span style="color: #557799">#define PHOTO_H</span>


<span style="color: #557799">#include &lt;stdint.h&gt;</span>

<span style="color: #557799">#include &quot;types.h&quot;</span>
<span style="color: #557799">#include &quot;modex.h&quot;</span>
<span style="color: #557799">#include &quot;photo_headers.h&quot;</span>
<span style="color: #557799">#include &quot;world.h&quot;</span>


<span style="color: #666666; font-style: italic">/* limits on allowed size of room photos and object images */</span>
<span style="color: #557799">#define MAX_PHOTO_WIDTH   1024</span>
<span style="color: #557799">#define MAX_PHOTO_HEIGHT  1024</span>
<span style="color: #557799">#define MAX_OBJECT_WIDTH  160</span>
<span style="color: #557799">#define MAX_OBJECT_HEIGHT 100</span>

<span style="color: #557799">#define PIXEL_RED_SHIFT			11</span>
<span style="color: #557799">#define PIXEL_GREEN_SHIFT		5</span>

<span style="color: #557799">#define SHIFT_5to6				1</span>

<span style="color: #557799">#define PIXEL_RB_MASK			0x1F</span>
<span style="color: #557799">#define PIXEL_6bits_RGB_MASK	0x3F</span>

<span style="color: #557799">#define LEV2_IDX_SHIFT			4</span>
<span style="color: #557799">#define LEV4_IDX_SHIFT			2</span>

<span style="color: #557799">#define R_SHIFT_IDX_2			4</span>
<span style="color: #557799">#define G_SHIFT_IDX_2			2</span>

<span style="color: #557799">#define R_SHIFT_16bit			10</span>
<span style="color: #557799">#define G_SHIFT_16bit			6</span>
<span style="color: #557799">#define B_SHIFT_16bit			2</span>

<span style="color: #557799">#define R_SHIFT_IDX_4			8</span>
<span style="color: #557799">#define G_SHIFT_IDX_4			4</span>

<span style="color: #557799">#define R_COMPONENT				0</span>
<span style="color: #557799">#define G_COMPONENT				1</span>
<span style="color: #557799">#define B_COMPONENT 			2</span>

<span style="color: #557799">#define G_MASK					0x0F0</span>
<span style="color: #557799">#define B_MASK					0x00F</span>

<span style="color: #557799">#define LEV2_MASK				0x3</span>

<span style="color: #557799">#define PIX_R_SHIFT_2			14</span>
<span style="color: #557799">#define PIX_G_SHIFT_2			9</span>
<span style="color: #557799">#define PIX_B_SHIFT_2			3</span>

<span style="color: #557799">#define PIX_R_SHIFT_4			12</span>
<span style="color: #557799">#define PIX_G_SHIFT_4			7</span>
<span style="color: #557799">#define PIX_B_SHIFT_4			1</span>

<span style="color: #557799">#define LEV4_TOT_NODES			4096</span>
<span style="color: #557799">#define LEV2_TOT_NODES			64</span>

<span style="color: #557799">#define LEV4_PAL_COLORS			128</span>
<span style="color: #557799">#define LEV2_PAL_COLORS			64</span>

<span style="color: #557799">#define VGA_OG_PAL				64</span>

<span style="color: #666666; font-style: italic">/* Fill a buffer with the pixels for a horizontal line of current room. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">fill_horiz_buffer</span> (<span style="color: #6666ff; font-weight: bold">int</span> x, <span style="color: #6666ff; font-weight: bold">int</span> y, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> buf[SCROLL_X_DIM]);

<span style="color: #666666; font-style: italic">/* Fill a buffer with the pixels for a vertical line of current room. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">fill_vert_buffer</span> (<span style="color: #6666ff; font-weight: bold">int</span> x, <span style="color: #6666ff; font-weight: bold">int</span> y, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> buf[SCROLL_Y_DIM]);

<span style="color: #666666; font-style: italic">/* Get height of object image in pixels. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint32_t</span> <span style="color: #55eedd; font-weight: bold">image_height</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> im);

<span style="color: #666666; font-style: italic">/* Get width of object image in pixels. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint32_t</span> <span style="color: #55eedd; font-weight: bold">image_width</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> im);

<span style="color: #666666; font-style: italic">/* Get height of room photo in pixels. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint32_t</span> <span style="color: #55eedd; font-weight: bold">photo_height</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> p);

<span style="color: #666666; font-style: italic">/* Get width of room photo in pixels. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint32_t</span> <span style="color: #55eedd; font-weight: bold">photo_width</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> p);

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * Prepare room for display (record pointer for use by callbacks, set up</span>
<span style="color: #666666; font-style: italic"> * VGA palette, etc.). </span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">prep_room</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r);

<span style="color: #666666; font-style: italic">/* Read object image from a file into a dynamically allocated structure. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">read_obj_image</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> fname);

<span style="color: #666666; font-style: italic">/* Read room photo from a file into a dynamically allocated structure. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">read_photo</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> fname);

<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int</span> <span style="color: #55eedd; font-weight: bold">compare_nodes</span>(<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #333333">*</span> a, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #333333">*</span> b);
<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * N.B.  I&#39;m aware that Valgrind and similar tools will report the fact that</span>
<span style="color: #666666; font-style: italic"> * I chose not to bother freeing image data before terminating the program.</span>
<span style="color: #666666; font-style: italic"> * It&#39;s probably a bad habit, but ... maybe in a future release (FIXME).</span>
<span style="color: #666666; font-style: italic"> * (The data are needed until the program terminates, and all data are freed</span>
<span style="color: #666666; font-style: italic"> * when a program terminates.)</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* PHOTO_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
        
            <!--photo_headers.h-->
            <section>
            <hnew id="photo_headers.h">photo_headers.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * photo_headers.h - header file defining image file header format structures</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    1</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Wed Sep 14 10:08:14 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    photo_headers.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Wed Sep 14 10:08:14 2011</span>
<span style="color: #666666; font-style: italic"> *		Extracted from mp2photo.c for unification purposes.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#if !defined(PHOTO_HEADERS_H)</span>
<span style="color: #557799">#define PHOTO_HEADERS_H</span>


<span style="color: #557799">#include &lt;stdint.h&gt;</span>


<span style="color: #557799">#define BMP_MAGIC      &quot;BM&quot;	</span><span style="color: #666666; font-style: italic">/* BMP file magic sequence (before header) */</span><span style="color: #557799"></span>

<span style="color: #557799">#define OBJ_CLR_TRANSP 0x40	</span><span style="color: #666666; font-style: italic">/* transparent pixel color in object image */</span><span style="color: #557799"></span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * BMP header.  This structure is deliberately incomplete: it allows code</span>
<span style="color: #666666; font-style: italic"> * to do a few sanity checks and to find the pixel data.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">bmp_header_t</span> <span style="color: #6666ff; font-weight: bold">bmp_header_t</span>;
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">bmp_header_t</span> {
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> file_size;
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> reserved;
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> pixel_offset;
    <span style="color: #666666; font-style: italic">/* DIB header follows... */</span>
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> dib_header_size;
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> img_width;
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> img_height;
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> planes;
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> bits_per_pixel;
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> compression_type;
    <span style="color: #6666ff; font-weight: bold">uint32_t</span> img_size;
    <span style="color: #666666; font-style: italic">/* We ignore the rest ... */</span>
};

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * Room photo/object image file header for the ECE391 adventure </span>
<span style="color: #666666; font-style: italic"> * game (F11 MP2).</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Room photo pixels are stored as 5:6:5-bit RGB, starting from the </span>
<span style="color: #666666; font-style: italic"> * lower left of the image (as with BMP files) scanning across the row </span>
<span style="color: #666666; font-style: italic"> * to the right, and then proceeding upwards with subsequent rows.  No </span>
<span style="color: #666666; font-style: italic"> * padding is used.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * Object image pixels are stored as 2:2:2-bit RGB, with transparent</span>
<span style="color: #666666; font-style: italic"> * pixels coded as value 0x40.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">photo_header_t</span> <span style="color: #6666ff; font-weight: bold">photo_header_t</span>;
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">photo_header_t</span> {
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> width;	<span style="color: #666666; font-style: italic">/* image width in pixels  */</span>
    <span style="color: #6666ff; font-weight: bold">uint16_t</span> height;	<span style="color: #666666; font-style: italic">/* image height in pixels */</span>
};

<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* PHOTO_HEADERS_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
        
        
            <!--text.c-->
            <section>
            <hnew id="text.c">text.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*                                  tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * text.c - font data and text to graphics conversion utility</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2004-2009 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:      Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:     2</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Thu Sep  9 22:06:29 2004</span>
<span style="color: #666666; font-style: italic"> * Filename:        text.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *  SL  1   Thu Sep  9 22:06:29 2004</span>
<span style="color: #666666; font-style: italic"> *      First written.</span>
<span style="color: #666666; font-style: italic"> *  SL  2   Sat Sep 12 13:45:33 2009</span>
<span style="color: #666666; font-style: italic"> *      Integrated original release back into main code base.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#include &lt;string.h&gt;</span>

<span style="color: #557799">#include &quot;text.h&quot;</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * These font data were read out of video memory during text mode and</span>
<span style="color: #666666; font-style: italic"> * saved here.  They could be read in the same manner at the start of a</span>
<span style="color: #666666; font-style: italic"> * game, but keeping a copy allows us to run the game to fix text mode</span>
<span style="color: #666666; font-style: italic"> * if it is broken (font data missing, usually).</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Each character is 8x16 pixels and occupies two lines in the table below.</span>
<span style="color: #666666; font-style: italic"> * Each byte represents a single bitmapped line of a single character.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> font_data[<span style="color: #6666ff; font-weight: bold">256</span>][<span style="color: #6666ff; font-weight: bold">16</span>] <span style="color: #333333">=</span> {
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x81</span>, <span style="color: #005588; font-weight: bold">0xA5</span>, <span style="color: #005588; font-weight: bold">0x81</span>, <span style="color: #005588; font-weight: bold">0x81</span>, <span style="color: #005588; font-weight: bold">0xBD</span>,
     <span style="color: #005588; font-weight: bold">0x99</span>, <span style="color: #005588; font-weight: bold">0x81</span>, <span style="color: #005588; font-weight: bold">0x81</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xC3</span>,
     <span style="color: #005588; font-weight: bold">0xE7</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0xE7</span>, <span style="color: #005588; font-weight: bold">0xE7</span>,
     <span style="color: #005588; font-weight: bold">0xE7</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>,
     <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xE7</span>, <span style="color: #005588; font-weight: bold">0xC3</span>,
     <span style="color: #005588; font-weight: bold">0xC3</span>, <span style="color: #005588; font-weight: bold">0xE7</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x42</span>,
     <span style="color: #005588; font-weight: bold">0x42</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xC3</span>, <span style="color: #005588; font-weight: bold">0x99</span>, <span style="color: #005588; font-weight: bold">0xBD</span>,
     <span style="color: #005588; font-weight: bold">0xBD</span>, <span style="color: #005588; font-weight: bold">0x99</span>, <span style="color: #005588; font-weight: bold">0xC3</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x1E</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x1A</span>, <span style="color: #005588; font-weight: bold">0x32</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x33</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xE0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7F</span>, <span style="color: #005588; font-weight: bold">0x63</span>, <span style="color: #005588; font-weight: bold">0x7F</span>, <span style="color: #005588; font-weight: bold">0x63</span>, <span style="color: #005588; font-weight: bold">0x63</span>, <span style="color: #005588; font-weight: bold">0x63</span>,
     <span style="color: #005588; font-weight: bold">0x63</span>, <span style="color: #005588; font-weight: bold">0x67</span>, <span style="color: #005588; font-weight: bold">0xE7</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0xE7</span>,
     <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x80</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xE0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xF8</span>,
     <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xE0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x80</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x1E</span>, <span style="color: #005588; font-weight: bold">0x3E</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x3E</span>,
     <span style="color: #005588; font-weight: bold">0x1E</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7F</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0x7B</span>, <span style="color: #005588; font-weight: bold">0x1B</span>,
     <span style="color: #005588; font-weight: bold">0x1B</span>, <span style="color: #005588; font-weight: bold">0x1B</span>, <span style="color: #005588; font-weight: bold">0x1B</span>, <span style="color: #005588; font-weight: bold">0x1B</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x28</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x28</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x24</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x06</span>,
     <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x86</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x86</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>,
     <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x80</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x06</span>,
     <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x1E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0x06</span>,
     <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x06</span>,
     <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x06</span>,
     <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xDE</span>, <span style="color: #005588; font-weight: bold">0xDE</span>,
     <span style="color: #005588; font-weight: bold">0xDE</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x62</span>, <span style="color: #005588; font-weight: bold">0x68</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x68</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x62</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x62</span>, <span style="color: #005588; font-weight: bold">0x68</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x68</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xDE</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3A</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x1E</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x78</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x62</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xEE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0xF6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xDE</span>, <span style="color: #005588; font-weight: bold">0xCE</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xDE</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x0C</span>,
     <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x5A</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xD6</span>,
     <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xEE</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x38</span>,
     <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x86</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x80</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xE0</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0x38</span>,
     <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x02</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>,
     <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xE0</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC0</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x64</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xE0</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>,
     <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xE0</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x78</span>,
     <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xEC</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xD6</span>,
     <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x1E</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xD6</span>,
     <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xD6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>,
     <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>,
     <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x36</span>,
     <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x6E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3E</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x10</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x64</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0xFC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0xC4</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xDE</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x1B</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xE6</span>, <span style="color: #005588; font-weight: bold">0xF6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xDE</span>,
     <span style="color: #005588; font-weight: bold">0xCE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x3E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC0</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x06</span>,
     <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x86</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC2</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0xCE</span>, <span style="color: #005588; font-weight: bold">0x9E</span>, <span style="color: #005588; font-weight: bold">0x3E</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xD8</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x36</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>,
     <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>, <span style="color: #005588; font-weight: bold">0x11</span>, <span style="color: #005588; font-weight: bold">0x44</span>},
    {<span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>, <span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>, <span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>, <span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>,
     <span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>, <span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>, <span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>, <span style="color: #005588; font-weight: bold">0x55</span>, <span style="color: #005588; font-weight: bold">0xAA</span>},
    {<span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>, <span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>, <span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>, <span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>,
     <span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>, <span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>, <span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>, <span style="color: #005588; font-weight: bold">0xDD</span>, <span style="color: #005588; font-weight: bold">0x77</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xF8</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xF8</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xF6</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xF8</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xF6</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0xF6</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0xF6</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xF6</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xF8</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xF8</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x1F</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x1F</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x1F</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x1F</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x37</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x37</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x3F</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x37</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xF7</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xF7</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x37</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x37</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xF7</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xF7</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x3F</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x1F</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x1F</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x1F</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x1F</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x3F</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>, <span style="color: #005588; font-weight: bold">0x36</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0xF8</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x1F</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>,
     <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>},
    {<span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>,
     <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>, <span style="color: #005588; font-weight: bold">0xF0</span>},
    {<span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>,
     <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0F</span>},
    {<span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0xD8</span>,
     <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x78</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xCC</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xCC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>,
     <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xD8</span>,
     <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x6C</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0xEE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x1E</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x3E</span>, <span style="color: #005588; font-weight: bold">0x66</span>,
     <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x66</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0xDB</span>,
     <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x03</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0xDB</span>, <span style="color: #005588; font-weight: bold">0xDB</span>,
     <span style="color: #005588; font-weight: bold">0xF3</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC0</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x60</span>,
     <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>,
     <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0xC6</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFE</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xFF</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x06</span>, <span style="color: #005588; font-weight: bold">0x0C</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0x30</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0E</span>, <span style="color: #005588; font-weight: bold">0x1B</span>, <span style="color: #005588; font-weight: bold">0x1B</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>},
    {<span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7E</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x76</span>, <span style="color: #005588; font-weight: bold">0xDC</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x38</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x18</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x18</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x0F</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0x0C</span>, <span style="color: #005588; font-weight: bold">0xEC</span>,
     <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x3C</span>, <span style="color: #005588; font-weight: bold">0x1C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x6C</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x70</span>, <span style="color: #005588; font-weight: bold">0xD8</span>, <span style="color: #005588; font-weight: bold">0x30</span>, <span style="color: #005588; font-weight: bold">0x60</span>, <span style="color: #005588; font-weight: bold">0xC8</span>, <span style="color: #005588; font-weight: bold">0xF8</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>,
     <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x7C</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>},
    {<span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>,
     <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>, <span style="color: #005588; font-weight: bold">0x00</span>}
};


<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * text_to_graphics_conversion</span>
<span style="color: #666666; font-style: italic"> *  DESCRIPTION: Take a string to convert the ASCII characters to the corresponding</span>
<span style="color: #666666; font-style: italic"> *               graphical images and stores them in a fixed-sized buffer</span>
<span style="color: #666666; font-style: italic"> *  INPUTS: string -- pointer to the string to convert</span>
<span style="color: #666666; font-style: italic"> *          string length -- length of the string to help center on status bar</span>
<span style="color: #666666; font-style: italic"> *  OUTPUTS: buffer holding the characters to be displayed on status bar</span>
<span style="color: #666666; font-style: italic"> *  RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *  SIDE EFFECTS: ASCII characters converted to graphical images</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">text_to_graphics_conversion</span>(<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span> status_bar_buff, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> string, <span style="color: #6666ff; font-weight: bold">int</span> string_length, <span style="color: #6666ff; font-weight: bold">int</span> room_flag, <span style="color: #6666ff; font-weight: bold">int</span> command_flag, <span style="color: #6666ff; font-weight: bold">int</span> status_msg_flag)
{
    <span style="color: #6666ff; font-weight: bold">int</span> text_offset;

    <span style="color: #6666ff; font-weight: bold">int</span> col, row, l;                                 <span style="color: #666666; font-style: italic">//loop index</span>
    <span style="color: #6666ff; font-weight: bold">int</span> ascii_val;
    <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> mask, font_data_loop;             <span style="color: #666666; font-style: italic">//creating several variables needed in this function</span>
    <span style="color: #6666ff; font-weight: bold">int</span> background_offset; 


    <span style="color: #666666; font-style: italic">//calculating the offset for each case (command: output from right side of status bar,</span>
    <span style="color: #666666; font-style: italic">//  status message: centered, and room name output on right side)</span>
    <span style="color: #228899; font-weight: bold">if</span>(room_flag)
        text_offset <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
    <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span>(command_flag)
        text_offset <span style="color: #333333">=</span> STATUS_BAR_WIDTH <span style="color: #333333">-</span> FONT_WIDTH <span style="color: #333333">*</span> string_length;
    <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span>(status_msg_flag)
        text_offset <span style="color: #333333">=</span> ((STATUS_BAR_ROOM <span style="color: #333333">-</span> string_length) <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">2</span>) <span style="color: #333333">*</span> BITS_IN_PIXEL;
    <span style="color: #228899; font-weight: bold">else</span>
        text_offset <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;



    <span style="color: #666666; font-style: italic">//going through each character of the string</span>
    <span style="color: #228899; font-weight: bold">for</span>(l <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; l <span style="color: #333333">&lt;</span> string_length; l<span style="color: #333333">++</span>)
    {
        ascii_val <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">int</span>) string[l];

        <span style="color: #666666; font-style: italic">//going through each line of ASCII value</span>
        <span style="color: #228899; font-weight: bold">for</span> (row <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; row <span style="color: #333333">&lt;</span> FONT_HEIGHT; row<span style="color: #333333">++</span>)
        {
            font_data_loop <span style="color: #333333">=</span> font_data[ascii_val][row];

            <span style="color: #666666; font-style: italic">//creating a mask with value 0x80 1000 0000 to be shifted</span>
            mask <span style="color: #333333">=</span> MASK_VAL;

            <span style="color: #666666; font-style: italic">//going through each column of ASCII value</span>
            <span style="color: #228899; font-weight: bold">for</span> (col <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; col <span style="color: #333333">&lt;</span> FONT_WIDTH; col<span style="color: #333333">++</span>)
            {
                <span style="color: #666666; font-style: italic">//calculating actual offset</span>
                background_offset <span style="color: #333333">=</span> STATUS_BAR_WIDTH <span style="color: #333333">+</span> STATUS_BAR_WIDTH <span style="color: #333333">*</span> row <span style="color: #333333">+</span> l <span style="color: #333333">*</span> BITS_IN_PIXEL <span style="color: #333333">+</span> col <span style="color: #333333">+</span> text_offset;
                
                <span style="color: #228899; font-weight: bold">if</span> (font_data_loop <span style="color: #333333">&amp;</span> mask)
                {
                    status_bar_buff[background_offset] <span style="color: #333333">=</span> FONT_COLOR;
                }<span style="color: #666666; font-style: italic">//end if</span>


                mask <span style="color: #333333">=</span> mask <span style="color: #333333">&gt;&gt;</span> <span style="color: #6666ff; font-weight: bold">1</span>; <span style="color: #666666; font-style: italic">//shifting the mask</span>

            }<span style="color: #666666; font-style: italic">//end columns</span>
        }<span style="color: #666666; font-style: italic">//end for rows</span>
    }<span style="color: #666666; font-style: italic">//end for </span>
}<span style="color: #666666; font-style: italic">//end of text_to_graphics_conversion</span>
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
        
            <!--text.h-->
            <section>
            <hnew id="text.h">text.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * text.h - font data and text to mode X conversion utility header file</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2004-2009 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    2</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Thu Sep  9 22:08:16 2004</span>
<span style="color: #666666; font-style: italic"> * Filename:	    text.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Thu Sep  9 22:08:16 2004</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Sat Sep 12 13:40:11 2009</span>
<span style="color: #666666; font-style: italic"> *		Integrated original release back into main code base.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#ifndef TEXT_H</span>
<span style="color: #557799">#define TEXT_H</span>

<span style="color: #666666; font-style: italic">/* The default VGA text mode font is 8x16 pixels. */</span>
<span style="color: #557799">#define FONT_WIDTH   8</span>
<span style="color: #557799">#define FONT_HEIGHT 16</span>

<span style="color: #557799">#define STATUS_BAR_WIDTH 320</span>
<span style="color: #557799">#define STATUS_BAR_HEIGHT 18</span>

<span style="color: #557799">#define BITS_IN_PIXEL 8</span>

<span style="color: #557799">#define MASK_VAL 0x80</span>

<span style="color: #666666; font-style: italic">/* Standard VGA text font. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> font_data[<span style="color: #6666ff; font-weight: bold">256</span>][<span style="color: #6666ff; font-weight: bold">16</span>];

<span style="color: #666666; font-style: italic">/* Convert input string to graphical image of ASCII values */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">text_to_graphics_conversion</span>(<span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span> <span style="color: #333333">*</span> status_bar_buff, <span style="color: #6666ff; font-weight: bold">unsigned</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> string, <span style="color: #6666ff; font-weight: bold">int</span> string_length, <span style="color: #6666ff; font-weight: bold">int</span> room_flag, <span style="color: #6666ff; font-weight: bold">int</span> command_flag, <span style="color: #6666ff; font-weight: bold">int</span> status_msg_flag);

<span style="color: #557799">#define STATUS_BAR_SIZE 5760 		</span><span style="color: #666666; font-style: italic">// 320 * 18 </span>
<span style="color: #557799">#define STATUS_BAR_ROOM 40 			</span><span style="color: #666666; font-style: italic">// 320/8 = length of status bar divided by 8 because each character needs 8 bytes</span>
<span style="color: #557799">#define FONT_COLOR 60</span>
<span style="color: #557799">#define BACKGROUND_COLOR 10</span>
<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* TEXT_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
            <!--types.h-->
            <section>
            <hnew id="types.h">types.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * types.h - declaration of structure types for ECE391 MP2 F11 adventure game</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    1</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Sun Sep 11 09:58:17 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    types.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Sun Sep 11 09:58:17 2011</span>
<span style="color: #666666; font-style: italic"> *		First written.</span>
<span style="color: #666666; font-style: italic"> */</span>

<span style="color: #557799">#if !defined(TYPES_H)</span>
<span style="color: #557799">#define TYPES_H</span>

<span style="color: #666666; font-style: italic">/* types defined in photo.c */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">photo_t</span> <span style="color: #6666ff; font-weight: bold">photo_t</span>;
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">image_t</span> <span style="color: #6666ff; font-weight: bold">image_t</span>;

<span style="color: #666666; font-style: italic">/* types defined in world.h */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">room_t</span> <span style="color: #6666ff; font-weight: bold">room_t</span>;
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">object_t</span> <span style="color: #6666ff; font-weight: bold">object_t</span>;

<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* TYPES_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>                
            </section>
        
        
            <!--world.c-->
            <section>
            <hnew id="world.c">world.c</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * world.c - world content source file for the ECE391 MP2 F11 adventure game</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    1</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Wed Sep 14 02:19:41 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    world.c</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Wed Sep 14 02:19:41 2011</span>
<span style="color: #666666; font-style: italic"> *		Completed initial implementation.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Thu Sep 15 00:31:40 2011</span>
<span style="color: #666666; font-style: italic"> *		Cleaned up code for distribution.</span>
<span style="color: #666666; font-style: italic"> */</span>
 

<span style="color: #557799">#include &lt;string.h&gt;</span>
<span style="color: #557799">#include &lt;strings.h&gt;</span>

<span style="color: #557799">#include &quot;assert.h&quot;</span>
<span style="color: #557799">#include &quot;photo.h&quot;</span>
<span style="color: #557799">#include &quot;world.h&quot;</span>


<span style="color: #666666; font-style: italic">/* parameters defined for this file */</span>

<span style="color: #666666; font-style: italic">/* room identifiers */</span>
<span style="color: #228899; font-weight: bold">enum</span> {
    R_NONE <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>,

    <span style="color: #666666; font-style: italic">/* Area 0: The Backpack */</span>
    R_INVENTORY,

    <span style="color: #666666; font-style: italic">/* Area 1: Everitt and Green Street */</span>
    R_IN_391LAB,	<span style="color: #666666; font-style: italic">/* inside the 391 lab               */</span>
    R_BY_391LAB,	<span style="color: #666666; font-style: italic">/* outside of the 391 lab           */</span>
    R_IN_IEEE,		<span style="color: #666666; font-style: italic">/* inside the IEEE/HKN office       */</span>
    R_BY_IEEE,		<span style="color: #666666; font-style: italic">/* outside of the IEEE/HKN office   */</span>
    R_IN_395LAB,	<span style="color: #666666; font-style: italic">/* inside the 395 lab               */</span>
    R_BY_395LAB,	<span style="color: #666666; font-style: italic">/* outside of the 395 lab           */</span>
    R_EVT_STAIR,	<span style="color: #666666; font-style: italic">/* Everitt Lab&#39;s eastern stairwell  */</span>
    R_IN_CLEANR,	<span style="color: #666666; font-style: italic">/* inside the cleanroom             */</span>
    R_BY_CLEANR,	<span style="color: #666666; font-style: italic">/* outside of the cleanroom         */</span>
    R_EVRT_VEND,	<span style="color: #666666; font-style: italic">/* near the Everitt vending machine */</span>
    R_ALMAMATER,	<span style="color: #666666; font-style: italic">/* near the Alma Mater statue       */</span>
    R_IN_COCOMR,	<span style="color: #666666; font-style: italic">/* inside of Cocomero               */</span>
    R_BY_COCOMR,	<span style="color: #666666; font-style: italic">/* just outside of Cocomero         */</span>
    R_BY_ZAS,		<span style="color: #666666; font-style: italic">/* across from the ruins of Za&#39;s    */</span>
    R_EAST_EVRT,	<span style="color: #666666; font-style: italic">/* East entrance of Everitt Lab     */</span>
    R_EVRT_BSMT,	<span style="color: #666666; font-style: italic">/* entrance to Everitt Lab basement */</span>

    <span style="color: #666666; font-style: italic">/* Area 2: Bardeen Quad and Environs */</span>
    R_WEST_BONE,	<span style="color: #666666; font-style: italic">/* looking West along the Boneyard   */</span>
    R_CIRCLE_N,		<span style="color: #666666; font-style: italic">/* Boneyard Bridge looking North     */</span>
    R_CIRCLE_SW,	<span style="color: #666666; font-style: italic">/* Boneyard Bridge looking Southwest */</span>
    R_EAST_BONE,	<span style="color: #666666; font-style: italic">/* looking East along the Boneyard   */</span>
    R_BARDEEN,		<span style="color: #666666; font-style: italic">/* Bardeen Quad                      */</span>
    R_LIB_BACK,		<span style="color: #666666; font-style: italic">/* rear of Grainger library          */</span>
    R_RESERVE,		<span style="color: #666666; font-style: italic">/* Grainger reserve desk             */</span>
    R_TALBOT_NW,	<span style="color: #666666; font-style: italic">/* looking Northwest at Talbot       */</span>
    R_TALBOT_SW,	<span style="color: #666666; font-style: italic">/* looking Southwest at Talbot       */</span>
    R_TALBOT,		<span style="color: #666666; font-style: italic">/* inside Talbot Laboratory          */</span>
    R_SPRINGFLD,	<span style="color: #666666; font-style: italic">/* looking West along Springfield    */</span>
    R_CARIBOU,		<span style="color: #666666; font-style: italic">/* the Caribou coffee shop           */</span>
    R_KENNEY,		<span style="color: #666666; font-style: italic">/* Kenney Gym                        */</span>
    R_DCL,		<span style="color: #666666; font-style: italic">/* Digital Computer Laboratory       */</span>
    R_LIB_FRONT,	<span style="color: #666666; font-style: italic">/* front of Grainger library         */</span>

    <span style="color: #666666; font-style: italic">/* Area 3: CSL and Environs */</span>
    R_KENNEY_E,		<span style="color: #666666; font-style: italic">/* East of Kenney Gym                */</span>
    R_NEWMARK,		<span style="color: #666666; font-style: italic">/* Newmark Laboratory                */</span>
    R_MNTL_NW,		<span style="color: #666666; font-style: italic">/* looking Northwest at MNTL         */</span>
    R_MNTL_SW,		<span style="color: #666666; font-style: italic">/* looking Southwest at MNTL         */</span>
    R_MNTLLOBBY,	<span style="color: #666666; font-style: italic">/* the lobby of MNTL                 */</span>
    R_MNTL_LAB1,	<span style="color: #666666; font-style: italic">/* a laboratory within MNTL (#1)     */</span>
    R_MNTL_LAB2,	<span style="color: #666666; font-style: italic">/* a laboratory within MNTL (#2)     */</span>
    R_MNTL_LAB3,	<span style="color: #666666; font-style: italic">/* a laboratory within MNTL (#3)     */</span>
    R_CSL_VIEW, 	<span style="color: #666666; font-style: italic">/* Coordinated Science Laboratory    */</span>
    R_CSL_DOOR,		<span style="color: #666666; font-style: italic">/* the CSL main entrance             */</span>
    R_CSL_LOBBY,	<span style="color: #666666; font-style: italic">/* in the CSL lobby                  */</span>
    R_CSL_UPPER,	<span style="color: #666666; font-style: italic">/* on an upper floor of CSL          */</span>
    R_CSLLOUNGE,	<span style="color: #666666; font-style: italic">/* in the new CSL lounge area        */</span>
    R_BECK_LOT,		<span style="color: #666666; font-style: italic">/* the Beckman Circle parking lot    */</span>
    R_BECKMAN,		<span style="color: #666666; font-style: italic">/* the Beckman Institute             */</span>
    R_BECK_DOOR,	<span style="color: #666666; font-style: italic">/* Beckman main entrance             */</span>
    R_BECKLOBBY,	<span style="color: #666666; font-style: italic">/* in the lobby of Beckman           */</span>
    R_BECK_MRI,		<span style="color: #666666; font-style: italic">/* an MRI machine ... somewhere      */</span>

    <span style="color: #666666; font-style: italic">/* Area 4: The Rest of the World, Featuring the Remote Sensing Lab */</span>
    R_GARAGE,		<span style="color: #666666; font-style: italic">/* the campus parking structure      */</span>
    R_CAR_SITE,		<span style="color: #666666; font-style: italic">/* the (fictitious) ECE391 car       */</span>
    R_ALLERTON,		<span style="color: #666666; font-style: italic">/* the Allerton mansion              */</span>
    R_FU_DOGS,		<span style="color: #666666; font-style: italic">/* the Fu dogs at Allerton           */</span>
    R_STATUE,		<span style="color: #666666; font-style: italic">/* a statue near the Fu dogs         */</span>
    R_SUNSINGER,	<span style="color: #666666; font-style: italic">/* the Allerton Sun Singer statue    */</span>
    R_WILLARD,		<span style="color: #666666; font-style: italic">/* Willard Airport fountain view     */</span>
    R_WILL_SIDE,	<span style="color: #666666; font-style: italic">/* side view of Willard and tower    */</span>
    R_REM_PLANE,	<span style="color: #666666; font-style: italic">/* a sensor-laden plane              */</span>
    R_COCKPIT,		<span style="color: #666666; font-style: italic">/* cockpit of remote sensing plane   */</span>
    R_OVER_WILL,	<span style="color: #666666; font-style: italic">/* flying above Willard Airport      */</span> 
    R_AIR_RIO,		<span style="color: #666666; font-style: italic">/* view of Rio de Janeiro from air   */</span>
    R_REM_ICE,		<span style="color: #666666; font-style: italic">/* the ice fields near rem. sen. lab */</span>
    R_REM_LAB,		<span style="color: #666666; font-style: italic">/* part of a remote sensing lab      */</span>

    N_ROOMS
};

<span style="color: #666666; font-style: italic">/* object identifiers */</span>
<span style="color: #228899; font-weight: bold">enum</span> {
    O_NONE <span style="color: #333333">=</span> <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>,

    O_BOARD,		<span style="color: #666666; font-style: italic">/* a motorized mountain board                 */</span>
    O_JETPACK,		<span style="color: #666666; font-style: italic">/* Buzz Lightyear: to Infinity ...            */</span>
    O_TUX,		<span style="color: #666666; font-style: italic">/* Tux: our mascot                            */</span>
    O_MP2,		<span style="color: #666666; font-style: italic">/* the MP2 specification (covers mode X)      */</span>
    O_BOOK_C,		<span style="color: #666666; font-style: italic">/* the C programming language                 */</span>
    O_BOOK_WODE,	<span style="color: #666666; font-style: italic">/* stories by P.G. Wodehouse                  */</span>
    O_GPS_BAD,		<span style="color: #666666; font-style: italic">/* a malfunctioning GPS device                */</span>
    O_GPS_GOOD,		<span style="color: #666666; font-style: italic">/* a working GPS device                       */</span>
    O_GPS_SPEC,		<span style="color: #666666; font-style: italic">/* GPS chip data sheet (specifications)       */</span>
    O_BUNNYSUIT,	<span style="color: #666666; font-style: italic">/* a pink bunny suit                          */</span>
    O_BATT_EMPTY,	<span style="color: #666666; font-style: italic">/* an uncharged car battery                   */</span>
    O_BATT_FULL,	<span style="color: #666666; font-style: italic">/* a fully charged car battery                */</span>
    O_BATT_CAR,		<span style="color: #666666; font-style: italic">/* battery as it appears in the car           */</span>
    O_MTN_DEW,		<span style="color: #666666; font-style: italic">/* a bottle of dew                            */</span>
    O_FISH,		<span style="color: #666666; font-style: italic">/* a fish to lure penguins                    */</span>
    O_ICARD,		<span style="color: #666666; font-style: italic">/* an I-card                                  */</span>
    O_CAR_KEY,		<span style="color: #666666; font-style: italic">/* the keys to a car                          */</span>
    O_ROBOT_DEAD,	<span style="color: #666666; font-style: italic">/* a buggy lockpicking robot                  */</span>
    O_ROBOT_LIVE,	<span style="color: #666666; font-style: italic">/* lockpicking robot with new control program */</span>
    O_MIMO_CARD,	<span style="color: #666666; font-style: italic">/* a MIMO card for planes                     */</span>

    N_OBJECTS
};

<span style="color: #666666; font-style: italic">/* flag identifiers for recording the player&#39;s accomplishments */</span>
<span style="color: #228899; font-weight: bold">enum</span> {
    FLAG_HAS_EATEN,	<span style="color: #666666; font-style: italic">/* player has eaten something         */</span>
    FLAG_WEARING_SUIT,	<span style="color: #666666; font-style: italic">/* player is wearing a bunny suit     */</span>
    FLAG_CAR_OPEN,	<span style="color: #666666; font-style: italic">/* player has managed to open the car */</span>
    FLAG_CAR_FIXED,	<span style="color: #666666; font-style: italic">/* player has fixed the car           */</span>
    FLAG_LURED_TUX, 	<span style="color: #666666; font-style: italic">/* player has lured Tux to their side */</span>
    NUM_FLAGS
};

<span style="color: #666666; font-style: italic">/* identifiers for rooms with photo swapping */</span>
<span style="color: #228899; font-weight: bold">enum</span> {
    SWAP_CIRCLE,	<span style="color: #666666; font-style: italic">/* Boneyard Creek Bridge photo swap */</span>
    SWAP_CAR,		<span style="color: #666666; font-style: italic">/* open/closed hood                 */</span>
    N_SWAPS
};


<span style="color: #666666; font-style: italic">/* types local to this file (declared in types.h) */</span>

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * The structure representing a room in the world.  The backpack/inventory </span>
<span style="color: #666666; font-style: italic"> * is also a &#39;room&#39; (#0, R_INVENTORY). </span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">room_t</span> {
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> name;		<span style="color: #666666; font-style: italic">/* name of room                   */</span>
    <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span>    view;		<span style="color: #666666; font-style: italic">/* photo currently shown for room */</span>
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span>   contents; 	<span style="color: #666666; font-style: italic">/* linked list of objects in room */</span>
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>     left;   	<span style="color: #666666; font-style: italic">/* room to the &quot;left&quot;             */</span>
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>     enter;  	<span style="color: #666666; font-style: italic">/* doors, etc.                    */</span>
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>     right;  	<span style="color: #666666; font-style: italic">/* room to the &quot;right&quot;            */</span>
};

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * The structure representing an object in the world.  Objects are</span>
<span style="color: #666666; font-style: italic"> * unique, which prevents players from drinking too much Dew (they&#39;re</span>
<span style="color: #666666; font-style: italic"> * all the same bottle!).  Sorry.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">object_t</span> {
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span>  name;		<span style="color: #666666; font-style: italic">/* name of object                 */</span>
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span>    next;		<span style="color: #666666; font-style: italic">/* linked list of room contents   */</span>
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>      loc;      	<span style="color: #666666; font-style: italic">/* in what &#39;room&#39;?                */</span>
    <span style="color: #6666ff; font-weight: bold">uint16_t</span>     x, y;    	<span style="color: #666666; font-style: italic">/* location within room photo     */</span>
    <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span>     img;     	<span style="color: #666666; font-style: italic">/* image for use in room          */</span>
};

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * This local structure is used to specify room connectivity and data </span>
<span style="color: #666666; font-style: italic"> * in a reasonably manageable way.  The array entries in the database</span>
<span style="color: #666666; font-style: italic"> * specify the room id, name, filename, and connections to other</span>
<span style="color: #666666; font-style: italic"> * rooms by symbolic name.  Since there are many rooms, trying to</span>
<span style="color: #666666; font-style: italic"> * keep the order between the enumeration of symbolic names and the</span>
<span style="color: #666666; font-style: italic"> * array entries can be tricky.  Instead, we associate array entries</span>
<span style="color: #666666; font-style: italic"> * with specific symbolic names using the id field.  Thus, you can</span>
<span style="color: #666666; font-style: italic"> * reorder the entries in the room_data array without affecting their</span>
<span style="color: #666666; font-style: italic"> * meaning.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">room_data_t</span> <span style="color: #6666ff; font-weight: bold">room_data_t</span>;
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">room_data_t</span> {
    <span style="color: #6666ff; font-weight: bold">int32_t</span>           id;	<span style="color: #666666; font-style: italic">/* id of room being described    */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">const</span> name;	<span style="color: #666666; font-style: italic">/* name of room                  */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">const</span> filename;	<span style="color: #666666; font-style: italic">/* file name for room photo      */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>           left;	<span style="color: #666666; font-style: italic">/* id of room to &#39;left&#39;          */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>           enter;	<span style="color: #666666; font-style: italic">/* id of room reached by &#39;enter&#39; */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>           right;	<span style="color: #666666; font-style: italic">/* id of room to &#39;right&#39;         */</span>
};

<span style="color: #666666; font-style: italic">/* the room connectivity data */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_data_t</span> room_data[N_ROOMS] <span style="color: #333333">=</span> {
    <span style="color: #666666; font-style: italic">/* Area 0: The Backpack */</span>
    {R_INVENTORY, <span style="background-color: #e0e0ff">&quot;Inventory&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/backpack.photo&quot;</span>, 
                       R_NONE,      R_NONE,      R_NONE},

    <span style="color: #666666; font-style: italic">/* Area 1: Everitt and Green Street */</span>
    {R_IN_391LAB, <span style="background-color: #e0e0ff">&quot;391 Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/391lab.photo&quot;</span>, 
                       R_NONE, R_BY_391LAB,      R_NONE},
    {R_BY_391LAB, <span style="background-color: #e0e0ff">&quot;Outside of 391&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/outside391.photo&quot;</span>, 
                     R_BY_ZAS, R_IN_391LAB,   R_BY_IEEE},
    {  R_IN_IEEE, <span style="background-color: #e0e0ff">&quot;IEEE Office&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/ieee.photo&quot;</span>, 
                       R_NONE,   R_BY_IEEE,      R_NONE},
    {  R_BY_IEEE, <span style="background-color: #e0e0ff">&quot;Outside IEEE&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/byieee.photo&quot;</span>, 
                  R_BY_391LAB,   R_IN_IEEE, R_BY_395LAB},
    {R_IN_395LAB, <span style="background-color: #e0e0ff">&quot;395 Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/395lab.photo&quot;</span>, 
                       R_NONE, R_BY_395LAB,      R_NONE},
    {R_BY_395LAB, <span style="background-color: #e0e0ff">&quot;Outside of 395&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/outside395.photo&quot;</span>, 
                    R_BY_IEEE,      R_NONE, R_EVT_STAIR},
    {R_EVT_STAIR, <span style="background-color: #e0e0ff">&quot;Everitt Stairs&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/evtstair.photo&quot;</span>, 
                  R_BY_395LAB, R_EAST_EVRT, R_BY_CLEANR},
    {R_IN_CLEANR, <span style="background-color: #e0e0ff">&quot;In Cleanroom&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/cleanr.photo&quot;</span>, 
                       R_NONE, R_BY_CLEANR,      R_NONE},
    {R_BY_CLEANR, <span style="background-color: #e0e0ff">&quot;By the Cleanroom&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/outclean.photo&quot;</span>, 
                  R_EVT_STAIR,      R_NONE, R_EVRT_VEND},
    {R_EVRT_VEND, <span style="background-color: #e0e0ff">&quot;Vending Machine&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/vend.photo&quot;</span>, 
                  R_BY_CLEANR, R_EVRT_BSMT,      R_NONE},
    {R_ALMAMATER, <span style="background-color: #e0e0ff">&quot;Alma Mater&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/almamater.photo&quot;</span>, 
                  R_EAST_EVRT, R_EAST_EVRT, R_BY_COCOMR},
    {R_IN_COCOMR, <span style="background-color: #e0e0ff">&quot;Cocomero&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/incoco.photo&quot;</span>, 
                       R_NONE, R_BY_COCOMR,      R_NONE},
    {R_BY_COCOMR, <span style="background-color: #e0e0ff">&quot;Near Cocomero&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/bycoco.photo&quot;</span>, 
                  R_ALMAMATER, R_IN_COCOMR,    R_BY_ZAS},
    {R_BY_ZAS, <span style="background-color: #e0e0ff">&quot;The Ruins&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/ruins.photo&quot;</span>, 
                  R_BY_COCOMR,      R_NONE,      R_NONE},
    {R_EAST_EVRT, <span style="background-color: #e0e0ff">&quot;East of Everitt&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/eeast.photo&quot;</span>, 
                  R_ALMAMATER, R_EVT_STAIR, R_EVRT_BSMT},
    {R_EVRT_BSMT, <span style="background-color: #e0e0ff">&quot;Basement Entry&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/basement.photo&quot;</span>, 
                  R_EAST_EVRT, R_EVRT_VEND, R_CIRCLE_SW},

    <span style="color: #666666; font-style: italic">/* Area 2: Bardeen Quad and Environs */</span>
    {R_WEST_BONE, <span style="background-color: #e0e0ff">&quot;Boneyard Creek&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/bonew.photo&quot;</span>, 
                  R_CIRCLE_SW,      R_NONE,  R_CIRCLE_N},
    { R_CIRCLE_N, <span style="background-color: #e0e0ff">&quot;Boneyard Bridge&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/circlen1.photo&quot;</span>, 
                  R_WEST_BONE, R_TALBOT_NW, R_EAST_BONE},
    {R_CIRCLE_SW, <span style="background-color: #e0e0ff">&quot;Boneyard Bridge&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/circlesw.photo&quot;</span>, 
                  R_EAST_BONE, R_EVRT_BSMT,  R_CIRCLE_N},
    {R_EAST_BONE, <span style="background-color: #e0e0ff">&quot;Boneyard Creek&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/bonee.photo&quot;</span>, 
                   R_CIRCLE_N,      R_NONE, R_CIRCLE_SW},
    {  R_BARDEEN, <span style="background-color: #e0e0ff">&quot;Bardeen Quad&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/bardeen.photo&quot;</span>, 
                   R_LIB_BACK, R_EAST_BONE, R_TALBOT_SW},
    { R_LIB_BACK, <span style="background-color: #e0e0ff">&quot;Grainger Library&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/graingerback.photo&quot;</span>, 
                        R_DCL,   R_RESERVE,   R_BARDEEN},
    {  R_RESERVE, <span style="background-color: #e0e0ff">&quot;Grainger Reserves&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/reserve.photo&quot;</span>, 
                       R_NONE,  R_LIB_BACK, R_LIB_FRONT},
    {R_TALBOT_NW, <span style="background-color: #e0e0ff">&quot;Talbot Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/talbotnw.photo&quot;</span>, 
                  R_CIRCLE_SW,    R_TALBOT, R_TALBOT_SW},
    {R_TALBOT_SW, <span style="background-color: #e0e0ff">&quot;Talbot Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/talbotsw.photo&quot;</span>, 
                  R_TALBOT_NW,    R_TALBOT, R_SPRINGFLD},
    {   R_TALBOT, <span style="background-color: #e0e0ff">&quot;Talbot Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/talbot.photo&quot;</span>, 
                       R_NONE, R_TALBOT_NW,      R_NONE},
    {R_SPRINGFLD, <span style="background-color: #e0e0ff">&quot;Springfield Avenue&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/springfield.photo&quot;</span>, 
                  R_TALBOT_SW,   R_CARIBOU,    R_KENNEY},
    {  R_CARIBOU, <span style="background-color: #e0e0ff">&quot;Caribou&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/caribou.photo&quot;</span>, 
                       R_NONE, R_SPRINGFLD,      R_NONE},
    {   R_KENNEY, <span style="background-color: #e0e0ff">&quot;Kenney Gym&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/kenney.photo&quot;</span>, 
                  R_SPRINGFLD,      R_NONE,       R_DCL},
    {      R_DCL, <span style="background-color: #e0e0ff">&quot;DCL&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/dcl.photo&quot;</span>, 
                     R_KENNEY,  R_KENNEY_E, R_LIB_FRONT},
    {R_LIB_FRONT, <span style="background-color: #e0e0ff">&quot;Grainger Library&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/graingerfront.photo&quot;</span>, 
                        R_DCL,   R_RESERVE, R_TALBOT_SW},

    <span style="color: #666666; font-style: italic">/* Area 3: CSL and Environs */</span>
    { R_KENNEY_E, <span style="background-color: #e0e0ff">&quot;East of Kenney&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/kenneye.photo&quot;</span>, 
                        R_DCL,       R_DCL,   R_NEWMARK},
    {  R_NEWMARK, <span style="background-color: #e0e0ff">&quot;Newmark Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/newmark.photo&quot;</span>, 
                    R_MNTL_NW,      R_NONE,  R_KENNEY_E},
    {  R_MNTL_NW, <span style="background-color: #e0e0ff">&quot;MNTL&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mntlnw.photo&quot;</span>, 
                    R_NEWMARK, R_MNTLLOBBY,  R_CSL_VIEW},
    {  R_MNTL_SW, <span style="background-color: #e0e0ff">&quot;MNTL&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mntlsw.photo&quot;</span>, 
                    R_MNTL_NW, R_MNTLLOBBY,   R_BECKMAN},
    {R_MNTLLOBBY, <span style="background-color: #e0e0ff">&quot;Lobby of MNTL&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mntllobby.photo&quot;</span>, 
                  R_MNTL_LAB1,   R_MNTL_SW, R_MNTL_LAB2},
    {R_MNTL_LAB1, <span style="background-color: #e0e0ff">&quot;Kevin&#39;s Lab in MNTL&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mntllab1.photo&quot;</span>, 
                       R_NONE,      R_NONE, R_MNTLLOBBY},
    {R_MNTL_LAB2, <span style="background-color: #e0e0ff">&quot;MNTL Laser Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mntllab2.photo&quot;</span>, 
                  R_MNTLLOBBY, R_MNTL_LAB3,      R_NONE},
    {R_MNTL_LAB3, <span style="background-color: #e0e0ff">&quot;MNTL Laser Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mntllab3.photo&quot;</span>, 
                       R_NONE, R_MNTL_LAB2,      R_NONE},
    { R_CSL_VIEW, <span style="background-color: #e0e0ff">&quot;CSL&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/csl.photo&quot;</span>, 
                   R_BECK_LOT,  R_CSL_DOOR,   R_MNTL_NW},
    { R_CSL_DOOR, <span style="background-color: #e0e0ff">&quot;CSL Main Entrance&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/csldoor.photo&quot;</span>, 
                   R_BECK_LOT,      R_NONE,   R_MNTL_NW},
    {R_CSL_LOBBY, <span style="background-color: #e0e0ff">&quot;CSL Lobby&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/csllobby.photo&quot;</span>, 
                  R_CSL_UPPER,  R_CSL_DOOR,      R_NONE},
    {R_CSL_UPPER, <span style="background-color: #e0e0ff">&quot;Upper Floor of CSL&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/cslupper.photo&quot;</span>, 
                       R_NONE, R_CSLLOUNGE, R_CSL_LOBBY},
    {R_CSLLOUNGE, <span style="background-color: #e0e0ff">&quot;CSL Lounge&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/csllounge.photo&quot;</span>, 
                       R_NONE, R_CSL_UPPER,      R_NONE},
    { R_BECK_LOT, <span style="background-color: #e0e0ff">&quot;Beckman Circle Lot&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/becklot.photo&quot;</span>, 
                    R_BECKMAN,    R_GARAGE,  R_CSL_VIEW},
    {  R_BECKMAN, <span style="background-color: #e0e0ff">&quot;Beckman Institute&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/beckman.photo&quot;</span>, 
                    R_MNTL_SW, R_BECK_DOOR,  R_BECK_LOT},
    {R_BECK_DOOR, <span style="background-color: #e0e0ff">&quot;Beckman Institute&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/beckdoor.photo&quot;</span>, 
                    R_MNTL_SW,      R_NONE,  R_BECK_LOT},
    {R_BECKLOBBY, <span style="background-color: #e0e0ff">&quot;Beckman Lobby&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/becklobby.photo&quot;</span>, 
                       R_NONE,  R_BECK_MRI, R_BECK_DOOR},
    { R_BECK_MRI, <span style="background-color: #e0e0ff">&quot;An MRI Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/beckmri.photo&quot;</span>, 
                       R_NONE, R_BECKLOBBY,      R_NONE},

    <span style="color: #666666; font-style: italic">/* Area 4: The Rest of the World, Featuring the Remote Sensing Lab */</span>
    {   R_GARAGE, <span style="background-color: #e0e0ff">&quot;Campus Parking&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/garage.photo&quot;</span>, 
                   R_BECK_LOT,  R_CAR_SITE,      R_NONE},
    { R_CAR_SITE, <span style="background-color: #e0e0ff">&quot;Use Someone&#39;s Car?&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/carclosed.photo&quot;</span>, 
                       R_NONE,    R_GARAGE,      R_NONE},
    { R_ALLERTON, <span style="background-color: #e0e0ff">&quot;Allerton Mansion&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/allerton.photo&quot;</span>, 
                    R_FU_DOGS,      R_NONE, R_SUNSINGER},
    {  R_FU_DOGS, <span style="background-color: #e0e0ff">&quot;Fu Dog Statues&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/fudogs.photo&quot;</span>, 
                       R_NONE,    R_STATUE,  R_ALLERTON},
    {   R_STATUE, <span style="background-color: #e0e0ff">&quot;A Tall Statue&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/statue.photo&quot;</span>, 
                       R_NONE,   R_FU_DOGS,      R_NONE},
    {R_SUNSINGER, <span style="background-color: #e0e0ff">&quot;The Sun Singer&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/sunsinger.photo&quot;</span>, 
                   R_ALLERTON,      R_NONE,      R_NONE},
    {  R_WILLARD, <span style="background-color: #e0e0ff">&quot;Willard Airport&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/willard.photo&quot;</span>, 
                       R_NONE, R_WILL_SIDE,      R_NONE},
    {R_WILL_SIDE, <span style="background-color: #e0e0ff">&quot;Willard Tower&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/willardside.photo&quot;</span>, 
                  R_REM_PLANE,      R_NONE,   R_WILLARD},
    {R_REM_PLANE, <span style="background-color: #e0e0ff">&quot;Sensor-Laden Plane&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/rsenseplane.photo&quot;</span>, 
                    R_COCKPIT,      R_NONE, R_WILL_SIDE},
    {  R_COCKPIT, <span style="background-color: #e0e0ff">&quot;Plane Cockpit&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/cockpit.photo&quot;</span>, 
                       R_NONE,      R_NONE, R_REM_PLANE},
    {R_OVER_WILL, <span style="background-color: #e0e0ff">&quot;Flying over Willard&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/overwillard.photo&quot;</span>, 
                       R_NONE,   R_COCKPIT,   R_AIR_RIO},
    {  R_AIR_RIO, <span style="background-color: #e0e0ff">&quot;Rio de Janeiro&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/riofromair.photo&quot;</span>, 
                  R_OVER_WILL,      R_NONE,   R_REM_ICE},
    {  R_REM_ICE, <span style="background-color: #e0e0ff">&quot;Ice Fields&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/rsenseice.photo&quot;</span>, 
                    R_AIR_RIO,   R_REM_LAB,      R_NONE},
    {  R_REM_LAB, <span style="background-color: #e0e0ff">&quot;Remote Sensing Lab&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/rsenselab.photo&quot;</span>, 
                       R_NONE,   R_REM_ICE,      R_NONE}
};

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * This local structure is used to specify object information in a </span>
<span style="color: #666666; font-style: italic"> * reasonably manageable way.  The array entries in the database specify </span>
<span style="color: #666666; font-style: italic"> * the object id, name, filename, starting room (if any), and starting </span>
<span style="color: #666666; font-style: italic"> * location * within that room (if not random).  We use this approach for </span>
<span style="color: #666666; font-style: italic"> * the same * reason as with the rooms: to avoid the need to match the </span>
<span style="color: #666666; font-style: italic"> * order between the enumeration of symbolic names and the array entries.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">obj_data_t</span> <span style="color: #6666ff; font-weight: bold">obj_data_t</span>;
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">obj_data_t</span> {
    <span style="color: #6666ff; font-weight: bold">int32_t</span> id;			<span style="color: #666666; font-style: italic">/* object identifier                   */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">const</span> name;	<span style="color: #666666; font-style: italic">/* object keyword                      */</span>
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">const</span> filename; <span style="color: #666666; font-style: italic">/* object image file name              */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> room;		<span style="color: #666666; font-style: italic">/* starting room or R_NONE             */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> x;			<span style="color: #666666; font-style: italic">/* starting x position (-1 for random) */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> y;			<span style="color: #666666; font-style: italic">/* starting y position                 */</span>
};

<span style="color: #666666; font-style: italic">/* the object positioning data */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">obj_data_t</span> obj_data[N_OBJECTS] <span style="color: #333333">=</span> {
    {     O_BOARD, <span style="background-color: #e0e0ff">&quot;board&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/board.obj&quot;</span>, R_IN_IEEE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {   O_JETPACK, <span style="background-color: #e0e0ff">&quot;jetpack&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/jetpack.obj&quot;</span>, R_TALBOT, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {       O_TUX, <span style="background-color: #e0e0ff">&quot;tux&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/tux.obj&quot;</span>, R_REM_LAB, <span style="color: #6666ff; font-weight: bold">250</span>, <span style="color: #6666ff; font-weight: bold">100</span>},
    {       O_MP2, <span style="background-color: #e0e0ff">&quot;mp2&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mp2.obj&quot;</span>, R_CSLLOUNGE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {    O_BOOK_C, <span style="background-color: #e0e0ff">&quot;book&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/book.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    { O_BOOK_WODE, <span style="background-color: #e0e0ff">&quot;book&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/book2.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {   O_GPS_BAD, <span style="background-color: #e0e0ff">&quot;gps&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/gpsbad.obj&quot;</span>, R_TALBOT, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {  O_GPS_GOOD, <span style="background-color: #e0e0ff">&quot;gps&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/gpsgood.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {  O_GPS_SPEC, <span style="background-color: #e0e0ff">&quot;spec&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/gpsspec.obj&quot;</span>, R_CSL_UPPER, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    { O_BUNNYSUIT, <span style="background-color: #e0e0ff">&quot;bunnysuit&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/bunnysuit.obj&quot;</span>, R_ALMAMATER, <span style="color: #6666ff; font-weight: bold">230</span>, <span style="color: #6666ff; font-weight: bold">250</span>},
    {O_BATT_EMPTY, <span style="background-color: #e0e0ff">&quot;battery&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/battery.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    { O_BATT_FULL, <span style="background-color: #e0e0ff">&quot;battery&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/battery.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {  O_BATT_CAR, <span style="background-color: #e0e0ff">&quot;battery&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/batteryincar.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {   O_MTN_DEW, <span style="background-color: #e0e0ff">&quot;dew&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/dew.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {      O_FISH, <span style="background-color: #e0e0ff">&quot;fish&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/fish.obj&quot;</span>, R_EAST_BONE, <span style="color: #6666ff; font-weight: bold">80</span>, <span style="color: #6666ff; font-weight: bold">260</span>},
    {     O_ICARD, <span style="background-color: #e0e0ff">&quot;Icard&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/icard.obj&quot;</span>, R_BARDEEN, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {   O_CAR_KEY, <span style="background-color: #e0e0ff">&quot;key&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/key.obj&quot;</span>, R_CARIBOU, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {O_ROBOT_DEAD, <span style="background-color: #e0e0ff">&quot;robot&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/robot.obj&quot;</span>, R_MNTL_LAB3, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    {O_ROBOT_LIVE, <span style="background-color: #e0e0ff">&quot;robot&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/robot.obj&quot;</span>, R_NONE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>},
    { O_MIMO_CARD, <span style="background-color: #e0e0ff">&quot;mimo&quot;</span>, <span style="background-color: #e0e0ff">&quot;images/mimo.obj&quot;</span>, R_STATUE, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>, <span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span>}
};

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * Some rooms alternate between two photos.  For these rooms, we load the</span>
<span style="color: #666666; font-style: italic"> * image data for both photos once, but need an extra pointer in order to</span>
<span style="color: #666666; font-style: italic"> * keep track of the photo currently swapped out.  We use these swap data</span>
<span style="color: #666666; font-style: italic"> * to name and describe these extra photos.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">swap_data_t</span> <span style="color: #6666ff; font-weight: bold">swap_data_t</span>;
<span style="color: #228899; font-weight: bold">struct</span> <span style="color: #6666ff; font-weight: bold">swap_data_t</span> {
    <span style="color: #6666ff; font-weight: bold">int32_t</span> id;
    <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">const</span> filename;
};

<span style="color: #666666; font-style: italic">/* the swap photo descriptions */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">swap_data_t</span> swap_data[N_SWAPS] <span style="color: #333333">=</span> {
    {SWAP_CIRCLE, <span style="background-color: #e0e0ff">&quot;images/circlen2.photo&quot;</span>},	<span style="color: #666666; font-style: italic">/* alternate for Boneyard */</span>
    {SWAP_CAR, <span style="background-color: #e0e0ff">&quot;images/caropen.photo&quot;</span>}		<span style="color: #666666; font-style: italic">/* open/closed car photos */</span>
};


<span style="color: #666666; font-style: italic">/* functions local to this file--see function headers for details */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">do_photo_swap</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #6666ff; font-weight: bold">int32_t</span> which);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">find_in_room</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">insert_object_at</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> o, <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #6666ff; font-weight: bold">int32_t</span> x, <span style="color: #6666ff; font-weight: bold">int32_t</span> y);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">insert_object</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> o, <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">move_object_to_inventory</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">obj_special_get</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int32_t</span> <span style="color: #55eedd; font-weight: bold">player_flag_is_set</span> (<span style="color: #6666ff; font-weight: bold">int32_t</span> fnum);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">player_set_flag</span> (<span style="color: #6666ff; font-weight: bold">int32_t</span> fnum);
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">remove_object</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> o);


<span style="color: #666666; font-style: italic">/* file-scope variables */</span>
<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * Flags are coded as bit vectors using an array of 32-bit words.  It&#39;s </span>
<span style="color: #666666; font-style: italic"> * overkill for this game, but it&#39;s nice not to worry about the number of </span>
<span style="color: #666666; font-style: italic"> * flags...</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">room_t</span>   room[N_ROOMS];			     <span style="color: #666666; font-style: italic">/* rooms                */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">object_t</span> object[N_OBJECTS];		     <span style="color: #666666; font-style: italic">/* objects              */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">uint32_t</span> player_flags[(NUM_FLAGS <span style="color: #333333">+</span> <span style="color: #6666ff; font-weight: bold">31</span>) <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">32</span>]; <span style="color: #666666; font-style: italic">/* accomplishment flags */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> swap_photo[N_SWAPS];                 <span style="color: #666666; font-style: italic">/* swapping photos      */</span>


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * do_photo_swap</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Swap a room photo with another stored image.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- the room into which the photo is swapped</span>
<span style="color: #666666; font-style: italic"> *	     which -- index into array of stored photos</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">do_photo_swap</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #6666ff; font-weight: bold">int32_t</span> which)
{
    <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> tmp;	<span style="color: #666666; font-style: italic">/* temporary variable to help with swap */</span>

    <span style="color: #666666; font-style: italic">/* Swap the photos. */</span>
    tmp               <span style="color: #333333">=</span> r<span style="color: #333333">-&gt;</span>view;
    r<span style="color: #333333">-&gt;</span>view           <span style="color: #333333">=</span> swap_photo[which];
    swap_photo[which] <span style="color: #333333">=</span> tmp;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * find_in_room</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Find an object by name in a room.  The name must match</span>
<span style="color: #666666; font-style: italic"> *                exactly, although the match is not sensitive to case.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- the room in which to look</span>
<span style="color: #666666; font-style: italic"> *           arg -- the name of the object (a string)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: a pointer to a matching object, or NULL if none is found</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> 
<span style="color: #55eedd; font-weight: bold">find_in_room</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj;	<span style="color: #666666; font-style: italic">/* index over room contents */</span>

    <span style="color: #666666; font-style: italic">/* Loop over objects in room. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (obj <span style="color: #333333">=</span> r<span style="color: #333333">-&gt;</span>contents; <span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> obj; obj <span style="color: #333333">=</span> obj<span style="color: #333333">-&gt;</span>next) {

	<span style="color: #666666; font-style: italic">/* If we find a matching object, return it. */</span>
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (arg, obj<span style="color: #333333">-&gt;</span>name)) {
	    <span style="color: #228899; font-weight: bold">return</span> obj;
	}
    }

    <span style="color: #666666; font-style: italic">/* No object found: return NULL. */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * insert_object_at</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Place an object at a specific (x,y) location in a room.</span>
<span style="color: #666666; font-style: italic"> *                The location refers to the placement of the object in</span>
<span style="color: #666666; font-style: italic"> *                the room&#39;s photo.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: o -- the object being placed</span>
<span style="color: #666666; font-style: italic"> *           r -- the room</span>
<span style="color: #666666; font-style: italic"> *           x -- the x position for the object</span>
<span style="color: #666666; font-style: italic"> *           y -- the y position for the object</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: takes the object out of its current location</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">insert_object_at</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> o, <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #6666ff; font-weight: bold">int32_t</span> x, <span style="color: #6666ff; font-weight: bold">int32_t</span> y)
{
    <span style="color: #666666; font-style: italic">/* Remove object from its current room, if any. */</span>
    remove_object (o);

    <span style="color: #666666; font-style: italic">/* Position the object within the new room. */</span>
    o<span style="color: #333333">-&gt;</span>x <span style="color: #333333">=</span> x;
    o<span style="color: #333333">-&gt;</span>y <span style="color: #333333">=</span> y;

    <span style="color: #666666; font-style: italic">/* Now add the object to the new room&#39;s contents. */</span>
    o<span style="color: #333333">-&gt;</span>loc <span style="color: #333333">=</span> r;
    o<span style="color: #333333">-&gt;</span>next <span style="color: #333333">=</span> r<span style="color: #333333">-&gt;</span>contents;
    r<span style="color: #333333">-&gt;</span>contents <span style="color: #333333">=</span> o;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * insert_object</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Insert object at a random position within a room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: o -- the object being placed</span>
<span style="color: #666666; font-style: italic"> *           r -- the room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: takes the object out of its current location; sets </span>
<span style="color: #666666; font-style: italic"> *                 the position of the object within the new room </span>
<span style="color: #666666; font-style: italic"> *                 randomly</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span> 
<span style="color: #55eedd; font-weight: bold">insert_object</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> o, <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r)
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> space;	<span style="color: #666666; font-style: italic">/* room photo height in pixels            */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> range;	<span style="color: #666666; font-style: italic">/* number of pixels in placement interval */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> xpos;	<span style="color: #666666; font-style: italic">/* x position selected                    */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> ypos;       <span style="color: #666666; font-style: italic">/* y position selected                    */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> img_ht;     <span style="color: #666666; font-style: italic">/* object image height in pixels          */</span>


    <span style="color: #666666; font-style: italic">/* Choose a random x location. */</span>
    range <span style="color: #333333">=</span> photo_width (r<span style="color: #333333">-&gt;</span>view) <span style="color: #333333">-</span> image_width (o<span style="color: #333333">-&gt;</span>img);
    xpos <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;=</span> range <span style="color: #333333">?</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">:</span> (rand () <span style="color: #333333">%</span> range));

    <span style="color: #666666; font-style: italic">/* Place in the lowest quarter of the roo photo if the object fits... */</span>
    space <span style="color: #333333">=</span> photo_height (r<span style="color: #333333">-&gt;</span>view);
    img_ht <span style="color: #333333">=</span> image_height (o<span style="color: #333333">-&gt;</span>img);
    range <span style="color: #333333">=</span> space <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">4</span> <span style="color: #333333">-</span> img_ht;
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;=</span> range) {
	<span style="color: #666666; font-style: italic">/* Doesn&#39;t fit: try not to let the object fall off the bottom. */</span>
        range <span style="color: #333333">=</span> space <span style="color: #333333">-</span> img_ht;
	ypos <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;=</span> range <span style="color: #333333">?</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">:</span> (rand () <span style="color: #333333">%</span> range));
    } <span style="color: #228899; font-weight: bold">else</span> {
	ypos <span style="color: #333333">=</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;=</span> range <span style="color: #333333">?</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">:</span> (rand () <span style="color: #333333">%</span> range) <span style="color: #333333">+</span> (<span style="color: #6666ff; font-weight: bold">3</span> <span style="color: #333333">*</span> space) <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">4</span>);
    }

    <span style="color: #666666; font-style: italic">/* Now put the object into the room at the chosen location. */</span>
    insert_object_at (o, r, xpos, ypos);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * move_object_to_inventory</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Move an object into the player&#39;s inventory.  Try to </span>
<span style="color: #666666; font-style: italic"> *                place objects on a 3x3 grid for clarity, but place</span>
<span style="color: #666666; font-style: italic"> *                randomly if necessary.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: obj -- the object</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: takes the object out of its current location</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">move_object_to_inventory</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj)
{
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> conf;	<span style="color: #666666; font-style: italic">/* loop index over possible conflicts for a space */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>   x;	<span style="color: #666666; font-style: italic">/* loop index for 3x3 grid x positions            */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span>   y;	<span style="color: #666666; font-style: italic">/* loop index for 3x3 grid y positions            */</span>

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * This approach is asymptotically slow (N^2), but there shouldn&#39;t be </span>
<span style="color: #666666; font-style: italic">     * much in inventory, so it doesn&#39;t matter.</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">for</span> (y <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">10</span>; <span style="color: #6666ff; font-weight: bold">160</span> <span style="color: #333333">&gt;=</span> y; y <span style="color: #333333">+=</span> <span style="color: #6666ff; font-weight: bold">50</span>) {
        <span style="color: #228899; font-weight: bold">for</span> (x <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">10</span>; <span style="color: #6666ff; font-weight: bold">210</span> <span style="color: #333333">&gt;=</span> x; x <span style="color: #333333">+=</span> <span style="color: #6666ff; font-weight: bold">100</span>) {
	    <span style="color: #228899; font-weight: bold">for</span> (conf <span style="color: #333333">=</span> room[R_INVENTORY].contents; <span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> conf; 
	    	 conf <span style="color: #333333">=</span> conf<span style="color: #333333">-&gt;</span>next) {
	        <span style="color: #228899; font-weight: bold">if</span> (x <span style="color: #333333">==</span> conf<span style="color: #333333">-&gt;</span>x <span style="color: #333333">&amp;&amp;</span> y <span style="color: #333333">==</span> conf<span style="color: #333333">-&gt;</span>y) {
		    <span style="color: #228899; font-weight: bold">break</span>;
		}
	    }
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> conf) {
		insert_object_at (obj, <span style="color: #333333">&amp;</span>room[R_INVENTORY], x, y);
		<span style="color: #228899; font-weight: bold">return</span>;
	    }
	}
    }

    <span style="color: #666666; font-style: italic">/* Give up: place randomly in bottom quarter like a room. */</span>
    insert_object (obj, <span style="color: #333333">&amp;</span>room[R_INVENTORY]);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * obj_special_get</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Handle special effects &quot;get&quot; commands, in which a player</span>
<span style="color: #666666; font-style: italic"> *                gets an object that is not represented as an object_t in</span>
<span style="color: #666666; font-style: italic"> *                the room&#39;s contents.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- the room in which the &quot;get&quot; is performed</span>
<span style="color: #666666; font-style: italic"> *           arg -- the name of the object sought</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: an object to be gotten by the player, or NULL for nothing</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects or show status messages</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">obj_special_get</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #666666; font-style: italic">/* Get a book from the Grainger reference desk... */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_RESERVE] <span style="color: #333333">==</span> r <span style="color: #333333">&amp;&amp;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;book&quot;</span>, arg)) {
	<span style="color: #666666; font-style: italic">/* can only get it once... */</span>
	<span style="color: #228899; font-weight: bold">if</span> (player_flag_is_set (FLAG_HAS_EATEN)) {
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> object[O_BOOK_C].loc) {
		show_status (<span style="background-color: #e0e0ff">&quot;You check out the C book.&quot;</span>);
		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">&amp;</span>object[O_BOOK_C];
	    }
	} <span style="color: #228899; font-weight: bold">else</span> {
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> object[O_BOOK_WODE].loc) {
		show_status (<span style="background-color: #e0e0ff">&quot;Here&#39;s a nice Wodehouse collection.&quot;</span>);
		<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">&amp;</span>object[O_BOOK_WODE];
	    }
	}
    }

    <span style="color: #666666; font-style: italic">/* Pick up the car battery... */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CAR_SITE] <span style="color: #333333">==</span> r <span style="color: #333333">&amp;&amp;</span> object[O_BATT_CAR].loc <span style="color: #333333">==</span> r) {
        remove_object (<span style="color: #333333">&amp;</span>object[O_BATT_CAR]);
	<span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">&amp;</span>object[O_BATT_EMPTY];
    }

    <span style="color: #666666; font-style: italic">/* That&#39;s all, folks! */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #007722">NULL</span>;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * player_flag_is_set</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Checks whether the player has accomplished a specified task.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: fnum -- the accomplishment identifier (a FLAG_*)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 1 if the player has accomplished the task, 0 if not</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">int32_t</span>
<span style="color: #55eedd; font-weight: bold">player_flag_is_set</span> (<span style="color: #6666ff; font-weight: bold">int32_t</span> fnum)
{
    <span style="color: #228899; font-weight: bold">return</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> (player_flags[fnum <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">32</span>] <span style="color: #333333">&amp;</span> (<span style="color: #6666ff; font-weight: bold">1UL</span> <span style="color: #333333">&lt;&lt;</span> (fnum <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">32</span>))));
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * player_set_flag</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Sets the flag indicating that the player has accomplished </span>
<span style="color: #666666; font-style: italic"> *                a specified task.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: fnum -- the accomplishment identifier (a FLAG_*)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">player_set_flag</span> (<span style="color: #6666ff; font-weight: bold">int32_t</span> fnum)
{
    player_flags[fnum <span style="color: #333333">/</span> <span style="color: #6666ff; font-weight: bold">32</span>] <span style="color: #333333">|=</span> (<span style="color: #6666ff; font-weight: bold">1UL</span> <span style="color: #333333">&lt;&lt;</span> (fnum <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">32</span>));
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * remove_object</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Take an object out of its current location, leaving it</span>
<span style="color: #666666; font-style: italic"> *                in limbo (NULL location).</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: o -- the object</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: none</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">static</span> <span style="color: #6666ff; font-weight: bold">void</span>
<span style="color: #55eedd; font-weight: bold">remove_object</span> (<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> o)
{
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">**</span> find;	<span style="color: #666666; font-style: italic">/* loop index over pointers to objects in room */</span>

    <span style="color: #666666; font-style: italic">/* Is object already in limbo? */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> o<span style="color: #333333">-&gt;</span>loc) {

	<span style="color: #666666; font-style: italic">/* Remove from previous room (with safety check)... */</span>
	<span style="color: #228899; font-weight: bold">for</span> (find <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>o<span style="color: #333333">-&gt;</span>loc<span style="color: #333333">-&gt;</span>contents; <span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> <span style="color: #333333">*</span>find; find <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>(<span style="color: #333333">*</span>find)<span style="color: #333333">-&gt;</span>next) {
	    <span style="color: #228899; font-weight: bold">if</span> (o <span style="color: #333333">==</span> <span style="color: #333333">*</span>find) {
		<span style="color: #666666; font-style: italic">/* We found the predecessor!  Unlink the object. */</span>
	        <span style="color: #333333">*</span>find <span style="color: #333333">=</span> o<span style="color: #333333">-&gt;</span>next;
		<span style="color: #228899; font-weight: bold">break</span>;
	    }
	}

	<span style="color: #666666; font-style: italic">/* Mark the object&#39;s location as NULL. */</span>
	o<span style="color: #333333">-&gt;</span>loc <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;
    }
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * obj_get_x</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get x position of object within containing room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: obj -- pointer to the object</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: the object obj&#39;s x position</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint16_t</span>
<span style="color: #55eedd; font-weight: bold">obj_get_x</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj)
{
    <span style="color: #228899; font-weight: bold">return</span> obj<span style="color: #333333">-&gt;</span>x;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * obj_get_y</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get y position of object within containing room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: obj -- pointer to the object</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: the object obj&#39;s y position</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint16_t</span>
<span style="color: #55eedd; font-weight: bold">obj_get_y</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj)
{
    <span style="color: #228899; font-weight: bold">return</span> obj<span style="color: #333333">-&gt;</span>y;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * obj_image</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get image pointer for object.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: obj -- pointer to the object</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: the object obj&#39;s image pointer</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">obj_image</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj)
{
    <span style="color: #228899; font-weight: bold">return</span> obj<span style="color: #333333">-&gt;</span>img;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * obj_next</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get pointer to next object in object&#39;s room.  Use with</span>
<span style="color: #666666; font-style: italic"> *                room_contents_iterate to iterate over all objects in </span>
<span style="color: #666666; font-style: italic"> *                a room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: obj -- pointer to the object</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: the object obj&#39;s next pointer (NULL if obj is last)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">obj_next</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj)
{
    <span style="color: #228899; font-weight: bold">return</span> obj<span style="color: #333333">-&gt;</span>next;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * room_contents_iterate</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get pointer to the first object in a room.  Use with</span>
<span style="color: #666666; font-style: italic"> *                obj_next to iterate over all objects in a room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- pointer to the room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: a pointer to room r&#39;s first object (NULL when empty)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">room_contents_iterate</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r)
{
    <span style="color: #228899; font-weight: bold">return</span> r<span style="color: #333333">-&gt;</span>contents;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * room_name</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get name for a room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- pointer to the room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: the name of room r (a string)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> 
<span style="color: #55eedd; font-weight: bold">room_name</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r)
{
    <span style="color: #228899; font-weight: bold">return</span> r<span style="color: #333333">-&gt;</span>name;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * room_photo</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get room photo for a room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- pointer to the room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: a pointer to room r&#39;s photo</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">room_photo</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r)
{
    <span style="color: #228899; font-weight: bold">return</span> r<span style="color: #333333">-&gt;</span>view;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * room_photo_height</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get height of room photo in pixels for a room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- pointer to the room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: height of room r&#39;s photo in pixels</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint32_t</span> 
<span style="color: #55eedd; font-weight: bold">room_photo_height</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r)
{
    <span style="color: #228899; font-weight: bold">return</span> photo_height (r<span style="color: #333333">-&gt;</span>view);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * room_photo_width</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get width of room photo in pixels for a room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: r -- pointer to the room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: width of room r&#39;s photo in pixels</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">uint32_t</span> 
<span style="color: #55eedd; font-weight: bold">room_photo_width</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r)
{
    <span style="color: #228899; font-weight: bold">return</span> photo_width (r<span style="color: #333333">-&gt;</span>view);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * build_world</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Builds and connects the rooms, creates objects, and </span>
<span style="color: #666666; font-style: italic"> *                reads in all image data (could be done lazily with </span>
<span style="color: #666666; font-style: italic"> *                caching instead).</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 1 on success, or 0 on failure</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: prints error messages to stderr on failure</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int32_t</span>
<span style="color: #55eedd; font-weight: bold">build_world</span> ()
{
    <span style="color: #6666ff; font-weight: bold">int32_t</span> idx;	<span style="color: #666666; font-style: italic">/* index over data arrays   */</span>
    <span style="color: #6666ff; font-weight: bold">int32_t</span> which;	<span style="color: #666666; font-style: italic">/* id for current data item */</span>

    <span style="color: #666666; font-style: italic">/* Clear all accomplishment flags. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)memset (player_flags, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #228899; font-weight: bold">sizeof</span> (player_flags));

    <span style="color: #666666; font-style: italic">/* Clear room data to enable sanity check for duplication. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)memset (room, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #228899; font-weight: bold">sizeof</span> (room));

    <span style="color: #666666; font-style: italic">/* Loop over room data. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; N_ROOMS <span style="color: #333333">&gt;</span> idx; idx<span style="color: #333333">++</span>) {
	
	<span style="color: #666666; font-style: italic">/* Set the room id. */</span>
	which <span style="color: #333333">=</span> room_data[idx].id;

	<span style="color: #666666; font-style: italic">/* Check for bad and duplicate ids. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;</span> which <span style="color: #333333">||</span> N_ROOMS <span style="color: #333333">&lt;=</span> which) {
	    fputs (<span style="background-color: #e0e0ff">&quot;Bad index in room data.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, stderr);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> room[which].name) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Duplicate index %d in room data.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, which);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}

	<span style="color: #666666; font-style: italic">/* Set up the room. */</span>
        room[which].name <span style="color: #333333">=</span> room_data[idx].name;
	room[which].view <span style="color: #333333">=</span> read_photo (room_data[idx].filename);
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> room[which].view) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Can&#39;t read room photo %s.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, 
	    	     room_data[idx].filename);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}
	room[which].contents <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;
	room[which].left  <span style="color: #333333">=</span> (R_NONE <span style="color: #333333">==</span> room_data[idx].left <span style="color: #333333">?</span> <span style="color: #007722">NULL</span> <span style="color: #333333">:</span> 
			     <span style="color: #333333">&amp;</span>room[room_data[idx].left]);
	room[which].enter <span style="color: #333333">=</span> (R_NONE <span style="color: #333333">==</span> room_data[idx].enter <span style="color: #333333">?</span> <span style="color: #007722">NULL</span> <span style="color: #333333">:</span> 
			     <span style="color: #333333">&amp;</span>room[room_data[idx].enter]);
	room[which].right <span style="color: #333333">=</span> (R_NONE <span style="color: #333333">==</span> room_data[idx].right <span style="color: #333333">?</span> <span style="color: #007722">NULL</span> <span style="color: #333333">:</span> 
			     <span style="color: #333333">&amp;</span>room[room_data[idx].right]);
    }

    <span style="color: #666666; font-style: italic">/* Clear object data to enable sanity check for duplication. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)memset (object, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #228899; font-weight: bold">sizeof</span> (object));

    <span style="color: #666666; font-style: italic">/* Loop over object data. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; N_OBJECTS <span style="color: #333333">&gt;</span> idx; idx<span style="color: #333333">++</span>) {

	<span style="color: #666666; font-style: italic">/* Set the object id. */</span>
	which <span style="color: #333333">=</span> obj_data[idx].id;

	<span style="color: #666666; font-style: italic">/* Check for bad and duplicate ids. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;</span> which <span style="color: #333333">||</span> N_OBJECTS <span style="color: #333333">&lt;=</span> which) {
	    fputs (<span style="background-color: #e0e0ff">&quot;Bad index in object data.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, stderr);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> object[which].name) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Duplicate index %d in object data.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, which);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}

	<span style="color: #666666; font-style: italic">/* Set up the object. */</span>
        object[which].name <span style="color: #333333">=</span> obj_data[idx].name;
	object[which].img <span style="color: #333333">=</span> read_obj_image (obj_data[idx].filename);
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> object[which].img) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Can&#39;t read object photo %s.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, 
	    	     obj_data[idx].filename);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}
        object[which].next <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;
        object[which].loc <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;
        object[which].x <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;
        object[which].y <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>;

	<span style="color: #666666; font-style: italic">/* Insert it into a room if necessary. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (R_NONE <span style="color: #333333">!=</span> obj_data[idx].room) {
	    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">-</span><span style="color: #6666ff; font-weight: bold">1</span> <span style="color: #333333">!=</span> obj_data[idx].x) {
	        insert_object_at (<span style="color: #333333">&amp;</span>object[which], <span style="color: #333333">&amp;</span>room[obj_data[idx].room],
				  obj_data[idx].x, obj_data[idx].y);
	    } <span style="color: #228899; font-weight: bold">else</span> {
	        insert_object (<span style="color: #333333">&amp;</span>object[which], <span style="color: #333333">&amp;</span>room[obj_data[idx].room]);
	    }
	}
    }

    <span style="color: #666666; font-style: italic">/* Clear swap photo data to enable sanity check for duplication. */</span>
    (<span style="color: #6666ff; font-weight: bold">void</span>)memset (swap_photo, <span style="color: #6666ff; font-weight: bold">0</span>, <span style="color: #228899; font-weight: bold">sizeof</span> (swap_photo));

    <span style="color: #666666; font-style: italic">/* Loop over swap photo data. */</span>
    <span style="color: #228899; font-weight: bold">for</span> (idx <span style="color: #333333">=</span> <span style="color: #6666ff; font-weight: bold">0</span>; N_SWAPS <span style="color: #333333">&gt;</span> idx; idx<span style="color: #333333">++</span>) {

	<span style="color: #666666; font-style: italic">/* Set the swap photo id. */</span>
	which <span style="color: #333333">=</span> swap_data[idx].id;

	<span style="color: #666666; font-style: italic">/* Check for bad and duplicate ids. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">&gt;</span> which <span style="color: #333333">||</span> N_SWAPS <span style="color: #333333">&lt;=</span> which) {
	    fputs (<span style="background-color: #e0e0ff">&quot;Bad index in swap data.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, stderr);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> swap_photo[which]) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Duplicate index %d in swap data.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, which);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}

	<span style="color: #666666; font-style: italic">/* Read in the swap photo. */</span>
	swap_photo[which] <span style="color: #333333">=</span> read_photo (swap_data[idx].filename);
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> swap_photo[which]) {
	    fprintf (stderr, <span style="background-color: #e0e0ff">&quot;Can&#39;t read room photo %s.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\n</span><span style="background-color: #e0e0ff">&quot;</span>, 
	    	     swap_data[idx].filename);
	    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">0</span>;
	}
    }

    <span style="color: #666666; font-style: italic">/* Everything worked! */</span>
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #6666ff; font-weight: bold">1</span>;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * start_in_room</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Get a pointer to the room in which the player begins </span>
<span style="color: #666666; font-style: italic"> *                the game.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: pointer to the starting room</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>
<span style="color: #55eedd; font-weight: bold">start_in_room</span> ()
{
    <span style="color: #228899; font-weight: bold">return</span> <span style="color: #333333">&amp;</span>room[R_EAST_EVRT];
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * player_has_board</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Check whether the player has the board in inventory.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 1 if the board is in inventory, 0 if not</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int32_t</span>
<span style="color: #55eedd; font-weight: bold">player_has_board</span> ()
{
    <span style="color: #228899; font-weight: bold">return</span> (<span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">==</span> object[<span style="color: #6666ff; font-weight: bold">0</span>].loc);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * player_has_jetpack</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Check whether the player has the jetpack in inventory.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: none</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: 1 if the jetpack is in inventory, 0 if not</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: none</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">int32_t</span>
<span style="color: #55eedd; font-weight: bold">player_has_jetpack</span> ()
{
    <span style="color: #228899; font-weight: bold">return</span> (<span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">==</span> object[<span style="color: #6666ff; font-weight: bold">1</span>].loc);
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * try_to_move_left</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Try to move to the room to the &#39;left&#39;.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">try_to_move_left</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* If room exists, move into it. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> r<span style="color: #333333">-&gt;</span>left) {
        <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> r<span style="color: #333333">-&gt;</span>left;

	<span style="color: #666666; font-style: italic">/* When entering the Boneyard Circle, choose picture randomly. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CIRCLE_N] <span style="color: #333333">==</span> <span style="color: #333333">*</span>rptr <span style="color: #333333">&amp;&amp;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> (rand () <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">2</span>)) {
	    do_photo_swap (<span style="color: #333333">*</span>rptr, SWAP_CIRCLE);
	}
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[<span style="color: #6666ff; font-weight: bold">0</span>] <span style="color: #333333">==</span> r) {
	<span style="color: #666666; font-style: italic">/* Give a hint as to how to get out of inventory. */</span>
        show_status (<span style="background-color: #e0e0ff">&quot;Push &#39;home&#39; or type &#39;inventory&#39;.&quot;</span>);
    } <span style="color: #228899; font-weight: bold">else</span> {
	<span style="color: #666666; font-style: italic">/* Let the player know that the move failed. */</span>
	show_status (<span style="background-color: #e0e0ff">&quot;You can&#39;t go that way.&quot;</span>);
    }
    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * try_to_enter</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Try to &#39;enter&#39; a room from the current room.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">try_to_enter</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* If room exists, move into it. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> r<span style="color: #333333">-&gt;</span>enter) {
        <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> r<span style="color: #333333">-&gt;</span>enter;

	<span style="color: #666666; font-style: italic">/* When entering the Boneyard Circle, choose picture randomly. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CIRCLE_N] <span style="color: #333333">==</span> <span style="color: #333333">*</span>rptr <span style="color: #333333">&amp;&amp;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> (rand () <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">2</span>)) {
	    do_photo_swap (<span style="color: #333333">*</span>rptr, SWAP_CIRCLE);
	}
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Check special conditions for motion, allow motion if the </span>
<span style="color: #666666; font-style: italic">     * conditions are met, and give hints when the conditions are </span>
<span style="color: #666666; font-style: italic">     * not met. </span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_BY_CLEANR] <span style="color: #333333">==</span> r) {
	<span style="color: #228899; font-weight: bold">if</span> (player_flag_is_set (FLAG_WEARING_SUIT)) {
	    <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_IN_CLEANR];
	    <span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
	}
	show_status (<span style="background-color: #e0e0ff">&quot;You&#39;re not wearing a bunnysuit!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_BY_395LAB] <span style="color: #333333">==</span> r) {
	<span style="color: #228899; font-weight: bold">if</span> (object[O_ICARD].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
	    show_status (<span style="background-color: #e0e0ff">&quot;You swiped your Icard.&quot;</span>);
	    <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_IN_395LAB];
	    <span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
	}
	show_status (<span style="background-color: #e0e0ff">&quot;You need a valid Icard.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CSL_DOOR] <span style="color: #333333">==</span> r) {
	<span style="color: #228899; font-weight: bold">if</span> (object[O_ICARD].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
	    show_status (<span style="background-color: #e0e0ff">&quot;You swiped your Icard.&quot;</span>);
	    <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_CSL_LOBBY];
	    <span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
	}
	show_status (<span style="background-color: #e0e0ff">&quot;You need a valid Icard.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_BECK_DOOR] <span style="color: #333333">==</span> r) {
	<span style="color: #228899; font-weight: bold">if</span> (object[O_ROBOT_LIVE].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
	    show_status (<span style="background-color: #e0e0ff">&quot;The robot hand picked the lock!&quot;</span>);
	    <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_BECKLOBBY];
	    <span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
	}
	<span style="color: #228899; font-weight: bold">if</span> (object[O_ROBOT_DEAD].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Flash the robot&#39;s code again.&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
	}
	show_status (<span style="background-color: #e0e0ff">&quot;Complex lock!  Find a nanotech robot.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_MNTL_LAB1] <span style="color: #333333">==</span> r) {
        <span style="color: #666666; font-style: italic">/* Get advice from Kevin. */</span>
	<span style="color: #228899; font-weight: bold">static</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #228899; font-weight: bold">const</span> advice[<span style="color: #6666ff; font-weight: bold">8</span>] <span style="color: #333333">=</span> {
	    <span style="background-color: #e0e0ff">&quot;Kevin says, </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">Andres&#39; board is FAST!</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>,
	    <span style="background-color: #e0e0ff">&quot;Kevin asks, </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">Got a jetpack?</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>,
	    <span style="background-color: #e0e0ff">&quot;Kevin: </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">You can flash hardware in 395.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>,
	    <span style="background-color: #e0e0ff">&quot;Kevin suggests, </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">Always carry a fish.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>,
	    <span style="background-color: #e0e0ff">&quot;Kevin asks, </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">Have you done your MP2?</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>,
	    <span style="background-color: #e0e0ff">&quot;Kevin says, </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">Cocomero sells yogurt.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>,
	    <span style="background-color: #e0e0ff">&quot;Kevin asks, </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">Maybe you need a Dew?</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>,
	    <span style="background-color: #e0e0ff">&quot;Kevin: </span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">A magnet can charge a battery.</span><span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\&quot;</span><span style="background-color: #e0e0ff">&quot;</span>
	};
	show_status (advice[(rand () <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">8</span>)]);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_COCKPIT] <span style="color: #333333">==</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;A MIMO transmitter card is missing!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }

    <span style="color: #666666; font-style: italic">/* Let the player know that the move failed. */</span>
    show_status (<span style="background-color: #e0e0ff">&quot;You can&#39;t go that way.&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * try_to_move_right</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Try to move to the room to the &#39;right&#39;.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">try_to_move_right</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* If room exists, move into it. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> r<span style="color: #333333">-&gt;</span>right) {
        <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> r<span style="color: #333333">-&gt;</span>right;

	<span style="color: #666666; font-style: italic">/* When entering the Boneyard Circle, choose picture randomly. */</span>
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CIRCLE_N] <span style="color: #333333">==</span> <span style="color: #333333">*</span>rptr <span style="color: #333333">&amp;&amp;</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> (rand () <span style="color: #333333">%</span> <span style="color: #6666ff; font-weight: bold">2</span>)) {
	    do_photo_swap (<span style="color: #333333">*</span>rptr, SWAP_CIRCLE);
	}
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[<span style="color: #6666ff; font-weight: bold">0</span>] <span style="color: #333333">==</span> r) {
	<span style="color: #666666; font-style: italic">/* Give a hint as to how to get out of inventory. */</span>
        show_status (<span style="background-color: #e0e0ff">&quot;Push &#39;home&#39; or type &#39;inventory&#39;.&quot;</span>);
    } <span style="color: #228899; font-weight: bold">else</span> {
	<span style="color: #666666; font-style: italic">/* Let the player know that the move failed. */</span>
	show_status (<span style="background-color: #e0e0ff">&quot;You can&#39;t go that way.&quot;</span>);
    }
    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_buy</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;buy,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to simulate purchase of objects (sometimes obtaining an</span>
<span style="color: #666666; font-style: italic"> *                a real object, sometimes an accomplishment flag).</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to buy</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_buy</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Buy a Dew! */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;dew&quot;</span>, arg)) {
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_EVRT_VEND] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Great idea!  But ... where?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	} 
	<span style="color: #228899; font-weight: bold">if</span> (object[O_MTN_DEW].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">||</span>
	    object[O_MTN_DEW].loc <span style="color: #333333">==</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Slow down!  One at a time...&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	} 
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">!=</span> object[O_MTN_DEW].loc) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Last one get stolen?  Ok...here we go...&quot;</span>);
	} <span style="color: #228899; font-weight: bold">else</span> {
	    show_status (<span style="background-color: #e0e0ff">&quot;You buy a Dew.&quot;</span>);
	}
	move_object_to_inventory (<span style="color: #333333">&amp;</span>object[O_MTN_DEW]);
	<span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* Buy some yogurt. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;yogurt&quot;</span>, arg)) {
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_IN_COCOMR] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Cocomero doesn&#39;t deliver here.&quot;</span>);
	} <span style="color: #228899; font-weight: bold">else</span> <span style="color: #228899; font-weight: bold">if</span> (player_flag_is_set (FLAG_HAS_EATEN)) {
	    show_status (<span style="background-color: #e0e0ff">&quot;You&#39;re not hungry.&quot;</span>);
	} <span style="color: #228899; font-weight: bold">else</span> {
	    player_set_flag (FLAG_HAS_EATEN);
	    show_status (<span style="background-color: #e0e0ff">&quot;So tasty and delicious!&quot;</span>);
	}
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }

    <span style="color: #666666; font-style: italic">/* The player got too imaginative. */</span>
    show_status (<span style="background-color: #e0e0ff">&quot;Sorry, purchasing options are limited.&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_charge</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;charge&quot;.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to charge</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_charge</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Only the battery can be charged. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;battery&quot;</span>, arg)) {
        show_status (<span style="background-color: #e0e0ff">&quot;Electronic devices aren&#39;t (always) toys!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_BATT_EMPTY].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
	object[O_BATT_EMPTY].loc <span style="color: #333333">!=</span> r <span style="color: #333333">&amp;&amp;</span>
	object[O_BATT_FULL].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
	object[O_BATT_FULL].loc <span style="color: #333333">!=</span> r) {
	show_status (<span style="background-color: #e0e0ff">&quot;What battery?&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_BECK_MRI] <span style="color: #333333">!=</span> r) {
	show_status (<span style="background-color: #e0e0ff">&quot;Find a bigger magnet.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_BATT_FULL].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">||</span>
	object[O_BATT_FULL].loc <span style="color: #333333">==</span> r) {
	show_status (<span style="background-color: #e0e0ff">&quot;Don&#39;t overdo it.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    remove_object (<span style="color: #333333">&amp;</span>object[O_BATT_EMPTY]);
    move_object_to_inventory (<span style="color: #333333">&amp;</span>object[O_BATT_FULL]);
    show_status (<span style="background-color: #e0e0ff">&quot;Wow!  That&#39;s a strong magnet!&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
}

<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_do</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;do,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to do certain things...like their 391 MP2!</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to do</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_do</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_IN_391LAB] <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;You can&#39;t &#39;do&#39; anything here.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;391&quot;</span>, arg) <span style="color: #333333">&amp;&amp;</span>
	<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;mp2&quot;</span>, arg)) {
        show_status (<span style="background-color: #e0e0ff">&quot;Doing the 391 MP2 is more important!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_BOOK_C].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
        show_status (<span style="background-color: #e0e0ff">&quot;You&#39;d better get a book from Grainger.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_MP2].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
        show_status (<span style="background-color: #e0e0ff">&quot;Web&#39;s down.  Bring your own MP2.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_TUX].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_IN_391LAB]) {
        show_status (<span style="background-color: #e0e0ff">&quot;You&#39;d have better luck if Tux were here.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }

    <span style="color: #666666; font-style: italic">/* The player wins the game! */</span>
    <span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #007722">NULL</span>;
    <span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_drink</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;drink,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to drink objects.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to drink</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_drink</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* All you can drink is Dew... */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;dew&quot;</span>, arg)) {
        show_status (<span style="background-color: #e0e0ff">&quot;That sounds less refreshing than Dew.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_MTN_DEW].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
        object[O_MTN_DEW].loc <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;Uh-oh.  Hadewcinations.  Buy one soon!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    remove_object (<span style="color: #333333">&amp;</span>object[O_MTN_DEW]);
    show_status (<span style="background-color: #e0e0ff">&quot;Ahhhhhhhhhhhhhhhh...........nother?&quot;</span>);
    <span style="color: #666666; font-style: italic">/* NOT a bug.  Sorry, Dew doesn&#39;t count as a food. */</span>
    <span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_drop</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;drop,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to drop objects from their inventory into the room in</span>
<span style="color: #666666; font-style: italic"> *                which they&#39;re standing.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to drop</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_drop</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>   r;	<span style="color: #666666; font-style: italic">/* current room                        */</span>
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj;      <span style="color: #666666; font-style: italic">/* object being dropped                */</span>
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>   dest;	<span style="color: #666666; font-style: italic">/* destination room for dropped object */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Search for object to drop--it must be in the player&#39;s inventory. */</span>
    obj <span style="color: #333333">=</span> find_in_room (<span style="color: #333333">&amp;</span>room[R_INVENTORY], arg);

    <span style="color: #666666; font-style: italic">/* No luck--say so. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> obj) {
	show_status (<span style="background-color: #e0e0ff">&quot;You have no such thing.&quot;</span>);
        <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    
    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * Issue a warning to player if they seem to be trying to make use</span>
<span style="color: #666666; font-style: italic">     * of certain objects (as a hint).</span>
<span style="color: #666666; font-style: italic">     */</span>
    <span style="color: #228899; font-weight: bold">if</span> ((<span style="color: #333333">&amp;</span>object[O_BATT_FULL] <span style="color: #333333">==</span> obj <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">&amp;</span>room[R_CAR_SITE] <span style="color: #333333">==</span> r) <span style="color: #333333">||</span>
	(<span style="color: #333333">&amp;</span>object[O_MIMO_CARD] <span style="color: #333333">==</span> obj <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">&amp;</span>room[R_REM_PLANE] <span style="color: #333333">==</span> r)) {
        show_status (<span style="background-color: #e0e0ff">&quot;You may want to install it instead.&quot;</span>);
    }

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * If player is looking at inventory, object goes into the room in </span>
<span style="color: #666666; font-style: italic">     * which they&#39;re standing.</span>
<span style="color: #666666; font-style: italic">     */</span>
    dest <span style="color: #333333">=</span> (<span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">==</span> r <span style="color: #333333">?</span> room[R_INVENTORY].enter <span style="color: #333333">:</span> r);
    insert_object (obj, dest);
    <span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_fix</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;fix,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to fix objects.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to fix</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_fix</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Only the GPS can be fixed. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;gps&quot;</span>, arg)) {
        show_status (<span style="background-color: #e0e0ff">&quot;In the game, you&#39;re not as capable.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_GPS_GOOD].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">||</span>
        object[O_GPS_GOOD].loc <span style="color: #333333">==</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;It&#39;s working fine.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_GPS_BAD].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
        object[O_GPS_BAD].loc <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;Do you have a GPS?&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_IN_CLEANR] <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;You&#39;d better go to the cleanroom.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_GPS_SPEC].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
        object[O_GPS_SPEC].loc <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;Maybe you&#39;d better get a spec?&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    remove_object (<span style="color: #333333">&amp;</span>object[O_GPS_BAD]);
    remove_object (<span style="color: #333333">&amp;</span>object[O_GPS_SPEC]);
    move_object_to_inventory (<span style="color: #333333">&amp;</span>object[O_GPS_GOOD]);
    show_status (<span style="background-color: #e0e0ff">&quot;All done--wow, you&#39;re good!&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_flash</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;flash,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to flash objects with code and so forth.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to flash</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_flash</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Only the robot can be flashed. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;robot&quot;</span>, arg)) {
        show_status (<span style="background-color: #e0e0ff">&quot;Don&#39;t waste your time.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_ROBOT_DEAD].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
        object[O_ROBOT_DEAD].loc <span style="color: #333333">!=</span> r <span style="color: #333333">&amp;&amp;</span>
	object[O_ROBOT_LIVE].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
        object[O_ROBOT_LIVE].loc <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;Maybe get the robot first?&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_IN_395LAB] <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;With spit and a lemon?  Try the lab.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_ROBOT_LIVE].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">||</span>
        object[O_ROBOT_LIVE].loc <span style="color: #333333">==</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;You flash the robot&#39;s ROM again.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    remove_object (<span style="color: #333333">&amp;</span>object[O_ROBOT_DEAD]);
    move_object_to_inventory (<span style="color: #333333">&amp;</span>object[O_ROBOT_LIVE]);
    show_status (<span style="background-color: #e0e0ff">&quot;You flash it with a lockpicking code.&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_get</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;get,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to move objects in a room into their inventory.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to get</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_get</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>   r;	<span style="color: #666666; font-style: italic">/* current room                  */</span>
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span>   src;	<span style="color: #666666; font-style: italic">/* source room for object search */</span>
    <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj;	<span style="color: #666666; font-style: italic">/* object being sought           */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic">     * If player is looking at inventory, source room for object search </span>
<span style="color: #666666; font-style: italic">     * is the room in which they&#39;re standing.</span>
<span style="color: #666666; font-style: italic">     */</span>
    src <span style="color: #333333">=</span> (<span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">==</span> r <span style="color: #333333">?</span> room[R_INVENTORY].enter <span style="color: #333333">:</span> r);

    <span style="color: #666666; font-style: italic">/* Try a special effect search followed by a normal search. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> (obj <span style="color: #333333">=</span> obj_special_get (src, arg))) {
	obj <span style="color: #333333">=</span> find_in_room (src, arg);
    } 
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #007722">NULL</span> <span style="color: #333333">==</span> obj) {
	show_status (<span style="background-color: #e0e0ff">&quot;You see no such thing here.&quot;</span>);
        <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }

    <span style="color: #666666; font-style: italic">/* The player can&#39;t grab Tux! */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>object[O_TUX] <span style="color: #333333">==</span> obj <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>player_flag_is_set (FLAG_LURED_TUX)) {
        show_status (<span style="background-color: #e0e0ff">&quot;Tux must choose you!  Try using a fish.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }

    <span style="color: #666666; font-style: italic">/* Move the object into the player&#39;s inventory. */</span>
    move_object_to_inventory (obj);
    <span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_go</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;go,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to go from one place to another using room features.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of location to which to go</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_go</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Try to go to Allerton Mansion. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;allerton&quot;</span>, arg)) {
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_ALLERTON] <span style="color: #333333">==</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Kazam!  You&#39;re at Allerton!&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_WILLARD] <span style="color: #333333">!=</span> r <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">&amp;</span>room[R_CAR_SITE] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;That&#39;s quite a hike.&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">!</span>player_flag_is_set (FLAG_CAR_FIXED)) {
	    <span style="color: #228899; font-weight: bold">if</span> (player_flag_is_set (FLAG_CAR_OPEN)) {
		show_status (<span style="background-color: #e0e0ff">&quot;The car isn&#39;t working.&quot;</span>);
	    } <span style="color: #228899; font-weight: bold">else</span> {
		show_status (<span style="background-color: #e0e0ff">&quot;Do you want to use that car?&quot;</span>);
	    }
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (object[O_GPS_GOOD].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
	    <span style="color: #228899; font-weight: bold">if</span> (object[O_GPS_BAD].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
	        show_status (<span style="background-color: #e0e0ff">&quot;That&#39;s a long road with a broken GPS.&quot;</span>);
	    } <span style="color: #228899; font-weight: bold">else</span> {
	        show_status (<span style="background-color: #e0e0ff">&quot;You&#39;ll need a GPS to find that place.&quot;</span>);
	    }
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	show_status (<span style="background-color: #e0e0ff">&quot;You drive to Allerton Park.&quot;</span>);
	<span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_ALLERTON];
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* Try to go to Willard Airport. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;willard&quot;</span>, arg) <span style="color: #333333">||</span>
	<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;airport&quot;</span>, arg)) {
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_WILLARD] <span style="color: #333333">==</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Kazap!  You&#39;re at Willard!&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_ALLERTON] <span style="color: #333333">!=</span> r <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">&amp;</span>room[R_CAR_SITE] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;That&#39;s quite a hike.&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">!</span>player_flag_is_set (FLAG_CAR_FIXED)) {
	    <span style="color: #228899; font-weight: bold">if</span> (player_flag_is_set (FLAG_CAR_OPEN)) {
		show_status (<span style="background-color: #e0e0ff">&quot;The car isn&#39;t working.&quot;</span>);
	    } <span style="color: #228899; font-weight: bold">else</span> {
		show_status (<span style="background-color: #e0e0ff">&quot;Do you want to use that car?&quot;</span>);
	    }
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	show_status (<span style="background-color: #e0e0ff">&quot;You drive to Willard Airport.&quot;</span>);
	<span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_WILLARD];
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* Try to go to campus. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;campus&quot;</span>, arg)) {
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CAR_SITE] <span style="color: #333333">==</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Kazar!  You&#39;re on campus!&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
        <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_ALLERTON] <span style="color: #333333">!=</span> r <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">&amp;</span>room[R_WILLARD] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;That&#39;s quite a hike.&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	show_status (<span style="background-color: #e0e0ff">&quot;You drive back to campus.&quot;</span>);
	<span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_CAR_SITE];
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* Location unrecognized.  Say so. */</span>
    show_status (<span style="background-color: #e0e0ff">&quot;The game map lacks certain places.&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_install</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;install,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to install objects.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to install</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_install</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Try to install a battery. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;battery&quot;</span>, arg)) {
	<span style="color: #228899; font-weight: bold">if</span> (object[O_BATT_EMPTY].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
	    object[O_BATT_EMPTY].loc <span style="color: #333333">!=</span> r <span style="color: #333333">&amp;&amp;</span>
	    object[O_BATT_FULL].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
	    object[O_BATT_FULL].loc <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;What battery?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CAR_SITE] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Do you see the car?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (object[O_BATT_EMPTY].loc <span style="color: #333333">==</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">||</span>
	    object[O_BATT_EMPTY].loc <span style="color: #333333">==</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;You want to install a dead battery?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
        }
	remove_object (<span style="color: #333333">&amp;</span>object[O_BATT_FULL]);
	player_set_flag (FLAG_CAR_FIXED);
	do_photo_swap (r, SWAP_CAR);
	show_status (<span style="background-color: #e0e0ff">&quot;Nice work!  Now you can use it!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* Try to install a MIMO transmitter card. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;mimo&quot;</span>, arg) <span style="color: #333333">||</span> <span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;card&quot;</span>, arg) <span style="color: #333333">||</span>
	<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;transmitter&quot;</span>, arg)) {
	<span style="color: #228899; font-weight: bold">if</span> (object[O_MIMO_CARD].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
	    object[O_MIMO_CARD].loc <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Do you have one of those?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_COCKPIT] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Nothing here needs that.&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	remove_object (<span style="color: #333333">&amp;</span>object[O_MIMO_CARD]);
	room[R_COCKPIT].enter <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_OVER_WILL];
	show_status (<span style="background-color: #e0e0ff">&quot;Ready for takeoff, captain!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* There&#39;s nothing else that can be installed. */</span>
    show_status (<span style="background-color: #e0e0ff">&quot;What are you playing at?&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_inventory</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;inventory,&quot; which moves the</span>
<span style="color: #666666; font-style: italic"> *                player to their inventory (room #0, or R_INVENTORY) in</span>
<span style="color: #666666; font-style: italic"> *                order to inspect their carried objects.  The current </span>
<span style="color: #666666; font-style: italic"> *                room is saved in the inventory room&#39;s &#39;enter&#39; direction.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *                Typing &#39;inventory&#39; from the inventory view returns the</span>
<span style="color: #666666; font-style: italic"> *                player to the room in which they&#39;re standing.</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- takes no argument, so this parameter should be an </span>
<span style="color: #666666; font-style: italic"> *                  empty string (we don&#39;t check)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: changes player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_inventory</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">==</span> r) {
	<span style="color: #666666; font-style: italic">/* Return from inventory to previous room. */</span>
	<span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> r<span style="color: #333333">-&gt;</span>enter;
    } <span style="color: #228899; font-weight: bold">else</span> {
	<span style="color: #666666; font-style: italic">/* Record current room and enter inventory view. */</span>
	room[R_INVENTORY].enter <span style="color: #333333">=</span> r;
	<span style="color: #333333">*</span>rptr <span style="color: #333333">=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY];
    }
    <span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_sigh</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;sigh,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to show their respects for many a vanished site.  Ouch,</span>
<span style="color: #666666; font-style: italic"> *                sorry WS.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- takes no argument, so this parameter should be an </span>
<span style="color: #666666; font-style: italic"> *                  empty string (we don&#39;t check)</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_sigh</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_BY_ZAS] <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;MP2 got you down?  Take a break!&quot;</span>);
    } <span style="color: #228899; font-weight: bold">else</span> {
	show_status (<span style="background-color: #e0e0ff">&quot;So sad... you lose your appetite.&quot;</span>);
	player_set_flag (FLAG_HAS_EATEN);
    }
    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_use</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;use,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to use objects in a room or in their inventory.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to use</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_use</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Try to use a car. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;car&quot;</span>, arg)) {
    	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_ALLERTON] <span style="color: #333333">==</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Go to campus or Willard Airport?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
    	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_WILLARD] <span style="color: #333333">==</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Go to Allerton or campus?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_CAR_SITE] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;You have a car?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (player_flag_is_set (FLAG_CAR_FIXED)) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Go to Allerton or Willard Airport?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (player_flag_is_set (FLAG_CAR_OPEN)) {
	    show_status (<span style="background-color: #e0e0ff">&quot;You&#39;ll have to charge the battery.&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (object[O_CAR_KEY].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY]) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Perhaps you can find a key?&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	do_photo_swap (r, SWAP_CAR);
	remove_object (<span style="color: #333333">&amp;</span>object[O_CAR_KEY]);
	insert_object_at (<span style="color: #333333">&amp;</span>object[O_BATT_CAR], r, <span style="color: #6666ff; font-weight: bold">265</span>, <span style="color: #6666ff; font-weight: bold">122</span>);
	player_set_flag (FLAG_CAR_OPEN);
	show_status (<span style="background-color: #e0e0ff">&quot;The key works, but the battery&#39;s dead.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_CHANGE_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* Try to use a fish. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">==</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;fish&quot;</span>, arg)) {
	<span style="color: #228899; font-weight: bold">if</span> (object[O_FISH].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
	    object[O_FISH].loc <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;Using the invisible fish...no effect!&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	<span style="color: #228899; font-weight: bold">if</span> (<span style="color: #333333">&amp;</span>room[R_REM_LAB] <span style="color: #333333">!=</span> r) {
	    show_status (<span style="background-color: #e0e0ff">&quot;I don&#39;t think that&#39;s sanitary.&quot;</span>);
	    <span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
	}
	remove_object (<span style="color: #333333">&amp;</span>object[O_FISH]);
	move_object_to_inventory (<span style="color: #333333">&amp;</span>object[O_TUX]);
	player_set_flag (FLAG_LURED_TUX);
        show_status (<span style="background-color: #e0e0ff">&quot;Tux likes you!&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
    }

    <span style="color: #666666; font-style: italic">/* Don&#39;t ask.  Oh, was that YOU who tried to use that?  Uh. */</span>
    show_status (<span style="background-color: #e0e0ff">&quot;You want to use what!?&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
}


<span style="color: #666666; font-style: italic">/* </span>
<span style="color: #666666; font-style: italic"> * typed_cmd_wear</span>
<span style="color: #666666; font-style: italic"> *   DESCRIPTION: Execute the typed command &quot;wear,&quot; which allows the player</span>
<span style="color: #666666; font-style: italic"> *                to wear objects.</span>
<span style="color: #666666; font-style: italic"> *   INPUTS: *rptr -- player&#39;s current room</span>
<span style="color: #666666; font-style: italic"> *           arg -- name of object to wear</span>
<span style="color: #666666; font-style: italic"> *   OUTPUTS: *rptr -- possibly new room for player</span>
<span style="color: #666666; font-style: italic"> *   RETURN VALUE: indicates types of action taken (see header file)</span>
<span style="color: #666666; font-style: italic"> *   SIDE EFFECTS: may move objects, show status messages, change player&#39;s room</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #6666ff; font-weight: bold">tc_action_t</span>
<span style="color: #55eedd; font-weight: bold">typed_cmd_wear</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg)
{
    <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r;	<span style="color: #666666; font-style: italic">/* current room */</span>

    <span style="color: #666666; font-style: italic">/* Set current room. */</span>
    r <span style="color: #333333">=</span> <span style="color: #333333">*</span>rptr;

    <span style="color: #666666; font-style: italic">/* Only the bunnysuit can be worn. */</span>
    <span style="color: #228899; font-weight: bold">if</span> (<span style="color: #6666ff; font-weight: bold">0</span> <span style="color: #333333">!=</span> strcasecmp (<span style="background-color: #e0e0ff">&quot;bunnysuit&quot;</span>, arg)) {
        show_status (<span style="background-color: #e0e0ff">&quot;Big Brother forbids fashion statements.&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_ALLOW_EDIT;
    }
    <span style="color: #228899; font-weight: bold">if</span> (object[O_BUNNYSUIT].loc <span style="color: #333333">!=</span> <span style="color: #333333">&amp;</span>room[R_INVENTORY] <span style="color: #333333">&amp;&amp;</span>
        object[O_BUNNYSUIT].loc <span style="color: #333333">!=</span> r) {
        show_status (<span style="background-color: #e0e0ff">&quot;Do you have a bunnysuit?&quot;</span>);
	<span style="color: #228899; font-weight: bold">return</span> TC_DISCARD_TEXT;
    }
    remove_object (<span style="color: #333333">&amp;</span>object[O_BUNNYSUIT]);
    player_set_flag (FLAG_WEARING_SUIT);
    show_status (<span style="background-color: #e0e0ff">&quot;You look good in pink!&quot;</span>);
    <span style="color: #228899; font-weight: bold">return</span> TC_REDRAW_ROOM;
}
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
        
        
            <!--world.h-->
            <section>
            <hnew id="world.h">world.h</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #666666; font-style: italic">/*									tab:8</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * world.h - world content header file for the ECE391 MP2 F11 adventure game</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * &quot;Copyright (c) 2011 by Steven S. Lumetta.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Permission to use, copy, modify, and distribute this software and its</span>
<span style="color: #666666; font-style: italic"> * documentation for any purpose, without fee, and without written agreement is</span>
<span style="color: #666666; font-style: italic"> * hereby granted, provided that the above copyright notice and the following</span>
<span style="color: #666666; font-style: italic"> * two paragraphs appear in all copies of this software.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * IN NO EVENT SHALL THE AUTHOR OR THE UNIVERSITY OF ILLINOIS BE LIABLE TO </span>
<span style="color: #666666; font-style: italic"> * ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL </span>
<span style="color: #666666; font-style: italic"> * DAMAGES ARISING OUT  OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, </span>
<span style="color: #666666; font-style: italic"> * EVEN IF THE AUTHOR AND/OR THE UNIVERSITY OF ILLINOIS HAS BEEN ADVISED </span>
<span style="color: #666666; font-style: italic"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span style="color: #666666; font-style: italic"> * </span>
<span style="color: #666666; font-style: italic"> * THE AUTHOR AND THE UNIVERSITY OF ILLINOIS SPECIFICALLY DISCLAIM ANY </span>
<span style="color: #666666; font-style: italic"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF </span>
<span style="color: #666666; font-style: italic"> * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE </span>
<span style="color: #666666; font-style: italic"> * PROVIDED HEREUNDER IS ON AN &quot;AS IS&quot; BASIS, AND NEITHER THE AUTHOR NOR</span>
<span style="color: #666666; font-style: italic"> * THE UNIVERSITY OF ILLINOIS HAS ANY OBLIGATION TO PROVIDE MAINTENANCE, </span>
<span style="color: #666666; font-style: italic"> * SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.&quot;</span>
<span style="color: #666666; font-style: italic"> *</span>
<span style="color: #666666; font-style: italic"> * Author:	    Steve Lumetta</span>
<span style="color: #666666; font-style: italic"> * Version:	    1</span>
<span style="color: #666666; font-style: italic"> * Creation Date:   Tue Sep 13 23:47:11 2011</span>
<span style="color: #666666; font-style: italic"> * Filename:	    world.h</span>
<span style="color: #666666; font-style: italic"> * History:</span>
<span style="color: #666666; font-style: italic"> *	SL	1	Tue Sep 13 23:47:11 2011</span>
<span style="color: #666666; font-style: italic"> *		Completed initial implementation.</span>
<span style="color: #666666; font-style: italic"> *	SL	2	Wed Sep 14 23:17:14 2011</span>
<span style="color: #666666; font-style: italic"> *		Cleaned up code for distribution.</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #557799">#if !defined(WORLD_H)</span>
<span style="color: #557799">#define WORLD_H</span>


<span style="color: #557799">#include &quot;types.h&quot;</span>


<span style="color: #666666; font-style: italic">/* structure access functions */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint16_t</span> <span style="color: #55eedd; font-weight: bold">obj_get_x</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint16_t</span> <span style="color: #55eedd; font-weight: bold">obj_get_y</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">image_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">obj_image</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">obj_next</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> obj);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">object_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">room_contents_iterate</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">room_name</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">photo_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">room_photo</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint32_t</span> <span style="color: #55eedd; font-weight: bold">room_photo_height</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">uint32_t</span> <span style="color: #55eedd; font-weight: bold">room_photo_width</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> r);

<span style="color: #666666; font-style: italic">/* Build the game world.  Returns 0 on failure, or 1 on success. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int32_t</span> <span style="color: #55eedd; font-weight: bold">build_world</span> (<span style="color: #6666ff; font-weight: bold">void</span>);

<span style="color: #666666; font-style: italic">/* Get pointer to starting room for player. */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">*</span> <span style="color: #55eedd; font-weight: bold">start_in_room</span> (<span style="color: #6666ff; font-weight: bold">void</span>);

<span style="color: #666666; font-style: italic">/*</span>
<span style="color: #666666; font-style: italic"> * checks for accelerator object ownership; these make horizontal (board)</span>
<span style="color: #666666; font-style: italic"> * and vertical (jetpack) pixel panning faster</span>
<span style="color: #666666; font-style: italic"> */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int32_t</span> <span style="color: #55eedd; font-weight: bold">player_has_board</span> ();
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">int32_t</span> <span style="color: #55eedd; font-weight: bold">player_has_jetpack</span> ();

<span style="color: #666666; font-style: italic">/* responses possible for command actions */</span>
<span style="color: #228899; font-weight: bold">typedef</span> <span style="color: #228899; font-weight: bold">enum</span> {
    TC_ALLOW_EDIT,   <span style="color: #666666; font-style: italic">/* allow user to edit current text         */</span>
    TC_DISCARD_TEXT, <span style="color: #666666; font-style: italic">/* reset the typed text, but don&#39;t redraw  */</span>
    TC_REDRAW_ROOM,  <span style="color: #666666; font-style: italic">/* objects may have moved--redraw the room */</span>
    TC_CHANGE_ROOM   <span style="color: #666666; font-style: italic">/* room changed--update view, etc.         */</span>
} <span style="color: #6666ff; font-weight: bold">tc_action_t</span>;

<span style="color: #666666; font-style: italic">/* actions caused by button presses (room movement) */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">try_to_move_left</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">try_to_enter</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">try_to_move_right</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr);

<span style="color: #666666; font-style: italic">/* typed command actions */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_buy</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_charge</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_do</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_drink</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_drop</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_fix</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_flash</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_get</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_go</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_install</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_inventory</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_sigh</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_use</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">tc_action_t</span> <span style="color: #55eedd; font-weight: bold">typed_cmd_wear</span> (<span style="color: #6666ff; font-weight: bold">room_t</span><span style="color: #333333">**</span> rptr, <span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> arg);

<span style="color: #666666; font-style: italic">/* in adventure.c */</span>
<span style="color: #228899; font-weight: bold">extern</span> <span style="color: #6666ff; font-weight: bold">void</span> <span style="color: #55eedd; font-weight: bold">show_status</span> (<span style="color: #228899; font-weight: bold">const</span> <span style="color: #6666ff; font-weight: bold">char</span><span style="color: #333333">*</span> s);

<span style="color: #557799">#endif </span><span style="color: #666666; font-style: italic">/* WORLD_H */</span><span style="color: #557799"></span>
</pre></div>
<p></p>                
            </section>
        
        
        
        
        
        
        
        
        
            <!--Makefile-->
            <section>
            <hnew id="Makefile">Makefile</hnew><br>
                <a href="#" class="buttonBackToTop">BACK TO TOP</a>  
                
                <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #55eedd; font-weight: bold">all</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">adventure tr mp2photo mp2object</span>

<span style="color: #003366">HEADERS</span><span style="color: #333333">=</span>assert.h input.h modex.h photo.h photo_headers.h text.h types.h <span style="color: #666666; font-weight: bold; background-color: #e0e0ff">\</span>
	world.h Makefile
<span style="color: #003366">OBJS</span><span style="color: #333333">=</span>adventure.o assert.o modex.o input.o photo.o text.o world.o

<span style="color: #003366">CFLAGS</span><span style="color: #333333">=</span>-g -Wall

<span style="color: #55eedd; font-weight: bold">adventure</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">${OBJS}</span>
	gcc -g -o adventure <span style="color: #228899; font-weight: bold">${</span><span style="color: #003366">OBJS</span><span style="color: #228899; font-weight: bold">}</span> -lpthread -lrt

<span style="color: #55eedd; font-weight: bold">tr</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">modex.c ${HEADERS} text.o</span>
	gcc <span style="color: #228899; font-weight: bold">${</span><span style="color: #003366">CFLAGS</span><span style="color: #228899; font-weight: bold">}</span> -DTEXT_RESTORE_PROGRAM<span style="color: #333333">=</span>1 -o tr modex.c text.o

<span style="color: #55eedd; font-weight: bold">mp2photo</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">${HEADERS}</span>
	gcc <span style="color: #228899; font-weight: bold">${</span><span style="color: #003366">CFLAGS</span><span style="color: #228899; font-weight: bold">}</span> -o mp2photo mp2photo.c

<span style="color: #55eedd; font-weight: bold">mp2object</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">${HEADERS}</span>
	gcc <span style="color: #228899; font-weight: bold">${</span><span style="color: #003366">CFLAGS</span><span style="color: #228899; font-weight: bold">}</span> -DWRITE_OBJECT_IMAGE<span style="color: #333333">=</span>1 -o mp2object mp2photo.c

<span style="color: #55eedd; font-weight: bold">%.o</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">%.c ${HEADERS}</span>
	gcc <span style="color: #228899; font-weight: bold">${</span><span style="color: #003366">CFLAGS</span><span style="color: #228899; font-weight: bold">}</span> -c -o <span style="color: #003366">$@</span> <span style="color: #003366">$&lt;</span>

<span style="color: #55eedd; font-weight: bold">%.o</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">%.s ${HEADERS}</span>
	gcc <span style="color: #228899; font-weight: bold">${</span><span style="color: #003366">CFLAGS</span><span style="color: #228899; font-weight: bold">}</span> -c -o <span style="color: #003366">$@</span> <span style="color: #003366">$&lt;</span>

<span style="color: #55eedd; font-weight: bold">clean</span><span style="color: #333333">::</span>
	rm -f *.o *~ a.out

<span style="color: #55eedd; font-weight: bold">clear</span><span style="color: #333333">:</span> <span style="color: #6600EE; font-weight: bold">clean</span>
	rm -f adventure tr mp2photo mp2object
</pre></div>
<p></p>                
            </section>
        _____________________________________________________________________________________________________________________________________________________________
        <br>
        <br>
        
        <!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrollgress.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.slidertron.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>
        
        <!--Back to top-->
        <section id="cta" class="wrapper style3">
				
				<ul class="actions">
					<li><a href="#" class="button big">Back to Top</a></li>
				</ul>
            
            
                <ul class="actions">
					<li><a href="index.html" class="button big">Main Menu</a></li>
				</ul>
			</section> 
        
        <footer id="footer">
				<ul class="icons">
					
					
					
					<li><a href="https://www.linkedin.com/in/lisa-gentil-33b45892/" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
					<li><a href="mailto:gentillisa5@gmail.com" class="icon fa-envelope"><span class="label">Envelope</span></a></li>
				</ul>
				
				<span>
				Lisa Gentil's Portfolio
				</span>
			</footer>
    </body>
</html>